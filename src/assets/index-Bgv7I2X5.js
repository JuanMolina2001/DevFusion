var Pr=Object.defineProperty;var Ir=(c,e,r)=>e in c?Pr(c,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[e]=r;var te=(c,e,r)=>(Ir(c,typeof e!="symbol"?e+"":e,r),r),Hr=(c,e,r)=>{if(!e.has(c))throw TypeError("Cannot "+r)};var ot=(c,e,r)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,r)};var Ne=(c,e,r)=>(Hr(c,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const b of d)if(b.type==="childList")for(const w of b.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&u(w)}).observe(document,{childList:!0,subtree:!0});function r(d){const b={};return d.integrity&&(b.integrity=d.integrity),d.referrerPolicy&&(b.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?b.credentials="include":d.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function u(d){if(d.ep)return;d.ep=!0;const b=r(d);fetch(d.href,b)}})();var Qe,Z,Hi,Le,ai,$i,Ht,Vt,$t,Ft,Fi,Xe={},Ni=[],$r=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,yt=Array.isArray;function Se(c,e){for(var r in e)c[r]=e[r];return c}function Wi(c){var e=c.parentNode;e&&e.removeChild(c)}function ye(c,e,r){var u,d,b,w={};for(b in e)b=="key"?u=e[b]:b=="ref"?d=e[b]:w[b]=e[b];if(arguments.length>2&&(w.children=arguments.length>3?Qe.call(arguments,2):r),typeof c=="function"&&c.defaultProps!=null)for(b in c.defaultProps)w[b]===void 0&&(w[b]=c.defaultProps[b]);return qe(c,w,u,d,null)}function qe(c,e,r,u,d){var b={type:c,props:e,key:r,ref:u,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:d??++Hi,__i:-1,__u:0};return d==null&&Z.vnode!=null&&Z.vnode(b),b}function Fr(){return{current:null}}function we(c){return c.children}function me(c,e){this.props=c,this.context=e}function Re(c,e){if(e==null)return c.__?Re(c.__,c.__i+1):null;for(var r;e<c.__k.length;e++)if((r=c.__k[e])!=null&&r.__e!=null)return r.__e;return typeof c.type=="function"?Re(c):null}function Ui(c){var e,r;if((c=c.__)!=null&&c.__c!=null){for(c.__e=c.__c.base=null,e=0;e<c.__k.length;e++)if((r=c.__k[e])!=null&&r.__e!=null){c.__e=c.__c.base=r.__e;break}return Ui(c)}}function Nt(c){(!c.__d&&(c.__d=!0)&&Le.push(c)&&!ft.__r++||ai!==Z.debounceRendering)&&((ai=Z.debounceRendering)||$i)(ft)}function ft(){var c,e,r,u,d,b,w,t;for(Le.sort(Ht);c=Le.shift();)c.__d&&(e=Le.length,u=void 0,b=(d=(r=c).__v).__e,w=[],t=[],r.__P&&((u=Se({},d)).__v=d.__v+1,Z.vnode&&Z.vnode(u),Gt(r.__P,u,d,r.__n,r.__P.namespaceURI,32&d.__u?[b]:null,w,b??Re(d),!!(32&d.__u),t),u.__v=d.__v,u.__.__k[u.__i]=u,qi(w,u,t),u.__e!=b&&Ui(u)),Le.length>e&&Le.sort(Ht));ft.__r=0}function ji(c,e,r,u,d,b,w,t,o,h,f){var l,g,v,C,p,n=u&&u.__k||Ni,a=e.length;for(r.__d=o,Nr(r,e,n),o=r.__d,l=0;l<a;l++)(v=r.__k[l])!=null&&typeof v!="boolean"&&typeof v!="function"&&(g=v.__i===-1?Xe:n[v.__i]||Xe,v.__i=l,Gt(c,v,g,d,b,w,t,o,h,f),C=v.__e,v.ref&&g.ref!=v.ref&&(g.ref&&Xt(g.ref,null,v),f.push(v.ref,v.__c||C,v)),p==null&&C!=null&&(p=C),65536&v.__u||g.__k===v.__k?(o&&!o.isConnected&&(o=Re(g)),o=zi(v,o,c)):typeof v.type=="function"&&v.__d!==void 0?o=v.__d:C&&(o=C.nextSibling),v.__d=void 0,v.__u&=-196609);r.__d=o,r.__e=p}function Nr(c,e,r){var u,d,b,w,t,o=e.length,h=r.length,f=h,l=0;for(c.__k=[],u=0;u<o;u++)w=u+l,(d=c.__k[u]=(d=e[u])==null||typeof d=="boolean"||typeof d=="function"?null:typeof d=="string"||typeof d=="number"||typeof d=="bigint"||d.constructor==String?qe(null,d,null,null,null):yt(d)?qe(we,{children:d},null,null,null):d.constructor===void 0&&d.__b>0?qe(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)!=null?(d.__=c,d.__b=c.__b+1,t=Wr(d,r,w,f),d.__i=t,b=null,t!==-1&&(f--,(b=r[t])&&(b.__u|=131072)),b==null||b.__v===null?(t==-1&&l--,typeof d.type!="function"&&(d.__u|=65536)):t!==w&&(t===w+1?l++:t>w?f>o-w?l+=t-w:l--:t<w?t==w-1&&(l=t-w):l=0,t!==u+l&&(d.__u|=65536))):(b=r[w])&&b.key==null&&b.__e&&!(131072&b.__u)&&(b.__e==c.__d&&(c.__d=Re(b)),Wt(b,b,!1),r[w]=null,f--);if(f)for(u=0;u<h;u++)(b=r[u])!=null&&!(131072&b.__u)&&(b.__e==c.__d&&(c.__d=Re(b)),Wt(b,b))}function zi(c,e,r){var u,d;if(typeof c.type=="function"){for(u=c.__k,d=0;u&&d<u.length;d++)u[d]&&(u[d].__=c,e=zi(u[d],e,r));return e}c.__e!=e&&(r.insertBefore(c.__e,e||null),e=c.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function be(c,e){return e=e||[],c==null||typeof c=="boolean"||(yt(c)?c.some(function(r){be(r,e)}):e.push(c)),e}function Wr(c,e,r,u){var d=c.key,b=c.type,w=r-1,t=r+1,o=e[r];if(o===null||o&&d==o.key&&b===o.type&&!(131072&o.__u))return r;if(u>(o!=null&&!(131072&o.__u)?1:0))for(;w>=0||t<e.length;){if(w>=0){if((o=e[w])&&!(131072&o.__u)&&d==o.key&&b===o.type)return w;w--}if(t<e.length){if((o=e[t])&&!(131072&o.__u)&&d==o.key&&b===o.type)return t;t++}}return-1}function li(c,e,r){e[0]==="-"?c.setProperty(e,r??""):c[e]=r==null?"":typeof r!="number"||$r.test(e)?r:r+"px"}function at(c,e,r,u,d){var b;e:if(e==="style")if(typeof r=="string")c.style.cssText=r;else{if(typeof u=="string"&&(c.style.cssText=u=""),u)for(e in u)r&&e in r||li(c.style,e,"");if(r)for(e in r)u&&r[e]===u[e]||li(c.style,e,r[e])}else if(e[0]==="o"&&e[1]==="n")b=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in c||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),c.l||(c.l={}),c.l[e+b]=r,r?u?r.u=u.u:(r.u=Vt,c.addEventListener(e,b?Ft:$t,b)):c.removeEventListener(e,b?Ft:$t,b);else{if(d=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e in c)try{c[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!=="-"?c.removeAttribute(e):c.setAttribute(e,r))}}function ci(c){return function(e){if(this.l){var r=this.l[e.type+c];if(e.t==null)e.t=Vt++;else if(e.t<r.u)return;return r(Z.event?Z.event(e):e)}}}function Gt(c,e,r,u,d,b,w,t,o,h){var f,l,g,v,C,p,n,a,i,s,_,S,y,k,m,E=e.type;if(e.constructor!==void 0)return null;128&r.__u&&(o=!!(32&r.__u),b=[t=e.__e=r.__e]),(f=Z.__b)&&f(e);e:if(typeof E=="function")try{if(a=e.props,i=(f=E.contextType)&&u[f.__c],s=f?i?i.props.value:f.__:u,r.__c?n=(l=e.__c=r.__c).__=l.__E:("prototype"in E&&E.prototype.render?e.__c=l=new E(a,s):(e.__c=l=new me(a,s),l.constructor=E,l.render=jr),i&&i.sub(l),l.props=a,l.state||(l.state={}),l.context=s,l.__n=u,g=l.__d=!0,l.__h=[],l._sb=[]),l.__s==null&&(l.__s=l.state),E.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=Se({},l.__s)),Se(l.__s,E.getDerivedStateFromProps(a,l.__s))),v=l.props,C=l.state,l.__v=e,g)E.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(E.getDerivedStateFromProps==null&&a!==v&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(a,s),!l.__e&&(l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(a,l.__s,s)===!1||e.__v===r.__v)){for(e.__v!==r.__v&&(l.props=a,l.state=l.__s,l.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.forEach(function(R){R&&(R.__=e)}),_=0;_<l._sb.length;_++)l.__h.push(l._sb[_]);l._sb=[],l.__h.length&&w.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(a,l.__s,s),l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(v,C,p)})}if(l.context=s,l.props=a,l.__P=c,l.__e=!1,S=Z.__r,y=0,"prototype"in E&&E.prototype.render){for(l.state=l.__s,l.__d=!1,S&&S(e),f=l.render(l.props,l.state,l.context),k=0;k<l._sb.length;k++)l.__h.push(l._sb[k]);l._sb=[]}else do l.__d=!1,S&&S(e),f=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++y<25);l.state=l.__s,l.getChildContext!=null&&(u=Se(Se({},u),l.getChildContext())),g||l.getSnapshotBeforeUpdate==null||(p=l.getSnapshotBeforeUpdate(v,C)),ji(c,yt(m=f!=null&&f.type===we&&f.key==null?f.props.children:f)?m:[m],e,r,u,d,b,w,t,o,h),l.base=e.__e,e.__u&=-161,l.__h.length&&w.push(l),n&&(l.__E=l.__=null)}catch(R){e.__v=null,o||b!=null?(e.__e=t,e.__u|=o?160:32,b[b.indexOf(t)]=null):(e.__e=r.__e,e.__k=r.__k),Z.__e(R,e,r)}else b==null&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=Ur(r.__e,e,r,u,d,b,w,o,h);(f=Z.diffed)&&f(e)}function qi(c,e,r){e.__d=void 0;for(var u=0;u<r.length;u++)Xt(r[u],r[++u],r[++u]);Z.__c&&Z.__c(e,c),c.some(function(d){try{c=d.__h,d.__h=[],c.some(function(b){b.call(d)})}catch(b){Z.__e(b,d.__v)}})}function Ur(c,e,r,u,d,b,w,t,o){var h,f,l,g,v,C,p,n=r.props,a=e.props,i=e.type;if(i==="svg"?d="http://www.w3.org/2000/svg":i==="math"?d="http://www.w3.org/1998/Math/MathML":d||(d="http://www.w3.org/1999/xhtml"),b!=null){for(h=0;h<b.length;h++)if((v=b[h])&&"setAttribute"in v==!!i&&(i?v.localName===i:v.nodeType===3)){c=v,b[h]=null;break}}if(c==null){if(i===null)return document.createTextNode(a);c=document.createElementNS(d,i,a.is&&a),b=null,t=!1}if(i===null)n===a||t&&c.data===a||(c.data=a);else{if(b=b&&Qe.call(c.childNodes),n=r.props||Xe,!t&&b!=null)for(n={},h=0;h<c.attributes.length;h++)n[(v=c.attributes[h]).name]=v.value;for(h in n)if(v=n[h],h!="children"){if(h=="dangerouslySetInnerHTML")l=v;else if(h!=="key"&&!(h in a)){if(h=="value"&&"defaultValue"in a||h=="checked"&&"defaultChecked"in a)continue;at(c,h,null,v,d)}}for(h in a)v=a[h],h=="children"?g=v:h=="dangerouslySetInnerHTML"?f=v:h=="value"?C=v:h=="checked"?p=v:h==="key"||t&&typeof v!="function"||n[h]===v||at(c,h,v,n[h],d);if(f)t||l&&(f.__html===l.__html||f.__html===c.innerHTML)||(c.innerHTML=f.__html),e.__k=[];else if(l&&(c.innerHTML=""),ji(c,yt(g)?g:[g],e,r,u,i==="foreignObject"?"http://www.w3.org/1999/xhtml":d,b,w,b?b[0]:r.__k&&Re(r,0),t,o),b!=null)for(h=b.length;h--;)b[h]!=null&&Wi(b[h]);t||(h="value",C!==void 0&&(C!==c[h]||i==="progress"&&!C||i==="option"&&C!==n[h])&&at(c,h,C,n[h],d),h="checked",p!==void 0&&p!==c[h]&&at(c,h,p,n[h],d))}return c}function Xt(c,e,r){try{typeof c=="function"?c(e):c.current=e}catch(u){Z.__e(u,r)}}function Wt(c,e,r){var u,d;if(Z.unmount&&Z.unmount(c),(u=c.ref)&&(u.current&&u.current!==c.__e||Xt(u,null,e)),(u=c.__c)!=null){if(u.componentWillUnmount)try{u.componentWillUnmount()}catch(b){Z.__e(b,e)}u.base=u.__P=null}if(u=c.__k)for(d=0;d<u.length;d++)u[d]&&Wt(u[d],e,r||typeof c.type!="function");r||c.__e==null||Wi(c.__e),c.__c=c.__=c.__e=c.__d=void 0}function jr(c,e,r){return this.constructor(c,r)}function Me(c,e,r){var u,d,b,w;Z.__&&Z.__(c,e),d=(u=typeof r=="function")?null:r&&r.__k||e.__k,b=[],w=[],Gt(e,c=(!u&&r||e).__k=ye(we,null,[c]),d||Xe,Xe,e.namespaceURI,!u&&r?[r]:d?null:e.firstChild?Qe.call(e.childNodes):null,b,!u&&r?r:d?d.__e:e.firstChild,u,w),qi(b,c,w)}function Ki(c,e){Me(c,e,Ki)}function zr(c,e,r){var u,d,b,w,t=Se({},c.props);for(b in c.type&&c.type.defaultProps&&(w=c.type.defaultProps),e)b=="key"?u=e[b]:b=="ref"?d=e[b]:t[b]=e[b]===void 0&&w!==void 0?w[b]:e[b];return arguments.length>2&&(t.children=arguments.length>3?Qe.call(arguments,2):r),qe(c.type,t,u||c.key,d||c.ref,null)}function Vi(c,e){var r={__c:e="__cC"+Fi++,__:c,Consumer:function(u,d){return u.children(d)},Provider:function(u){var d,b;return this.getChildContext||(d=[],(b={})[e]=this,this.getChildContext=function(){return b},this.shouldComponentUpdate=function(w){this.props.value!==w.value&&d.some(function(t){t.__e=!0,Nt(t)})},this.sub=function(w){d.push(w);var t=w.componentWillUnmount;w.componentWillUnmount=function(){d.splice(d.indexOf(w),1),t&&t.call(w)}}),u.children}};return r.Provider.__=r.Consumer.contextType=r}Qe=Ni.slice,Z={__e:function(c,e,r,u){for(var d,b,w;e=e.__;)if((d=e.__c)&&!d.__)try{if((b=d.constructor)&&b.getDerivedStateFromError!=null&&(d.setState(b.getDerivedStateFromError(c)),w=d.__d),d.componentDidCatch!=null&&(d.componentDidCatch(c,u||{}),w=d.__d),w)return d.__E=d}catch(t){c=t}throw c}},Hi=0,me.prototype.setState=function(c,e){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Se({},this.state),typeof c=="function"&&(c=c(Se({},r),this.props)),c&&Se(r,c),c!=null&&this.__v&&(e&&this._sb.push(e),Nt(this))},me.prototype.forceUpdate=function(c){this.__v&&(this.__e=!0,c&&this.__h.push(c),Nt(this))},me.prototype.render=we,Le=[],$i=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ht=function(c,e){return c.__v.__b-e.__v.__b},ft.__r=0,Vt=0,$t=ci(!1),Ft=ci(!0),Fi=0;var xe,ie,Tt,hi,Oe=0,Gi=[],ut=[],se=Z,ui=se.__b,di=se.__r,_i=se.diffed,fi=se.__c,pi=se.unmount,gi=se.__;function Pe(c,e){se.__h&&se.__h(ie,c,Oe||e),Oe=0;var r=ie.__H||(ie.__H={__:[],__h:[]});return c>=r.__.length&&r.__.push({__V:ut}),r.__[c]}function le(c){return Oe=1,Jt(Yi,c)}function Jt(c,e,r){var u=Pe(xe++,2);if(u.t=c,!u.__c&&(u.__=[r?r(e):Yi(void 0,e),function(t){var o=u.__N?u.__N[0]:u.__[0],h=u.t(o,t);o!==h&&(u.__N=[h,u.__[1]],u.__c.setState({}))}],u.__c=ie,!ie.u)){var d=function(t,o,h){if(!u.__c.__H)return!0;var f=u.__c.__H.__.filter(function(g){return!!g.__c});if(f.every(function(g){return!g.__N}))return!b||b.call(this,t,o,h);var l=!1;return f.forEach(function(g){if(g.__N){var v=g.__[0];g.__=g.__N,g.__N=void 0,v!==g.__[0]&&(l=!0)}}),!(!l&&u.__c.props===t)&&(!b||b.call(this,t,o,h))};ie.u=!0;var b=ie.shouldComponentUpdate,w=ie.componentWillUpdate;ie.componentWillUpdate=function(t,o,h){if(this.__e){var f=b;b=void 0,d(t,o,h),b=f}w&&w.call(this,t,o,h)},ie.shouldComponentUpdate=d}return u.__N||u.__}function ce(c,e){var r=Pe(xe++,3);!se.__s&&Yt(r.__H,e)&&(r.__=c,r.i=e,ie.__H.__h.push(r))}function et(c,e){var r=Pe(xe++,4);!se.__s&&Yt(r.__H,e)&&(r.__=c,r.i=e,ie.__h.push(r))}function ae(c){return Oe=5,wt(function(){return{current:c}},[])}function Xi(c,e,r){Oe=6,et(function(){return typeof c=="function"?(c(e()),function(){return c(null)}):c?(c.current=e(),function(){return c.current=null}):void 0},r==null?r:r.concat(c))}function wt(c,e){var r=Pe(xe++,7);return Yt(r.__H,e)?(r.__V=c(),r.i=e,r.__h=c,r.__V):r.__}function Je(c,e){return Oe=8,wt(function(){return c},e)}function Zt(c){var e=ie.context[c.__c],r=Pe(xe++,9);return r.c=c,e?(r.__==null&&(r.__=!0,e.sub(ie)),e.props.value):c.__}function Ji(c,e){se.useDebugValue&&se.useDebugValue(e?e(c):c)}function Zi(){var c=Pe(xe++,11);if(!c.__){for(var e=ie.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var r=e.__m||(e.__m=[0,0]);c.__="P"+r[0]+"-"+r[1]++}return c.__}function qr(){for(var c;c=Gi.shift();)if(c.__P&&c.__H)try{c.__H.__h.forEach(dt),c.__H.__h.forEach(Ut),c.__H.__h=[]}catch(e){c.__H.__h=[],se.__e(e,c.__v)}}se.__b=function(c){ie=null,ui&&ui(c)},se.__=function(c,e){c&&e.__k&&e.__k.__m&&(c.__m=e.__k.__m),gi&&gi(c,e)},se.__r=function(c){di&&di(c),xe=0;var e=(ie=c.__c).__H;e&&(Tt===ie?(e.__h=[],ie.__h=[],e.__.forEach(function(r){r.__N&&(r.__=r.__N),r.__V=ut,r.__N=r.i=void 0})):(e.__h.forEach(dt),e.__h.forEach(Ut),e.__h=[],xe=0)),Tt=ie},se.diffed=function(c){_i&&_i(c);var e=c.__c;e&&e.__H&&(e.__H.__h.length&&(Gi.push(e)!==1&&hi===se.requestAnimationFrame||((hi=se.requestAnimationFrame)||Kr)(qr)),e.__H.__.forEach(function(r){r.i&&(r.__H=r.i),r.__V!==ut&&(r.__=r.__V),r.i=void 0,r.__V=ut})),Tt=ie=null},se.__c=function(c,e){e.some(function(r){try{r.__h.forEach(dt),r.__h=r.__h.filter(function(u){return!u.__||Ut(u)})}catch(u){e.some(function(d){d.__h&&(d.__h=[])}),e=[],se.__e(u,r.__v)}}),fi&&fi(c,e)},se.unmount=function(c){pi&&pi(c);var e,r=c.__c;r&&r.__H&&(r.__H.__.forEach(function(u){try{dt(u)}catch(d){e=d}}),r.__H=void 0,e&&se.__e(e,r.__v))};var vi=typeof requestAnimationFrame=="function";function Kr(c){var e,r=function(){clearTimeout(u),vi&&cancelAnimationFrame(e),setTimeout(c)},u=setTimeout(r,100);vi&&(e=requestAnimationFrame(r))}function dt(c){var e=ie,r=c.__c;typeof r=="function"&&(c.__c=void 0,r()),ie=e}function Ut(c){var e=ie;c.__c=c.__(),ie=e}function Yt(c,e){return!c||c.length!==e.length||e.some(function(r,u){return r!==c[u]})}function Yi(c,e){return typeof e=="function"?e(c):e}function Vr(c,e,r){return e in c?Object.defineProperty(c,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):c[e]=r,c}function mi(c,e){var r=Object.keys(c);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(c);e&&(u=u.filter(function(d){return Object.getOwnPropertyDescriptor(c,d).enumerable})),r.push.apply(r,u)}return r}function Si(c){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mi(Object(r),!0).forEach(function(u){Vr(c,u,r[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(r)):mi(Object(r)).forEach(function(u){Object.defineProperty(c,u,Object.getOwnPropertyDescriptor(r,u))})}return c}function Gr(c,e){if(c==null)return{};var r={},u=Object.keys(c),d,b;for(b=0;b<u.length;b++)d=u[b],!(e.indexOf(d)>=0)&&(r[d]=c[d]);return r}function Xr(c,e){if(c==null)return{};var r=Gr(c,e),u,d;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);for(d=0;d<b.length;d++)u=b[d],!(e.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(c,u)&&(r[u]=c[u])}return r}function Jr(c,e){return Zr(c)||Yr(c,e)||Qr(c,e)||es()}function Zr(c){if(Array.isArray(c))return c}function Yr(c,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(c)))){var r=[],u=!0,d=!1,b=void 0;try{for(var w=c[Symbol.iterator](),t;!(u=(t=w.next()).done)&&(r.push(t.value),!(e&&r.length===e));u=!0);}catch(o){d=!0,b=o}finally{try{!u&&w.return!=null&&w.return()}finally{if(d)throw b}}return r}}function Qr(c,e){if(c){if(typeof c=="string")return bi(c,e);var r=Object.prototype.toString.call(c).slice(8,-1);if(r==="Object"&&c.constructor&&(r=c.constructor.name),r==="Map"||r==="Set")return Array.from(c);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bi(c,e)}}function bi(c,e){(e==null||e>c.length)&&(e=c.length);for(var r=0,u=new Array(e);r<e;r++)u[r]=c[r];return u}function es(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ts(c,e,r){return e in c?Object.defineProperty(c,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):c[e]=r,c}function yi(c,e){var r=Object.keys(c);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(c);e&&(u=u.filter(function(d){return Object.getOwnPropertyDescriptor(c,d).enumerable})),r.push.apply(r,u)}return r}function wi(c){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yi(Object(r),!0).forEach(function(u){ts(c,u,r[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(r)):yi(Object(r)).forEach(function(u){Object.defineProperty(c,u,Object.getOwnPropertyDescriptor(r,u))})}return c}function is(){for(var c=arguments.length,e=new Array(c),r=0;r<c;r++)e[r]=arguments[r];return function(u){return e.reduceRight(function(d,b){return b(d)},u)}}function je(c){return function e(){for(var r=this,u=arguments.length,d=new Array(u),b=0;b<u;b++)d[b]=arguments[b];return d.length>=c.length?c.apply(this,d):function(){for(var w=arguments.length,t=new Array(w),o=0;o<w;o++)t[o]=arguments[o];return e.apply(r,[].concat(d,t))}}}function pt(c){return{}.toString.call(c).includes("Object")}function rs(c){return!Object.keys(c).length}function Ze(c){return typeof c=="function"}function ss(c,e){return Object.prototype.hasOwnProperty.call(c,e)}function ns(c,e){return pt(e)||Ee("changeType"),Object.keys(e).some(function(r){return!ss(c,r)})&&Ee("changeField"),e}function os(c){Ze(c)||Ee("selectorType")}function as(c){Ze(c)||pt(c)||Ee("handlerType"),pt(c)&&Object.values(c).some(function(e){return!Ze(e)})&&Ee("handlersType")}function ls(c){c||Ee("initialIsRequired"),pt(c)||Ee("initialType"),rs(c)&&Ee("initialContent")}function cs(c,e){throw new Error(c[e]||c.default)}var hs={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ee=je(cs)(hs),lt={changes:ns,selector:os,handler:as,initial:ls};function us(c){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lt.initial(c),lt.handler(e);var r={current:c},u=je(fs)(r,e),d=je(_s)(r),b=je(lt.changes)(c),w=je(ds)(r);function t(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(f){return f};return lt.selector(h),h(r.current)}function o(h){is(u,d,b,w)(h)}return[t,o]}function ds(c,e){return Ze(e)?e(c.current):e}function _s(c,e){return c.current=wi(wi({},c.current),e),e}function fs(c,e,r){return Ze(e)?e(c.current):Object.keys(r).forEach(function(u){var d;return(d=e[u])===null||d===void 0?void 0:d.call(e,c.current[u])}),r}var ps={create:us},gs={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function vs(c){return function e(){for(var r=this,u=arguments.length,d=new Array(u),b=0;b<u;b++)d[b]=arguments[b];return d.length>=c.length?c.apply(this,d):function(){for(var w=arguments.length,t=new Array(w),o=0;o<w;o++)t[o]=arguments[o];return e.apply(r,[].concat(d,t))}}}function ms(c){return{}.toString.call(c).includes("Object")}function Ss(c){return c||Ci("configIsRequired"),ms(c)||Ci("configType"),c.urls?(bs(),{paths:{vs:c.urls.monacoBase}}):c}function bs(){console.warn(Qi.deprecation)}function ys(c,e){throw new Error(c[e]||c.default)}var Qi={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Ci=vs(ys)(Qi),ws={config:Ss},Cs=function(){for(var e=arguments.length,r=new Array(e),u=0;u<e;u++)r[u]=arguments[u];return function(d){return r.reduceRight(function(b,w){return w(b)},d)}};function er(c,e){return Object.keys(e).forEach(function(r){e[r]instanceof Object&&c[r]&&Object.assign(e[r],er(c[r],e[r]))}),Si(Si({},c),e)}var ks={type:"cancelation",msg:"operation is manually canceled"};function Bt(c){var e=!1,r=new Promise(function(u,d){c.then(function(b){return e?d(ks):u(b)}),c.catch(d)});return r.cancel=function(){return e=!0},r}var Es=ps.create({config:gs,isInitialized:!1,resolve:null,reject:null,monaco:null}),tr=Jr(Es,2),tt=tr[0],Ct=tr[1];function xs(c){var e=ws.config(c),r=e.monaco,u=Xr(e,["monaco"]);Ct(function(d){return{config:er(d.config,u),monaco:r}})}function Ls(){var c=tt(function(e){var r=e.monaco,u=e.isInitialized,d=e.resolve;return{monaco:r,isInitialized:u,resolve:d}});if(!c.isInitialized){if(Ct({isInitialized:!0}),c.monaco)return c.resolve(c.monaco),Bt(Mt);if(window.monaco&&window.monaco.editor)return ir(window.monaco),c.resolve(window.monaco),Bt(Mt);Cs(Rs,As)(Ts)}return Bt(Mt)}function Rs(c){return document.body.appendChild(c)}function Ds(c){var e=document.createElement("script");return c&&(e.src=c),e}function As(c){var e=tt(function(u){var d=u.config,b=u.reject;return{config:d,reject:b}}),r=Ds("".concat(e.config.paths.vs,"/loader.js"));return r.onload=function(){return c()},r.onerror=e.reject,r}function Ts(){var c=tt(function(r){var u=r.config,d=r.resolve,b=r.reject;return{config:u,resolve:d,reject:b}}),e=window.require;e.config(c.config),e(["vs/editor/editor.main"],function(r){ir(r),c.resolve(r)},function(r){c.reject(r)})}function ir(c){tt().monaco||Ct({monaco:c})}function Bs(){return tt(function(c){var e=c.monaco;return e})}var Mt=new Promise(function(c,e){return Ct({resolve:c,reject:e})}),rr={config:xs,init:Ls,__getMonacoInstance:Bs};function sr(c,e){for(var r in e)c[r]=e[r];return c}function jt(c,e){for(var r in c)if(r!=="__source"&&!(r in e))return!0;for(var u in e)if(u!=="__source"&&c[u]!==e[u])return!0;return!1}function zt(c,e){this.props=c,this.context=e}function kt(c,e){function r(d){var b=this.props.ref,w=b==d.ref;return!w&&b&&(b.call?b(null):b.current=null),e?!e(this.props,d)||!w:jt(this.props,d)}function u(d){return this.shouldComponentUpdate=r,ye(c,d)}return u.displayName="Memo("+(c.displayName||c.name)+")",u.prototype.isReactComponent=!0,u.__f=!0,u}(zt.prototype=new me).isPureReactComponent=!0,zt.prototype.shouldComponentUpdate=function(c,e){return jt(this.props,c)||jt(this.state,e)};var ki=Z.__b;Z.__b=function(c){c.type&&c.type.__f&&c.ref&&(c.props.ref=c.ref,c.ref=null),ki&&ki(c)};var Ms=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Os(c){function e(r){var u=sr({},r);return delete u.ref,c(u,r.ref||null)}return e.$$typeof=Ms,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(c.displayName||c.name)+")",e}var Ei=function(c,e){return c==null?null:be(be(c).map(e))},Ps={map:Ei,forEach:Ei,count:function(c){return c?be(c).length:0},only:function(c){var e=be(c);if(e.length!==1)throw"Children.only";return e[0]},toArray:be},Is=Z.__e;Z.__e=function(c,e,r,u){if(c.then){for(var d,b=e;b=b.__;)if((d=b.__c)&&d.__c)return e.__e==null&&(e.__e=r.__e,e.__k=r.__k),d.__c(c,e)}Is(c,e,r,u)};var xi=Z.unmount;function nr(c,e,r){return c&&(c.__c&&c.__c.__H&&(c.__c.__H.__.forEach(function(u){typeof u.__c=="function"&&u.__c()}),c.__c.__H=null),(c=sr({},c)).__c!=null&&(c.__c.__P===r&&(c.__c.__P=e),c.__c=null),c.__k=c.__k&&c.__k.map(function(u){return nr(u,e,r)})),c}function or(c,e,r){return c&&r&&(c.__v=null,c.__k=c.__k&&c.__k.map(function(u){return or(u,e,r)}),c.__c&&c.__c.__P===e&&(c.__e&&r.appendChild(c.__e),c.__c.__e=!0,c.__c.__P=r)),c}function _t(){this.__u=0,this.t=null,this.__b=null}function ar(c){var e=c.__.__c;return e&&e.__a&&e.__a(c)}function Hs(c){var e,r,u;function d(b){if(e||(e=c()).then(function(w){r=w.default||w},function(w){u=w}),u)throw u;if(!r)throw e;return ye(r,b)}return d.displayName="Lazy",d.__f=!0,d}function ze(){this.u=null,this.o=null}Z.unmount=function(c){var e=c.__c;e&&e.__R&&e.__R(),e&&32&c.__u&&(c.type=null),xi&&xi(c)},(_t.prototype=new me).__c=function(c,e){var r=e.__c,u=this;u.t==null&&(u.t=[]),u.t.push(r);var d=ar(u.__v),b=!1,w=function(){b||(b=!0,r.__R=null,d?d(t):t())};r.__R=w;var t=function(){if(!--u.__u){if(u.state.__a){var o=u.state.__a;u.__v.__k[0]=or(o,o.__c.__P,o.__c.__O)}var h;for(u.setState({__a:u.__b=null});h=u.t.pop();)h.forceUpdate()}};u.__u++||32&e.__u||u.setState({__a:u.__b=u.__v.__k[0]}),c.then(w,w)},_t.prototype.componentWillUnmount=function(){this.t=[]},_t.prototype.render=function(c,e){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),u=this.__v.__k[0].__c;this.__v.__k[0]=nr(this.__b,r,u.__O=u.__P)}this.__b=null}var d=e.__a&&ye(we,null,c.fallback);return d&&(d.__u&=-33),[ye(we,null,e.__a?null:c.children),d]};var Li=function(c,e,r){if(++r[1]===r[0]&&c.o.delete(e),c.props.revealOrder&&(c.props.revealOrder[0]!=="t"||!c.o.size))for(r=c.u;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;c.u=r=r[2]}};function $s(c){return this.getChildContext=function(){return c.context},c.children}function Fs(c){var e=this,r=c.i;e.componentWillUnmount=function(){Me(null,e.l),e.l=null,e.i=null},e.i&&e.i!==r&&e.componentWillUnmount(),e.l||(e.i=r,e.l={nodeType:1,parentNode:r,childNodes:[],appendChild:function(u){this.childNodes.push(u),e.i.appendChild(u)},insertBefore:function(u,d){this.childNodes.push(u),e.i.appendChild(u)},removeChild:function(u){this.childNodes.splice(this.childNodes.indexOf(u)>>>1,1),e.i.removeChild(u)}}),Me(ye($s,{context:e.context},c.__v),e.l)}function Ns(c,e){var r=ye(Fs,{__v:c,i:e});return r.containerInfo=e,r}(ze.prototype=new me).__a=function(c){var e=this,r=ar(e.__v),u=e.o.get(c);return u[0]++,function(d){var b=function(){e.props.revealOrder?(u.push(d),Li(e,c,u)):d()};r?r(b):b()}},ze.prototype.render=function(c){this.u=null,this.o=new Map;var e=be(c.children);c.revealOrder&&c.revealOrder[0]==="b"&&e.reverse();for(var r=e.length;r--;)this.o.set(e[r],this.u=[1,0,this.u]);return c.children},ze.prototype.componentDidUpdate=ze.prototype.componentDidMount=function(){var c=this;this.o.forEach(function(e,r){Li(c,r,e)})};var lr=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Ws=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Us=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,js=/[A-Z0-9]/g,zs=typeof document<"u",qs=function(c){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(c)};function Ks(c,e,r){return e.__k==null&&(e.textContent=""),Me(c,e),typeof r=="function"&&r(),c?c.__c:null}function Vs(c,e,r){return Ki(c,e),typeof r=="function"&&r(),c?c.__c:null}me.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(c){Object.defineProperty(me.prototype,c,{configurable:!0,get:function(){return this["UNSAFE_"+c]},set:function(e){Object.defineProperty(this,c,{configurable:!0,writable:!0,value:e})}})});var Ri=Z.event;function Gs(){}function Xs(){return this.cancelBubble}function Js(){return this.defaultPrevented}Z.event=function(c){return Ri&&(c=Ri(c)),c.persist=Gs,c.isPropagationStopped=Xs,c.isDefaultPrevented=Js,c.nativeEvent=c};var Qt,Zs={enumerable:!1,configurable:!0,get:function(){return this.class}},Di=Z.vnode;Z.vnode=function(c){typeof c.type=="string"&&function(e){var r=e.props,u=e.type,d={};for(var b in r){var w=r[b];if(!(b==="value"&&"defaultValue"in r&&w==null||zs&&b==="children"&&u==="noscript"||b==="class"||b==="className")){var t=b.toLowerCase();b==="defaultValue"&&"value"in r&&r.value==null?b="value":b==="download"&&w===!0?w="":t==="translate"&&w==="no"?w=!1:t==="ondoubleclick"?b="ondblclick":t!=="onchange"||u!=="input"&&u!=="textarea"||qs(r.type)?t==="onfocus"?b="onfocusin":t==="onblur"?b="onfocusout":Us.test(b)?b=t:u.indexOf("-")===-1&&Ws.test(b)?b=b.replace(js,"-$&").toLowerCase():w===null&&(w=void 0):t=b="oninput",t==="oninput"&&d[b=t]&&(b="oninputCapture"),d[b]=w}}u=="select"&&d.multiple&&Array.isArray(d.value)&&(d.value=be(r.children).forEach(function(o){o.props.selected=d.value.indexOf(o.props.value)!=-1})),u=="select"&&d.defaultValue!=null&&(d.value=be(r.children).forEach(function(o){o.props.selected=d.multiple?d.defaultValue.indexOf(o.props.value)!=-1:d.defaultValue==o.props.value})),r.class&&!r.className?(d.class=r.class,Object.defineProperty(d,"className",Zs)):(r.className&&!r.class||r.class&&r.className)&&(d.class=d.className=r.className),e.props=d}(c),c.$$typeof=lr,Di&&Di(c)};var Ai=Z.__r;Z.__r=function(c){Ai&&Ai(c),Qt=c.__c};var Ti=Z.diffed;Z.diffed=function(c){Ti&&Ti(c);var e=c.props,r=c.__e;r!=null&&c.type==="textarea"&&"value"in e&&e.value!==r.value&&(r.value=e.value==null?"":e.value),Qt=null};var Ys={ReactCurrentDispatcher:{current:{readContext:function(c){return Qt.__n[c.__c].props.value},useCallback:Je,useContext:Zt,useDebugValue:Ji,useDeferredValue:hr,useEffect:ce,useId:Zi,useImperativeHandle:Xi,useInsertionEffect:dr,useLayoutEffect:et,useMemo:wt,useReducer:Jt,useRef:ae,useState:le,useSyncExternalStore:_r,useTransition:ur}}};function Qs(c){return ye.bind(null,c)}function Et(c){return!!c&&c.$$typeof===lr}function en(c){return Et(c)&&c.type===we}function tn(c){return!!c&&!!c.displayName&&(typeof c.displayName=="string"||c.displayName instanceof String)&&c.displayName.startsWith("Memo(")}function rn(c){return Et(c)?zr.apply(null,arguments):c}function sn(c){return!!c.__k&&(Me(null,c),!0)}function nn(c){return c&&(c.base||c.nodeType===1&&c)||null}var on=function(c,e){return c(e)},an=function(c,e){return c(e)},ln=we;function cr(c){c()}function hr(c){return c}function ur(){return[!1,cr]}var dr=et,cn=Et;function _r(c,e){var r=e(),u=le({h:{__:r,v:e}}),d=u[0].h,b=u[1];return et(function(){d.__=r,d.v=e,Ot(d)&&b({h:d})},[c,r,e]),ce(function(){return Ot(d)&&b({h:d}),c(function(){Ot(d)&&b({h:d})})},[c]),r}function Ot(c){var e,r,u=c.v,d=c.__;try{var b=u();return!((e=d)===(r=b)&&(e!==0||1/e==1/r)||e!=e&&r!=r)}catch{return!0}}var Be={useState:le,useId:Zi,useReducer:Jt,useEffect:ce,useLayoutEffect:et,useInsertionEffect:dr,useTransition:ur,useDeferredValue:hr,useSyncExternalStore:_r,startTransition:cr,useRef:ae,useImperativeHandle:Xi,useMemo:wt,useCallback:Je,useContext:Zt,useDebugValue:Ji,version:"17.0.2",Children:Ps,render:Ks,hydrate:Vs,unmountComponentAtNode:sn,createPortal:Ns,createElement:ye,createContext:Vi,createFactory:Qs,cloneElement:rn,createRef:Fr,Fragment:we,isValidElement:Et,isElement:cn,isFragment:en,isMemo:tn,findDOMNode:nn,Component:me,PureComponent:zt,memo:kt,forwardRef:Os,flushSync:an,unstable_batchedUpdates:on,StrictMode:ln,Suspense:_t,SuspenseList:ze,lazy:Hs,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Ys},hn={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Pt=hn,un={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},dn=un;function _n({children:c}){return Be.createElement("div",{style:dn.container},c)}var fn=_n,pn=fn;function gn({width:c,height:e,isEditorReady:r,loading:u,_ref:d,className:b,wrapperProps:w}){return Be.createElement("section",{style:{...Pt.wrapper,width:c,height:e},...w},!r&&Be.createElement(pn,null,u),Be.createElement("div",{ref:d,style:{...Pt.fullWidth,...!r&&Pt.hide},className:b}))}var vn=gn,fr=kt(vn);function mn(c){ce(c,[])}var pr=mn;function Sn(c,e,r=!0){let u=ae(!0);ce(u.current||!r?()=>{u.current=!1}:c,e)}var ue=Sn;function Ke(){}function Te(c,e,r,u){return bn(c,u)||yn(c,e,r,u)}function bn(c,e){return c.editor.getModel(gr(c,e))}function yn(c,e,r,u){return c.editor.createModel(e,r,u?gr(c,u):void 0)}function gr(c,e){return c.Uri.parse(e)}function wn({original:c,modified:e,language:r,originalLanguage:u,modifiedLanguage:d,originalModelPath:b,modifiedModelPath:w,keepCurrentOriginalModel:t=!1,keepCurrentModifiedModel:o=!1,theme:h="light",loading:f="Loading...",options:l={},height:g="100%",width:v="100%",className:C,wrapperProps:p={},beforeMount:n=Ke,onMount:a=Ke}){let[i,s]=le(!1),[_,S]=le(!0),y=ae(null),k=ae(null),m=ae(null),E=ae(a),R=ae(n),B=ae(!1);pr(()=>{let I=rr.init();return I.then(N=>(k.current=N)&&S(!1)).catch(N=>(N==null?void 0:N.type)!=="cancelation"&&console.error("Monaco initialization: error:",N)),()=>y.current?H():I.cancel()}),ue(()=>{if(y.current&&k.current){let I=y.current.getOriginalEditor(),N=Te(k.current,c||"",u||r||"text",b||"");N!==I.getModel()&&I.setModel(N)}},[b],i),ue(()=>{if(y.current&&k.current){let I=y.current.getModifiedEditor(),N=Te(k.current,e||"",d||r||"text",w||"");N!==I.getModel()&&I.setModel(N)}},[w],i),ue(()=>{let I=y.current.getModifiedEditor();I.getOption(k.current.editor.EditorOption.readOnly)?I.setValue(e||""):e!==I.getValue()&&(I.executeEdits("",[{range:I.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),I.pushUndoStop())},[e],i),ue(()=>{var I,N;(N=(I=y.current)==null?void 0:I.getModel())==null||N.original.setValue(c||"")},[c],i),ue(()=>{let{original:I,modified:N}=y.current.getModel();k.current.editor.setModelLanguage(I,u||r||"text"),k.current.editor.setModelLanguage(N,d||r||"text")},[r,u,d],i),ue(()=>{var I;(I=k.current)==null||I.editor.setTheme(h)},[h],i),ue(()=>{var I;(I=y.current)==null||I.updateOptions(l)},[l],i);let O=Je(()=>{var q;if(!k.current)return;R.current(k.current);let I=Te(k.current,c||"",u||r||"text",b||""),N=Te(k.current,e||"",d||r||"text",w||"");(q=y.current)==null||q.setModel({original:I,modified:N})},[r,e,d,c,u,b,w]),A=Je(()=>{var I;!B.current&&m.current&&(y.current=k.current.editor.createDiffEditor(m.current,{automaticLayout:!0,...l}),O(),(I=k.current)==null||I.editor.setTheme(h),s(!0),B.current=!0)},[l,h,O]);ce(()=>{i&&E.current(y.current,k.current)},[i]),ce(()=>{!_&&!i&&A()},[_,i,A]);function H(){var N,q,j,x;let I=(N=y.current)==null?void 0:N.getModel();t||((q=I==null?void 0:I.original)==null||q.dispose()),o||((j=I==null?void 0:I.modified)==null||j.dispose()),(x=y.current)==null||x.dispose()}return Be.createElement(fr,{width:v,height:g,isEditorReady:i,loading:f,_ref:m,className:C,wrapperProps:p})}var Cn=wn;kt(Cn);function kn(c){let e=ae();return ce(()=>{e.current=c},[c]),e.current}var En=kn,ct=new Map;function xn({defaultValue:c,defaultLanguage:e,defaultPath:r,value:u,language:d,path:b,theme:w="light",line:t,loading:o="Loading...",options:h={},overrideServices:f={},saveViewState:l=!0,keepCurrentModel:g=!1,width:v="100%",height:C="100%",className:p,wrapperProps:n={},beforeMount:a=Ke,onMount:i=Ke,onChange:s,onValidate:_=Ke}){let[S,y]=le(!1),[k,m]=le(!0),E=ae(null),R=ae(null),B=ae(null),O=ae(i),A=ae(a),H=ae(),I=ae(u),N=En(b),q=ae(!1),j=ae(!1);pr(()=>{let D=rr.init();return D.then(M=>(E.current=M)&&m(!1)).catch(M=>(M==null?void 0:M.type)!=="cancelation"&&console.error("Monaco initialization: error:",M)),()=>R.current?T():D.cancel()}),ue(()=>{var M,F,z,G;let D=Te(E.current,c||u||"",e||d||"",b||r||"");D!==((M=R.current)==null?void 0:M.getModel())&&(l&&ct.set(N,(F=R.current)==null?void 0:F.saveViewState()),(z=R.current)==null||z.setModel(D),l&&((G=R.current)==null||G.restoreViewState(ct.get(b))))},[b],S),ue(()=>{var D;(D=R.current)==null||D.updateOptions(h)},[h],S),ue(()=>{!R.current||u===void 0||(R.current.getOption(E.current.editor.EditorOption.readOnly)?R.current.setValue(u):u!==R.current.getValue()&&(j.current=!0,R.current.executeEdits("",[{range:R.current.getModel().getFullModelRange(),text:u,forceMoveMarkers:!0}]),R.current.pushUndoStop(),j.current=!1))},[u],S),ue(()=>{var M,F;let D=(M=R.current)==null?void 0:M.getModel();D&&d&&((F=E.current)==null||F.editor.setModelLanguage(D,d))},[d],S),ue(()=>{var D;t!==void 0&&((D=R.current)==null||D.revealLine(t))},[t],S),ue(()=>{var D;(D=E.current)==null||D.editor.setTheme(w)},[w],S);let x=Je(()=>{var D;if(!(!B.current||!E.current)&&!q.current){A.current(E.current);let M=b||r,F=Te(E.current,u||c||"",e||d||"",M||"");R.current=(D=E.current)==null?void 0:D.editor.create(B.current,{model:F,automaticLayout:!0,...h},f),l&&R.current.restoreViewState(ct.get(M)),E.current.editor.setTheme(w),t!==void 0&&R.current.revealLine(t),y(!0),q.current=!0}},[c,e,r,u,d,b,h,f,l,w,t]);ce(()=>{S&&O.current(R.current,E.current)},[S]),ce(()=>{!k&&!S&&x()},[k,S,x]),I.current=u,ce(()=>{var D,M;S&&s&&((D=H.current)==null||D.dispose(),H.current=(M=R.current)==null?void 0:M.onDidChangeModelContent(F=>{j.current||s(R.current.getValue(),F)}))},[S,s]),ce(()=>{if(S){let D=E.current.editor.onDidChangeMarkers(M=>{var z;let F=(z=R.current.getModel())==null?void 0:z.uri;if(F&&M.find(G=>G.path===F.path)){let G=E.current.editor.getModelMarkers({resource:F});_==null||_(G)}});return()=>{D==null||D.dispose()}}return()=>{}},[S,_]);function T(){var D,M;(D=H.current)==null||D.dispose(),g?l&&ct.set(b,R.current.saveViewState()):(M=R.current.getModel())==null||M.dispose(),R.current.dispose()}return Be.createElement(fr,{width:v,height:C,isEditorReady:S,loading:o,_ref:B,className:p,wrapperProps:n})}var Ln=xn,Rn=kt(Ln),Dn=0;function W(c,e,r,u,d,b){e||(e={});var w,t,o=e;if("ref"in o)for(t in o={},e)t=="ref"?w=e[t]:o[t]=e[t];var h={type:c,props:o,key:r,ref:w,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Dn,__i:-1,__u:0,__source:d,__self:b};if(typeof c=="function"&&(w=c.defaultProps))for(t in w)o[t]===void 0&&(o[t]=w[t]);return Z.vnode&&Z.vnode(h),h}const An=({file:c,setFile:e,hidden:r})=>{const[u,d]=le("javascript");return ce(()=>{c&&(console.log(c),c.path.endsWith(".js")?d("javascript"):c.path.endsWith(".py")?d("python"):c.path.endsWith(".html")?d("html"):c.path.endsWith(".css")?d("css"):d("plaintext"))},[c]),W("div",{className:`flex-1 border-t border-r relative border-[var(--opacity-color)] ${r?"hidden":""}`,onKeyDownCapture:b=>{b.ctrlKey&&b.key==="s"&&(b.preventDefault(),c&&pywebview.api.file.save(c.path,c.content))},children:W(Rn,{className:"absolute top-0 left-0 w-full h-full",theme:"vs-dark",defaultLanguage:"javascript",defaultValue:"",language:u,value:c?c.content:"",onChange:b=>e({...c,content:b})})})};function ei(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ae=ei();function vr(c){Ae=c}const mr=/[&<>"']/,Tn=new RegExp(mr.source,"g"),Sr=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Bn=new RegExp(Sr.source,"g"),Mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bi=c=>Mn[c];function de(c,e){if(e){if(mr.test(c))return c.replace(Tn,Bi)}else if(Sr.test(c))return c.replace(Bn,Bi);return c}const On=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Pn(c){return c.replace(On,(e,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const In=/(^|[^\[])\^/g;function ee(c,e){let r=typeof c=="string"?c:c.source;e=e||"";const u={replace:(d,b)=>{let w=typeof b=="string"?b:b.source;return w=w.replace(In,"$1"),r=r.replace(d,w),u},getRegex:()=>new RegExp(r,e)};return u}function Mi(c){try{c=encodeURI(c).replace(/%25/g,"%")}catch{return null}return c}const Ve={exec:()=>null};function Oi(c,e){const r=c.replace(/\|/g,(b,w,t)=>{let o=!1,h=w;for(;--h>=0&&t[h]==="\\";)o=!o;return o?"|":" |"}),u=r.split(/ \|/);let d=0;if(u[0].trim()||u.shift(),u.length>0&&!u[u.length-1].trim()&&u.pop(),e)if(u.length>e)u.splice(e);else for(;u.length<e;)u.push("");for(;d<u.length;d++)u[d]=u[d].trim().replace(/\\\|/g,"|");return u}function We(c,e,r){const u=c.length;if(u===0)return"";let d=0;for(;d<u;){const b=c.charAt(u-d-1);if(b===e&&!r)d++;else if(b!==e&&r)d++;else break}return c.slice(0,u-d)}function Hn(c,e){if(c.indexOf(e[1])===-1)return-1;let r=0;for(let u=0;u<c.length;u++)if(c[u]==="\\")u++;else if(c[u]===e[0])r++;else if(c[u]===e[1]&&(r--,r<0))return u;return-1}function Pi(c,e,r,u){const d=e.href,b=e.title?de(e.title):null,w=c[1].replace(/\\([\[\]])/g,"$1");if(c[0].charAt(0)!=="!"){u.state.inLink=!0;const t={type:"link",raw:r,href:d,title:b,text:w,tokens:u.inlineTokens(w)};return u.state.inLink=!1,t}return{type:"image",raw:r,href:d,title:b,text:de(w)}}function $n(c,e){const r=c.match(/^(\s+)(?:```)/);if(r===null)return e;const u=r[1];return e.split(`
`).map(d=>{const b=d.match(/^\s+/);if(b===null)return d;const[w]=b;return w.length>=u.length?d.slice(u.length):d}).join(`
`)}class gt{constructor(e){te(this,"options");te(this,"rules");te(this,"lexer");this.options=e||Ae}space(e){const r=this.rules.block.newline.exec(e);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(e){const r=this.rules.block.code.exec(e);if(r){const u=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?u:We(u,`
`)}}}fences(e){const r=this.rules.block.fences.exec(e);if(r){const u=r[0],d=$n(u,r[3]||"");return{type:"code",raw:u,lang:r[2]?r[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):r[2],text:d}}}heading(e){const r=this.rules.block.heading.exec(e);if(r){let u=r[2].trim();if(/#$/.test(u)){const d=We(u,"#");(this.options.pedantic||!d||/ $/.test(d))&&(u=d.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:u,tokens:this.lexer.inline(u)}}}hr(e){const r=this.rules.block.hr.exec(e);if(r)return{type:"hr",raw:We(r[0],`
`)}}blockquote(e){const r=this.rules.block.blockquote.exec(e);if(r){let u=We(r[0],`
`).split(`
`),d="",b="";const w=[];for(;u.length>0;){let t=!1;const o=[];let h;for(h=0;h<u.length;h++)if(/^ {0,3}>/.test(u[h]))o.push(u[h]),t=!0;else if(!t)o.push(u[h]);else break;u=u.slice(h);const f=o.join(`
`),l=f.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");d=d?`${d}
${f}`:f,b=b?`${b}
${l}`:l;const g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,w,!0),this.lexer.state.top=g,u.length===0)break;const v=w[w.length-1];if((v==null?void 0:v.type)==="code")break;if((v==null?void 0:v.type)==="blockquote"){const C=v,p=C.raw+`
`+u.join(`
`),n=this.blockquote(p);w[w.length-1]=n,d=d.substring(0,d.length-C.raw.length)+n.raw,b=b.substring(0,b.length-C.text.length)+n.text;break}else if((v==null?void 0:v.type)==="list"){const C=v,p=C.raw+`
`+u.join(`
`),n=this.list(p);w[w.length-1]=n,d=d.substring(0,d.length-v.raw.length)+n.raw,b=b.substring(0,b.length-C.raw.length)+n.raw,u=p.substring(w[w.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:d,tokens:w,text:b}}}list(e){let r=this.rules.block.list.exec(e);if(r){let u=r[1].trim();const d=u.length>1,b={type:"list",raw:"",ordered:d,start:d?+u.slice(0,-1):"",loose:!1,items:[]};u=d?`\\d{1,9}\\${u.slice(-1)}`:`\\${u}`,this.options.pedantic&&(u=d?u:"[*+-]");const w=new RegExp(`^( {0,3}${u})((?:[	 ][^\\n]*)?(?:\\n|$))`);let t="",o="",h=!1;for(;e;){let f=!1;if(!(r=w.exec(e))||this.rules.block.hr.test(e))break;t=r[0],e=e.substring(t.length);let l=r[2].split(`
`,1)[0].replace(/^\t+/,a=>" ".repeat(3*a.length)),g=e.split(`
`,1)[0],v=0;this.options.pedantic?(v=2,o=l.trimStart()):(v=r[2].search(/[^ ]/),v=v>4?1:v,o=l.slice(v),v+=r[1].length);let C=!1;if(!l&&/^ *$/.test(g)&&(t+=g+`
`,e=e.substring(g.length+1),f=!0),!f){const a=new RegExp(`^ {0,${Math.min(3,v-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),i=new RegExp(`^ {0,${Math.min(3,v-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),s=new RegExp(`^ {0,${Math.min(3,v-1)}}(?:\`\`\`|~~~)`),_=new RegExp(`^ {0,${Math.min(3,v-1)}}#`);for(;e;){const S=e.split(`
`,1)[0];if(g=S,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),s.test(g)||_.test(g)||a.test(g)||i.test(e))break;if(g.search(/[^ ]/)>=v||!g.trim())o+=`
`+g.slice(v);else{if(C||l.search(/[^ ]/)>=4||s.test(l)||_.test(l)||i.test(l))break;o+=`
`+g}!C&&!g.trim()&&(C=!0),t+=S+`
`,e=e.substring(S.length+1),l=g.slice(v)}}b.loose||(h?b.loose=!0:/\n *\n *$/.test(t)&&(h=!0));let p=null,n;this.options.gfm&&(p=/^\[[ xX]\] /.exec(o),p&&(n=p[0]!=="[ ] ",o=o.replace(/^\[[ xX]\] +/,""))),b.items.push({type:"list_item",raw:t,task:!!p,checked:n,loose:!1,text:o,tokens:[]}),b.raw+=t}b.items[b.items.length-1].raw=t.trimEnd(),b.items[b.items.length-1].text=o.trimEnd(),b.raw=b.raw.trimEnd();for(let f=0;f<b.items.length;f++)if(this.lexer.state.top=!1,b.items[f].tokens=this.lexer.blockTokens(b.items[f].text,[]),!b.loose){const l=b.items[f].tokens.filter(v=>v.type==="space"),g=l.length>0&&l.some(v=>/\n.*\n/.test(v.raw));b.loose=g}if(b.loose)for(let f=0;f<b.items.length;f++)b.items[f].loose=!0;return b}}html(e){const r=this.rules.block.html.exec(e);if(r)return{type:"html",block:!0,raw:r[0],pre:r[1]==="pre"||r[1]==="script"||r[1]==="style",text:r[0]}}def(e){const r=this.rules.block.def.exec(e);if(r){const u=r[1].toLowerCase().replace(/\s+/g," "),d=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",b=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):r[3];return{type:"def",tag:u,raw:r[0],href:d,title:b}}}table(e){const r=this.rules.block.table.exec(e);if(!r||!/[:|]/.test(r[2]))return;const u=Oi(r[1]),d=r[2].replace(/^\||\| *$/g,"").split("|"),b=r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[],w={type:"table",raw:r[0],header:[],align:[],rows:[]};if(u.length===d.length){for(const t of d)/^ *-+: *$/.test(t)?w.align.push("right"):/^ *:-+: *$/.test(t)?w.align.push("center"):/^ *:-+ *$/.test(t)?w.align.push("left"):w.align.push(null);for(let t=0;t<u.length;t++)w.header.push({text:u[t],tokens:this.lexer.inline(u[t]),header:!0,align:w.align[t]});for(const t of b)w.rows.push(Oi(t,w.header.length).map((o,h)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:w.align[h]})));return w}}lheading(e){const r=this.rules.block.lheading.exec(e);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(e){const r=this.rules.block.paragraph.exec(e);if(r){const u=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:u,tokens:this.lexer.inline(u)}}}text(e){const r=this.rules.block.text.exec(e);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(e){const r=this.rules.inline.escape.exec(e);if(r)return{type:"escape",raw:r[0],text:de(r[1])}}tag(e){const r=this.rules.inline.tag.exec(e);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:r[0]}}link(e){const r=this.rules.inline.link.exec(e);if(r){const u=r[2].trim();if(!this.options.pedantic&&/^</.test(u)){if(!/>$/.test(u))return;const w=We(u.slice(0,-1),"\\");if((u.length-w.length)%2===0)return}else{const w=Hn(r[2],"()");if(w>-1){const o=(r[0].indexOf("!")===0?5:4)+r[1].length+w;r[2]=r[2].substring(0,w),r[0]=r[0].substring(0,o).trim(),r[3]=""}}let d=r[2],b="";if(this.options.pedantic){const w=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(d);w&&(d=w[1],b=w[3])}else b=r[3]?r[3].slice(1,-1):"";return d=d.trim(),/^</.test(d)&&(this.options.pedantic&&!/>$/.test(u)?d=d.slice(1):d=d.slice(1,-1)),Pi(r,{href:d&&d.replace(this.rules.inline.anyPunctuation,"$1"),title:b&&b.replace(this.rules.inline.anyPunctuation,"$1")},r[0],this.lexer)}}reflink(e,r){let u;if((u=this.rules.inline.reflink.exec(e))||(u=this.rules.inline.nolink.exec(e))){const d=(u[2]||u[1]).replace(/\s+/g," "),b=r[d.toLowerCase()];if(!b){const w=u[0].charAt(0);return{type:"text",raw:w,text:w}}return Pi(u,b,u[0],this.lexer)}}emStrong(e,r,u=""){let d=this.rules.inline.emStrongLDelim.exec(e);if(!d||d[3]&&u.match(/[\p{L}\p{N}]/u))return;if(!(d[1]||d[2]||"")||!u||this.rules.inline.punctuation.exec(u)){const w=[...d[0]].length-1;let t,o,h=w,f=0;const l=d[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,r=r.slice(-1*e.length+w);(d=l.exec(r))!=null;){if(t=d[1]||d[2]||d[3]||d[4]||d[5]||d[6],!t)continue;if(o=[...t].length,d[3]||d[4]){h+=o;continue}else if((d[5]||d[6])&&w%3&&!((w+o)%3)){f+=o;continue}if(h-=o,h>0)continue;o=Math.min(o,o+h+f);const g=[...d[0]][0].length,v=e.slice(0,w+d.index+g+o);if(Math.min(w,o)%2){const p=v.slice(1,-1);return{type:"em",raw:v,text:p,tokens:this.lexer.inlineTokens(p)}}const C=v.slice(2,-2);return{type:"strong",raw:v,text:C,tokens:this.lexer.inlineTokens(C)}}}}codespan(e){const r=this.rules.inline.code.exec(e);if(r){let u=r[2].replace(/\n/g," ");const d=/[^ ]/.test(u),b=/^ /.test(u)&&/ $/.test(u);return d&&b&&(u=u.substring(1,u.length-1)),u=de(u,!0),{type:"codespan",raw:r[0],text:u}}}br(e){const r=this.rules.inline.br.exec(e);if(r)return{type:"br",raw:r[0]}}del(e){const r=this.rules.inline.del.exec(e);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(e){const r=this.rules.inline.autolink.exec(e);if(r){let u,d;return r[2]==="@"?(u=de(r[1]),d="mailto:"+u):(u=de(r[1]),d=u),{type:"link",raw:r[0],text:u,href:d,tokens:[{type:"text",raw:u,text:u}]}}}url(e){var u;let r;if(r=this.rules.inline.url.exec(e)){let d,b;if(r[2]==="@")d=de(r[0]),b="mailto:"+d;else{let w;do w=r[0],r[0]=((u=this.rules.inline._backpedal.exec(r[0]))==null?void 0:u[0])??"";while(w!==r[0]);d=de(r[0]),r[1]==="www."?b="http://"+r[0]:b=r[0]}return{type:"link",raw:r[0],text:d,href:b,tokens:[{type:"text",raw:d,text:d}]}}}inlineText(e){const r=this.rules.inline.text.exec(e);if(r){let u;return this.lexer.state.inRawBlock?u=r[0]:u=de(r[0]),{type:"text",raw:r[0],text:u}}}}const Fn=/^(?: *(?:\n|$))+/,Nn=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Wn=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,it=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Un=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,br=/(?:[*+-]|\d{1,9}[.)])/,yr=ee(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,br).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),ti=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jn=/^[^\n]+/,ii=/(?!\s*\])(?:\\.|[^\[\]\\])+/,zn=ee(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ii).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),qn=ee(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,br).getRegex(),xt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ri=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Kn=ee("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ri).replace("tag",xt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),wr=ee(ti).replace("hr",it).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex(),Vn=ee(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",wr).getRegex(),si={blockquote:Vn,code:Nn,def:zn,fences:Wn,heading:Un,hr:it,html:Kn,lheading:yr,list:qn,newline:Fn,paragraph:wr,table:Ve,text:jn},Ii=ee("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",it).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex(),Gn={...si,table:Ii,paragraph:ee(ti).replace("hr",it).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ii).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex()},Xn={...si,html:ee(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ri).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ve,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ee(ti).replace("hr",it).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Cr=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Jn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,kr=/^( {2,}|\\)\n(?!\s*$)/,Zn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,rt="\\p{P}\\p{S}",Yn=ee(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,rt).getRegex(),Qn=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,eo=ee(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,rt).getRegex(),to=ee("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,rt).getRegex(),io=ee("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,rt).getRegex(),ro=ee(/\\([punct])/,"gu").replace(/punct/g,rt).getRegex(),so=ee(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),no=ee(ri).replace("(?:-->|$)","-->").getRegex(),oo=ee("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",no).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),vt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ao=ee(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",vt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Er=ee(/^!?\[(label)\]\[(ref)\]/).replace("label",vt).replace("ref",ii).getRegex(),xr=ee(/^!?\[(ref)\](?:\[\])?/).replace("ref",ii).getRegex(),lo=ee("reflink|nolink(?!\\()","g").replace("reflink",Er).replace("nolink",xr).getRegex(),ni={_backpedal:Ve,anyPunctuation:ro,autolink:so,blockSkip:Qn,br:kr,code:Jn,del:Ve,emStrongLDelim:eo,emStrongRDelimAst:to,emStrongRDelimUnd:io,escape:Cr,link:ao,nolink:xr,punctuation:Yn,reflink:Er,reflinkSearch:lo,tag:oo,text:Zn,url:Ve},co={...ni,link:ee(/^!?\[(label)\]\((.*?)\)/).replace("label",vt).getRegex(),reflink:ee(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",vt).getRegex()},qt={...ni,escape:ee(Cr).replace("])","~|])").getRegex(),url:ee(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ho={...qt,br:ee(kr).replace("{2,}","*").getRegex(),text:ee(qt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ht={normal:si,gfm:Gn,pedantic:Xn},Ue={normal:ni,gfm:qt,breaks:ho,pedantic:co};class ge{constructor(e){te(this,"tokens");te(this,"options");te(this,"state");te(this,"tokenizer");te(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ae,this.options.tokenizer=this.options.tokenizer||new gt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:ht.normal,inline:Ue.normal};this.options.pedantic?(r.block=ht.pedantic,r.inline=Ue.pedantic):this.options.gfm&&(r.block=ht.gfm,this.options.breaks?r.inline=Ue.breaks:r.inline=Ue.gfm),this.tokenizer.rules=r}static get rules(){return{block:ht,inline:Ue}}static lex(e,r){return new ge(r).lex(e)}static lexInline(e,r){return new ge(r).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){const u=this.inlineQueue[r];this.inlineTokens(u.src,u.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],u=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(t,o,h)=>o+"    ".repeat(h.length));let d,b,w;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(t=>(d=t.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))){if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length),d.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length),b=r[r.length-1],b&&(b.type==="paragraph"||b.type==="text")?(b.raw+=`
`+d.raw,b.text+=`
`+d.text,this.inlineQueue[this.inlineQueue.length-1].src=b.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length),b=r[r.length-1],b&&(b.type==="paragraph"||b.type==="text")?(b.raw+=`
`+d.raw,b.text+=`
`+d.raw,this.inlineQueue[this.inlineQueue.length-1].src=b.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title});continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(w=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const o=e.slice(1);let h;this.options.extensions.startBlock.forEach(f=>{h=f.call({lexer:this},o),typeof h=="number"&&h>=0&&(t=Math.min(t,h))}),t<1/0&&t>=0&&(w=e.substring(0,t+1))}if(this.state.top&&(d=this.tokenizer.paragraph(w))){b=r[r.length-1],u&&(b==null?void 0:b.type)==="paragraph"?(b.raw+=`
`+d.raw,b.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=b.text):r.push(d),u=w.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length),b=r[r.length-1],b&&b.type==="text"?(b.raw+=`
`+d.raw,b.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=b.text):r.push(d);continue}if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}else throw new Error(t)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){let u,d,b,w=e,t,o,h;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(t=this.tokenizer.rules.inline.reflinkSearch.exec(w))!=null;)f.includes(t[0].slice(t[0].lastIndexOf("[")+1,-1))&&(w=w.slice(0,t.index)+"["+"a".repeat(t[0].length-2)+"]"+w.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(t=this.tokenizer.rules.inline.blockSkip.exec(w))!=null;)w=w.slice(0,t.index)+"["+"a".repeat(t[0].length-2)+"]"+w.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(t=this.tokenizer.rules.inline.anyPunctuation.exec(w))!=null;)w=w.slice(0,t.index)+"++"+w.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(o||(h=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(u=f.call({lexer:this},e,r))?(e=e.substring(u.raw.length),r.push(u),!0):!1))){if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),d=r[r.length-1],d&&u.type==="text"&&d.type==="text"?(d.raw+=u.raw,d.text+=u.text):r.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length),d=r[r.length-1],d&&u.type==="text"&&d.type==="text"?(d.raw+=u.raw,d.text+=u.text):r.push(u);continue}if(u=this.tokenizer.emStrong(e,w,h)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),r.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),r.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),r.push(u);continue}if(b=e,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const l=e.slice(1);let g;this.options.extensions.startInline.forEach(v=>{g=v.call({lexer:this},l),typeof g=="number"&&g>=0&&(f=Math.min(f,g))}),f<1/0&&f>=0&&(b=e.substring(0,f+1))}if(u=this.tokenizer.inlineText(b)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(h=u.raw.slice(-1)),o=!0,d=r[r.length-1],d&&d.type==="text"?(d.raw+=u.raw,d.text+=u.text):r.push(u);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return r}}class mt{constructor(e){te(this,"options");te(this,"parser");this.options=e||Ae}space(e){return""}code({text:e,lang:r,escaped:u}){var w;const d=(w=(r||"").match(/^\S*/))==null?void 0:w[0],b=e.replace(/\n$/,"")+`
`;return d?'<pre><code class="language-'+de(d)+'">'+(u?b:de(b,!0))+`</code></pre>
`:"<pre><code>"+(u?b:de(b,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:r}){return`<h${r}>${this.parser.parseInline(e)}</h${r}>
`}hr(e){return`<hr>
`}list(e){const r=e.ordered,u=e.start;let d="";for(let t=0;t<e.items.length;t++){const o=e.items[t];d+=this.listitem(o)}const b=r?"ol":"ul",w=r&&u!==1?' start="'+u+'"':"";return"<"+b+w+`>
`+d+"</"+b+`>
`}listitem(e){let r="";if(e.task){const u=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=u+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=u+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:u+" ",text:u+" "}):r+=u+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let r="",u="";for(let b=0;b<e.header.length;b++)u+=this.tablecell(e.header[b]);r+=this.tablerow({text:u});let d="";for(let b=0;b<e.rows.length;b++){const w=e.rows[b];u="";for(let t=0;t<w.length;t++)u+=this.tablecell(w[t]);d+=this.tablerow({text:u})}return d&&(d=`<tbody>${d}</tbody>`),`<table>
<thead>
`+r+`</thead>
`+d+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const r=this.parser.parseInline(e.tokens),u=e.header?"th":"td";return(e.align?`<${u} align="${e.align}">`:`<${u}>`)+r+`</${u}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:r,tokens:u}){const d=this.parser.parseInline(u),b=Mi(e);if(b===null)return d;e=b;let w='<a href="'+e+'"';return r&&(w+=' title="'+r+'"'),w+=">"+d+"</a>",w}image({href:e,title:r,text:u}){const d=Mi(e);if(d===null)return u;e=d;let b=`<img src="${e}" alt="${u}"`;return r&&(b+=` title="${r}"`),b+=">",b}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class oi{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class ve{constructor(e){te(this,"options");te(this,"renderer");te(this,"textRenderer");this.options=e||Ae,this.options.renderer=this.options.renderer||new mt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new oi}static parse(e,r){return new ve(r).parse(e)}static parseInline(e,r){return new ve(r).parseInline(e)}parse(e,r=!0){let u="";for(let d=0;d<e.length;d++){const b=e[d];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]){const t=b,o=this.options.extensions.renderers[t.type].call({parser:this},t);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(t.type)){u+=o||"";continue}}const w=b;switch(w.type){case"space":{u+=this.renderer.space(w);continue}case"hr":{u+=this.renderer.hr(w);continue}case"heading":{u+=this.renderer.heading(w);continue}case"code":{u+=this.renderer.code(w);continue}case"table":{u+=this.renderer.table(w);continue}case"blockquote":{u+=this.renderer.blockquote(w);continue}case"list":{u+=this.renderer.list(w);continue}case"html":{u+=this.renderer.html(w);continue}case"paragraph":{u+=this.renderer.paragraph(w);continue}case"text":{let t=w,o=this.renderer.text(t);for(;d+1<e.length&&e[d+1].type==="text";)t=e[++d],o+=`
`+this.renderer.text(t);r?u+=this.renderer.paragraph({type:"paragraph",raw:o,text:o,tokens:[{type:"text",raw:o,text:o}]}):u+=o;continue}default:{const t='Token with "'+w.type+'" type was not found.';if(this.options.silent)return console.error(t),"";throw new Error(t)}}}return u}parseInline(e,r){r=r||this.renderer;let u="";for(let d=0;d<e.length;d++){const b=e[d];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[b.type]){const t=this.options.extensions.renderers[b.type].call({parser:this},b);if(t!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(b.type)){u+=t||"";continue}}const w=b;switch(w.type){case"escape":{u+=r.text(w);break}case"html":{u+=r.html(w);break}case"link":{u+=r.link(w);break}case"image":{u+=r.image(w);break}case"strong":{u+=r.strong(w);break}case"em":{u+=r.em(w);break}case"codespan":{u+=r.codespan(w);break}case"br":{u+=r.br(w);break}case"del":{u+=r.del(w);break}case"text":{u+=r.text(w);break}default:{const t='Token with "'+w.type+'" type was not found.';if(this.options.silent)return console.error(t),"";throw new Error(t)}}}return u}}class Ge{constructor(e){te(this,"options");this.options=e||Ae}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}te(Ge,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var St,Lr,Ye,Kt,bt,Rr;class uo{constructor(...e){ot(this,St);ot(this,Ye);ot(this,bt);te(this,"defaults",ei());te(this,"options",this.setOptions);te(this,"parse",Ne(this,Ye,Kt).call(this,ge.lex,ve.parse));te(this,"parseInline",Ne(this,Ye,Kt).call(this,ge.lexInline,ve.parseInline));te(this,"Parser",ve);te(this,"Renderer",mt);te(this,"TextRenderer",oi);te(this,"Lexer",ge);te(this,"Tokenizer",gt);te(this,"Hooks",Ge);this.use(...e)}walkTokens(e,r){var d,b;let u=[];for(const w of e)switch(u=u.concat(r.call(this,w)),w.type){case"table":{const t=w;for(const o of t.header)u=u.concat(this.walkTokens(o.tokens,r));for(const o of t.rows)for(const h of o)u=u.concat(this.walkTokens(h.tokens,r));break}case"list":{const t=w;u=u.concat(this.walkTokens(t.items,r));break}default:{const t=w;(b=(d=this.defaults.extensions)==null?void 0:d.childTokens)!=null&&b[t.type]?this.defaults.extensions.childTokens[t.type].forEach(o=>{const h=t[o].flat(1/0);u=u.concat(this.walkTokens(h,r))}):t.tokens&&(u=u.concat(this.walkTokens(t.tokens,r)))}}return u}use(...e){const r=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(u=>{const d={...u};if(d.async=this.defaults.async||d.async||!1,u.extensions&&(u.extensions.forEach(b=>{if(!b.name)throw new Error("extension name required");if("renderer"in b){const w=r.renderers[b.name];w?r.renderers[b.name]=function(...t){let o=b.renderer.apply(this,t);return o===!1&&(o=w.apply(this,t)),o}:r.renderers[b.name]=b.renderer}if("tokenizer"in b){if(!b.level||b.level!=="block"&&b.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const w=r[b.level];w?w.unshift(b.tokenizer):r[b.level]=[b.tokenizer],b.start&&(b.level==="block"?r.startBlock?r.startBlock.push(b.start):r.startBlock=[b.start]:b.level==="inline"&&(r.startInline?r.startInline.push(b.start):r.startInline=[b.start]))}"childTokens"in b&&b.childTokens&&(r.childTokens[b.name]=b.childTokens)}),d.extensions=r),u.renderer){const b=this.defaults.renderer||new mt(this.defaults);for(const w in u.renderer){if(!(w in b))throw new Error(`renderer '${w}' does not exist`);if(["options","parser"].includes(w))continue;const t=w;let o=u.renderer[t];const h=b[t];b[t]=(...f)=>{u.useNewRenderer||(o=Ne(this,St,Lr).call(this,o,t,b));let l=o.apply(b,f);return l===!1&&(l=h.apply(b,f)),l||""}}d.renderer=b}if(u.tokenizer){const b=this.defaults.tokenizer||new gt(this.defaults);for(const w in u.tokenizer){if(!(w in b))throw new Error(`tokenizer '${w}' does not exist`);if(["options","rules","lexer"].includes(w))continue;const t=w,o=u.tokenizer[t],h=b[t];b[t]=(...f)=>{let l=o.apply(b,f);return l===!1&&(l=h.apply(b,f)),l}}d.tokenizer=b}if(u.hooks){const b=this.defaults.hooks||new Ge;for(const w in u.hooks){if(!(w in b))throw new Error(`hook '${w}' does not exist`);if(w==="options")continue;const t=w,o=u.hooks[t],h=b[t];Ge.passThroughHooks.has(w)?b[t]=f=>{if(this.defaults.async)return Promise.resolve(o.call(b,f)).then(g=>h.call(b,g));const l=o.call(b,f);return h.call(b,l)}:b[t]=(...f)=>{let l=o.apply(b,f);return l===!1&&(l=h.apply(b,f)),l}}d.hooks=b}if(u.walkTokens){const b=this.defaults.walkTokens,w=u.walkTokens;d.walkTokens=function(t){let o=[];return o.push(w.call(this,t)),b&&(o=o.concat(b.call(this,t))),o}}this.defaults={...this.defaults,...d}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,r){return ge.lex(e,r??this.defaults)}parser(e,r){return ve.parse(e,r??this.defaults)}}St=new WeakSet,Lr=function(e,r,u){switch(r){case"heading":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(u.parser.parseInline(d.tokens),d.depth,Pn(u.parser.parseInline(d.tokens,u.parser.textRenderer)))};case"code":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.text,d.lang,!!d.escaped)};case"table":return function(d){if(!d.type||d.type!==r)return e.apply(this,arguments);let b="",w="";for(let o=0;o<d.header.length;o++)w+=this.tablecell({text:d.header[o].text,tokens:d.header[o].tokens,header:!0,align:d.align[o]});b+=this.tablerow({text:w});let t="";for(let o=0;o<d.rows.length;o++){const h=d.rows[o];w="";for(let f=0;f<h.length;f++)w+=this.tablecell({text:h[f].text,tokens:h[f].tokens,header:!1,align:d.align[f]});t+=this.tablerow({text:w})}return e(b,t)};case"blockquote":return function(d){if(!d.type||d.type!==r)return e.apply(this,arguments);const b=this.parser.parse(d.tokens);return e(b)};case"list":return function(d){if(!d.type||d.type!==r)return e.apply(this,arguments);const b=d.ordered,w=d.start,t=d.loose;let o="";for(let h=0;h<d.items.length;h++){const f=d.items[h],l=f.checked,g=f.task;let v="";if(f.task){const C=this.checkbox({checked:!!l});t?f.tokens.length>0&&f.tokens[0].type==="paragraph"?(f.tokens[0].text=C+" "+f.tokens[0].text,f.tokens[0].tokens&&f.tokens[0].tokens.length>0&&f.tokens[0].tokens[0].type==="text"&&(f.tokens[0].tokens[0].text=C+" "+f.tokens[0].tokens[0].text)):f.tokens.unshift({type:"text",text:C+" "}):v+=C+" "}v+=this.parser.parse(f.tokens,t),o+=this.listitem({type:"list_item",raw:v,text:v,task:g,checked:!!l,loose:t,tokens:f.tokens})}return e(o,b,w)};case"html":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.text,d.block)};case"paragraph":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(this.parser.parseInline(d.tokens))};case"escape":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.text)};case"link":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.href,d.title,this.parser.parseInline(d.tokens))};case"image":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.href,d.title,d.text)};case"strong":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(this.parser.parseInline(d.tokens))};case"em":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(this.parser.parseInline(d.tokens))};case"codespan":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.text)};case"del":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(this.parser.parseInline(d.tokens))};case"text":return function(d){return!d.type||d.type!==r?e.apply(this,arguments):e(d.text)}}return e},Ye=new WeakSet,Kt=function(e,r){return(u,d)=>{const b={...d},w={...this.defaults,...b};this.defaults.async===!0&&b.async===!1&&(w.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),w.async=!0);const t=Ne(this,bt,Rr).call(this,!!w.silent,!!w.async);if(typeof u>"u"||u===null)return t(new Error("marked(): input parameter is undefined or null"));if(typeof u!="string")return t(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(u)+", string expected"));if(w.hooks&&(w.hooks.options=w),w.async)return Promise.resolve(w.hooks?w.hooks.preprocess(u):u).then(o=>e(o,w)).then(o=>w.hooks?w.hooks.processAllTokens(o):o).then(o=>w.walkTokens?Promise.all(this.walkTokens(o,w.walkTokens)).then(()=>o):o).then(o=>r(o,w)).then(o=>w.hooks?w.hooks.postprocess(o):o).catch(t);try{w.hooks&&(u=w.hooks.preprocess(u));let o=e(u,w);w.hooks&&(o=w.hooks.processAllTokens(o)),w.walkTokens&&this.walkTokens(o,w.walkTokens);let h=r(o,w);return w.hooks&&(h=w.hooks.postprocess(h)),h}catch(o){return t(o)}}},bt=new WeakSet,Rr=function(e,r){return u=>{if(u.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const d="<p>An error occurred:</p><pre>"+de(u.message+"",!0)+"</pre>";return r?Promise.resolve(d):d}if(r)return Promise.reject(u);throw u}};const De=new uo;function Q(c,e){return De.parse(c,e)}Q.options=Q.setOptions=function(c){return De.setOptions(c),Q.defaults=De.defaults,vr(Q.defaults),Q};Q.getDefaults=ei;Q.defaults=Ae;Q.use=function(...c){return De.use(...c),Q.defaults=De.defaults,vr(Q.defaults),Q};Q.walkTokens=function(c,e){return De.walkTokens(c,e)};Q.parseInline=De.parseInline;Q.Parser=ve;Q.parser=ve.parse;Q.Renderer=mt;Q.TextRenderer=oi;Q.Lexer=ge;Q.lexer=ge.lex;Q.Tokenizer=gt;Q.Hooks=Ge;Q.parse=Q;Q.options;Q.setOptions;Q.use;Q.walkTokens;Q.parseInline;ve.parse;ge.lex;const _o=({hidden:c})=>{const[e,r]=le(),[u,d]=le([]),b=t=>Q(t),w=t=>{t.preventDefault();const h=new FormData(t.target).get("message");t.target.children[0].value="",h&&(d(f=>[...f,{message:h,sender:"You"}]),pywebview.api.gemini.send(h).then(f=>{d(l=>[...l,{message:f,sender:"Gemini"}])}))};return e?W("div",{className:`${c?"hidden":"flex"} flex-col h-full border-t border-[var(--opacity-color)] flex-1 relative`,children:[W("div",{className:"flex flex-col p-10 gap-2 h-3/4 overflow-y-auto",children:u.length>0?u.map(({message:t,sender:o},h)=>W("div",{className:`p-2 rounded-md bg-[var(--primary-color)]  flex flex-col gap-1 ${o==="You"?"items-end":"items-start"}`,children:[W("span",{className:"text-xs font-semibold text-gray-400",children:o}),W("div",{className:"text-sm text-gray-200",dangerouslySetInnerHTML:{__html:b(t)}})]},h)):W("div",{className:"h-full w-full flex justify-center items-center",children:W("span",{className:"text-gray-400",children:"No messages yet"})})}),W("form",{action:"",onSubmit:w,className:" px-5 h-1/4 flex items-center w-full",children:W("input",{id:"message",name:"message",type:"text",class:" w-full p-2  border border-[var(--opacity-color)] rounded-md bg-[var(--primary-color)] "})})]}):W("form",{className:`${c?"hidden":"flex"} flex-col h-full border-t border-[var(--opacity-color)] flex-1  justify-center  gap-3 px-10`,onSubmit:t=>{t.preventDefault();const h=new FormData(t.target).get("apiKey");pywebview.api.gemini.init(h).then(()=>{r(h)})},children:[W("label",{htmlFor:"apiKey",children:"Enter your Gemini API Key"}),W("input",{required:!0,type:"password",class:"block w-full p-2  border border-[var(--opacity-color)] rounded-md bg-[var(--primary-color)]",name:"apiKey",id:"apiKey"}),W("p",{children:["if you don't have a Gemini API Key, you can get one by visiting ",W("a",{target:"_blank",className:"text-slate-500",href:"https://aistudio.google.com/app/apikey",children:[" ",W("b",{children:"Ai studio"})]})]}),W("button",{type:"submit",class:"bg-[var(--primary-color)] text-white p-2 rounded-md w-fit",children:"Submit"})]})},fo=({setFile:c,file:e})=>{const[r,u]=le(1);return W("div",{className:"flex flex-col h-2/3 border border-[var(--opacity-color)] ",children:[W("div",{children:[W("button",{onClick:()=>u(1),className:`${r===1?"bg-[var(--primary-color)]":""} border-r border-[var(--opacity-color)] text-white w-16`,children:"Editor"}),W("button",{onClick:()=>u(2),className:`${r===2?"bg-[var(--primary-color)]":""} border-r border-[var(--opacity-color)] text-white w-16`,children:"Chat"})]}),W(An,{hidden:r!==1,setFile:c,file:e}),W(_o,{hidden:r!==2})]})};var Dr={exports:{}};(function(c,e){(function(r,u){c.exports=u()})(globalThis,()=>(()=>{var r={4567:function(w,t,o){var h=this&&this.__decorate||function(i,s,_,S){var y,k=arguments.length,m=k<3?s:S===null?S=Object.getOwnPropertyDescriptor(s,_):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(i,s,_,S);else for(var E=i.length-1;E>=0;E--)(y=i[E])&&(m=(k<3?y(m):k>3?y(s,_,m):y(s,_))||m);return k>3&&m&&Object.defineProperty(s,_,m),m},f=this&&this.__param||function(i,s){return function(_,S){s(_,S,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const l=o(9042),g=o(9924),v=o(844),C=o(4725),p=o(2585),n=o(3656);let a=t.AccessibilityManager=class extends v.Disposable{constructor(i,s,_,S){super(),this._terminal=i,this._coreBrowserService=_,this._renderService=S,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let y=0;y<this._terminal.rows;y++)this._rowElements[y]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[y]);if(this._topBoundaryFocusListener=y=>this._handleBoundaryFocus(y,0),this._bottomBoundaryFocusListener=y=>this._handleBoundaryFocus(y,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new g.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(y=>this._handleResize(y.rows))),this.register(this._terminal.onRender(y=>this._refreshRows(y.start,y.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(y=>this._handleChar(y))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(y=>this._handleTab(y))),this.register(this._terminal.onKey(y=>this._handleKey(y.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,n.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,v.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let s=0;s<i;s++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=l.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(i){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(i)||this._charsToConsume.push(i)}_refreshRows(i,s){this._liveRegionDebouncer.refresh(i,s,this._terminal.rows)}_renderRows(i,s){const _=this._terminal.buffer,S=_.lines.length.toString();for(let y=i;y<=s;y++){const k=_.lines.get(_.ydisp+y),m=[],E=(k==null?void 0:k.translateToString(!0,void 0,void 0,m))||"",R=(_.ydisp+y+1).toString(),B=this._rowElements[y];B&&(E.length===0?(B.innerText=" ",this._rowColumns.set(B,[0,1])):(B.textContent=E,this._rowColumns.set(B,m)),B.setAttribute("aria-posinset",R),B.setAttribute("aria-setsize",S))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,s){const _=i.target,S=this._rowElements[s===0?1:this._rowElements.length-2];if(_.getAttribute("aria-posinset")===(s===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==S)return;let y,k;if(s===0?(y=_,k=this._rowElements.pop(),this._rowContainer.removeChild(k)):(y=this._rowElements.shift(),k=_,this._rowContainer.removeChild(y)),y.removeEventListener("focus",this._topBoundaryFocusListener),k.removeEventListener("focus",this._bottomBoundaryFocusListener),s===0){const m=this._createAccessibilityTreeNode();this._rowElements.unshift(m),this._rowContainer.insertAdjacentElement("afterbegin",m)}else{const m=this._createAccessibilityTreeNode();this._rowElements.push(m),this._rowContainer.appendChild(m)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(s===0?-1:1),this._rowElements[s===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleSelectionChange(){var E;if(this._rowElements.length===0)return;const i=document.getSelection();if(!i)return;if(i.isCollapsed)return void(this._rowContainer.contains(i.anchorNode)&&this._terminal.clearSelection());if(!i.anchorNode||!i.focusNode)return void console.error("anchorNode and/or focusNode are null");let s={node:i.anchorNode,offset:i.anchorOffset},_={node:i.focusNode,offset:i.focusOffset};if((s.node.compareDocumentPosition(_.node)&Node.DOCUMENT_POSITION_PRECEDING||s.node===_.node&&s.offset>_.offset)&&([s,_]=[_,s]),s.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(s={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(s.node))return;const S=this._rowElements.slice(-1)[0];if(_.node.compareDocumentPosition(S)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(_={node:S,offset:((E=S.textContent)==null?void 0:E.length)??0}),!this._rowContainer.contains(_.node))return;const y=({node:R,offset:B})=>{const O=R instanceof Text?R.parentNode:R;let A=parseInt(O==null?void 0:O.getAttribute("aria-posinset"),10)-1;if(isNaN(A))return console.warn("row is invalid. Race condition?"),null;const H=this._rowColumns.get(O);if(!H)return console.warn("columns is null. Race condition?"),null;let I=B<H.length?H[B]:H.slice(-1)[0]+1;return I>=this._terminal.cols&&(++A,I=0),{row:A,column:I}},k=y(s),m=y(_);if(k&&m){if(k.row>m.row||k.row===m.row&&k.column>=m.column)throw new Error("invalid range");this._terminal.select(k.column,k.row,(m.row-k.row)*this._terminal.cols-k.column+m.column)}}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let s=this._rowContainer.children.length;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=this._coreBrowserService.mainDocument.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};t.AccessibilityManager=a=h([f(1,p.IInstantiationService),f(2,C.ICoreBrowserService),f(3,C.IRenderService)],a)},3614:(w,t)=>{function o(g){return g.replace(/\r?\n/g,"\r")}function h(g,v){return v?"\x1B[200~"+g+"\x1B[201~":g}function f(g,v,C,p){g=h(g=o(g),C.decPrivateModes.bracketedPasteMode&&p.rawOptions.ignoreBracketedPasteMode!==!0),C.triggerDataEvent(g,!0),v.value=""}function l(g,v,C){const p=C.getBoundingClientRect(),n=g.clientX-p.left-10,a=g.clientY-p.top-10;v.style.width="20px",v.style.height="20px",v.style.left=`${n}px`,v.style.top=`${a}px`,v.style.zIndex="1000",v.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=o,t.bracketTextForPaste=h,t.copyHandler=function(g,v){g.clipboardData&&g.clipboardData.setData("text/plain",v.selectionText),g.preventDefault()},t.handlePasteEvent=function(g,v,C,p){g.stopPropagation(),g.clipboardData&&f(g.clipboardData.getData("text/plain"),v,C,p)},t.paste=f,t.moveTextAreaUnderMouseCursor=l,t.rightClickHandler=function(g,v,C,p,n){l(g,v,C),n&&p.rightClickSelect(g),v.value=p.selectionText,v.select()}},7239:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const h=o(1505);t.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(f,l,g){this._css.set(f,l,g)}getCss(f,l){return this._css.get(f,l)}setColor(f,l,g){this._color.set(f,l,g)}getColor(f,l){return this._color.get(f,l)}clear(){this._color.clear(),this._css.clear()}}},3656:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(o,h,f,l){o.addEventListener(h,f,l);let g=!1;return{dispose:()=>{g||(g=!0,o.removeEventListener(h,f,l))}}}},3551:function(w,t,o){var h=this&&this.__decorate||function(a,i,s,_){var S,y=arguments.length,k=y<3?i:_===null?_=Object.getOwnPropertyDescriptor(i,s):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(a,i,s,_);else for(var m=a.length-1;m>=0;m--)(S=a[m])&&(k=(y<3?S(k):y>3?S(i,s,k):S(i,s))||k);return y>3&&k&&Object.defineProperty(i,s,k),k},f=this&&this.__param||function(a,i){return function(s,_){i(s,_,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;const l=o(3656),g=o(8460),v=o(844),C=o(2585),p=o(4725);let n=t.Linkifier=class extends v.Disposable{get currentLink(){return this._currentLink}constructor(a,i,s,_,S){super(),this._element=a,this._mouseService=i,this._renderService=s,this._bufferService=_,this._linkProviderService=S,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new g.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new g.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,v.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,v.toDisposable)(()=>{var y;this._lastMouseEvent=void 0,(y=this._activeProviderReplies)==null||y.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,l.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,l.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,l.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(a){this._lastMouseEvent=a;const i=this._positionFromMouseEvent(a,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;const s=a.composedPath();for(let _=0;_<s.length;_++){const S=s[_];if(S.classList.contains("xterm"))break;if(S.classList.contains("xterm-hover"))return}this._lastBufferCell&&i.x===this._lastBufferCell.x&&i.y===this._lastBufferCell.y||(this._handleHover(i),this._lastBufferCell=i)}_handleHover(a){if(this._activeLine!==a.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(a,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,a)||(this._clearCurrentLink(),this._askForLink(a,!0))}_askForLink(a,i){var _,S;this._activeProviderReplies&&i||((_=this._activeProviderReplies)==null||_.forEach(y=>{y==null||y.forEach(k=>{k.link.dispose&&k.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=a.y);let s=!1;for(const[y,k]of this._linkProviderService.linkProviders.entries())i?(S=this._activeProviderReplies)!=null&&S.get(y)&&(s=this._checkLinkProviderResult(y,a,s)):k.provideLinks(a.y,m=>{var R,B;if(this._isMouseOut)return;const E=m==null?void 0:m.map(O=>({link:O}));(R=this._activeProviderReplies)==null||R.set(y,E),s=this._checkLinkProviderResult(y,a,s),((B=this._activeProviderReplies)==null?void 0:B.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(a.y,this._activeProviderReplies)})}_removeIntersectingLinks(a,i){const s=new Set;for(let _=0;_<i.size;_++){const S=i.get(_);if(S)for(let y=0;y<S.length;y++){const k=S[y],m=k.link.range.start.y<a?0:k.link.range.start.x,E=k.link.range.end.y>a?this._bufferService.cols:k.link.range.end.x;for(let R=m;R<=E;R++){if(s.has(R)){S.splice(y--,1);break}s.add(R)}}}}_checkLinkProviderResult(a,i,s){var y;if(!this._activeProviderReplies)return s;const _=this._activeProviderReplies.get(a);let S=!1;for(let k=0;k<a;k++)this._activeProviderReplies.has(k)&&!this._activeProviderReplies.get(k)||(S=!0);if(!S&&_){const k=_.find(m=>this._linkAtPosition(m.link,i));k&&(s=!0,this._handleNewLink(k))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!s)for(let k=0;k<this._activeProviderReplies.size;k++){const m=(y=this._activeProviderReplies.get(k))==null?void 0:y.find(E=>this._linkAtPosition(E.link,i));if(m){s=!0,this._handleNewLink(m);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(a){if(!this._currentLink)return;const i=this._positionFromMouseEvent(a,this._element,this._mouseService);i&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(a,this._currentLink.link.text)}_clearCurrentLink(a,i){this._currentLink&&this._lastMouseEvent&&(!a||!i||this._currentLink.link.range.start.y>=a&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,v.disposeArray)(this._linkCacheDisposables))}_handleNewLink(a){if(!this._lastMouseEvent)return;const i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(a.link,i)&&(this._currentLink=a,this._currentLink.state={decorations:{underline:a.link.decorations===void 0||a.link.decorations.underline,pointerCursor:a.link.decorations===void 0||a.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,a.link,this._lastMouseEvent),a.link.decorations={},Object.defineProperties(a.link.decorations,{pointerCursor:{get:()=>{var s,_;return(_=(s=this._currentLink)==null?void 0:s.state)==null?void 0:_.decorations.pointerCursor},set:s=>{var _;(_=this._currentLink)!=null&&_.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",s))}},underline:{get:()=>{var s,_;return(_=(s=this._currentLink)==null?void 0:s.state)==null?void 0:_.decorations.underline},set:s=>{var _,S,y;(_=this._currentLink)!=null&&_.state&&((y=(S=this._currentLink)==null?void 0:S.state)==null?void 0:y.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(a.link,s))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const _=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,S=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=_&&this._currentLink.link.range.end.y<=S&&(this._clearCurrentLink(_,S),this._lastMouseEvent)){const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._askForLink(y,!1)}})))}_linkHover(a,i,s){var _;(_=this._currentLink)!=null&&_.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&a.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(s,i.text)}_fireUnderlineEvent(a,i){const s=a.range,_=this._bufferService.buffer.ydisp,S=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-_-1,s.end.x,s.end.y-_-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(S)}_linkLeave(a,i,s){var _;(_=this._currentLink)!=null&&_.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&a.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(s,i.text)}_linkAtPosition(a,i){const s=a.range.start.y*this._bufferService.cols+a.range.start.x,_=a.range.end.y*this._bufferService.cols+a.range.end.x,S=i.y*this._bufferService.cols+i.x;return s<=S&&S<=_}_positionFromMouseEvent(a,i,s){const _=s.getCoords(a,i,this._bufferService.cols,this._bufferService.rows);if(_)return{x:_[0],y:_[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(a,i,s,_,S){return{x1:a,y1:i,x2:s,y2:_,cols:this._bufferService.cols,fg:S}}};t.Linkifier=n=h([f(1,p.IMouseService),f(2,p.IRenderService),f(3,C.IBufferService),f(4,p.ILinkProviderService)],n)},9042:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(w,t,o){var h=this&&this.__decorate||function(p,n,a,i){var s,_=arguments.length,S=_<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,a):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,n,a,i);else for(var y=p.length-1;y>=0;y--)(s=p[y])&&(S=(_<3?s(S):_>3?s(n,a,S):s(n,a))||S);return _>3&&S&&Object.defineProperty(n,a,S),S},f=this&&this.__param||function(p,n){return function(a,i){n(a,i,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const l=o(511),g=o(2585);let v=t.OscLinkProvider=class{constructor(p,n,a){this._bufferService=p,this._optionsService=n,this._oscLinkService=a}provideLinks(p,n){var E;const a=this._bufferService.buffer.lines.get(p-1);if(!a)return void n(void 0);const i=[],s=this._optionsService.rawOptions.linkHandler,_=new l.CellData,S=a.getTrimmedLength();let y=-1,k=-1,m=!1;for(let R=0;R<S;R++)if(k!==-1||a.hasContent(R)){if(a.loadCell(R,_),_.hasExtendedAttrs()&&_.extended.urlId){if(k===-1){k=R,y=_.extended.urlId;continue}m=_.extended.urlId!==y}else k!==-1&&(m=!0);if(m||k!==-1&&R===S-1){const B=(E=this._oscLinkService.getLinkData(y))==null?void 0:E.uri;if(B){const O={start:{x:k+1,y:p},end:{x:R+(m||R!==S-1?0:1),y:p}};let A=!1;if(!(s!=null&&s.allowNonHttpProtocols))try{const H=new URL(B);["http:","https:"].includes(H.protocol)||(A=!0)}catch{A=!0}A||i.push({text:B,range:O,activate:(H,I)=>s?s.activate(H,I,O):C(0,I),hover:(H,I)=>{var N;return(N=s==null?void 0:s.hover)==null?void 0:N.call(s,H,I,O)},leave:(H,I)=>{var N;return(N=s==null?void 0:s.leave)==null?void 0:N.call(s,H,I,O)}})}m=!1,_.hasExtendedAttrs()&&_.extended.urlId?(k=R,y=_.extended.urlId):(k=-1,y=-1)}}n(i)}};function C(p,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const a=window.open();if(a){try{a.opener=null}catch{}a.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=v=h([f(0,g.IBufferService),f(1,g.IOptionsService),f(2,g.IOscLinkService)],v)},6193:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(o,h){this._renderCallback=o,this._coreBrowserService=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(o){return this._refreshCallbacks.push(o),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(o,h,f){this._rowCount=f,o=o!==void 0?o:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const o=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const o of this._refreshCallbacks)o(0);this._refreshCallbacks=[]}}},3236:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const h=o(3614),f=o(3656),l=o(3551),g=o(9042),v=o(3730),C=o(1680),p=o(3107),n=o(5744),a=o(2950),i=o(1296),s=o(428),_=o(4269),S=o(5114),y=o(8934),k=o(3230),m=o(9312),E=o(4725),R=o(6731),B=o(8055),O=o(8969),A=o(8460),H=o(844),I=o(6114),N=o(8437),q=o(2584),j=o(7399),x=o(5941),T=o(9074),D=o(2585),M=o(5435),F=o(4567),z=o(779);class G extends O.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(P={}){super(P),this.browser=I,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new H.MutableDisposable),this._onCursorMove=this.register(new A.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new A.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new A.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new A.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new A.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new A.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new A.EventEmitter),this._onBlur=this.register(new A.EventEmitter),this._onA11yCharEmitter=this.register(new A.EventEmitter),this._onA11yTabEmitter=this.register(new A.EventEmitter),this._onWillOpen=this.register(new A.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(T.DecorationService),this._instantiationService.setService(D.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(z.LinkProviderService),this._instantiationService.setService(E.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(v.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((L,U)=>this.refresh(L,U))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(L=>this._reportWindowsOptions(L))),this.register(this._inputHandler.onColor(L=>this._handleColorEvent(L))),this.register((0,A.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,A.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,A.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(L=>this._afterResize(L.cols,L.rows))),this.register((0,H.toDisposable)(()=>{var L,U;this._customKeyEventHandler=void 0,(U=(L=this.element)==null?void 0:L.parentNode)==null||U.removeChild(this.element)}))}_handleColorEvent(P){if(this._themeService)for(const L of P){let U,$="";switch(L.index){case 256:U="foreground",$="10";break;case 257:U="background",$="11";break;case 258:U="cursor",$="12";break;default:U="ansi",$="4;"+L.index}switch(L.type){case 0:const V=B.color.toColorRGB(U==="ansi"?this._themeService.colors.ansi[L.index]:this._themeService.colors[U]);this.coreService.triggerDataEvent(`${q.C0.ESC}]${$};${(0,x.toRgbString)(V)}${q.C1_ESCAPED.ST}`);break;case 1:if(U==="ansi")this._themeService.modifyColors(K=>K.ansi[L.index]=B.channels.toColor(...L.color));else{const K=U;this._themeService.modifyColors(Y=>Y[K]=B.channels.toColor(...L.color))}break;case 2:this._themeService.restoreColor(L.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(P){P?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(F.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(P){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var P;return(P=this.textarea)==null?void 0:P.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const P=this.buffer.ybase+this.buffer.y,L=this.buffer.lines.get(P);if(!L)return;const U=Math.min(this.buffer.x,this.cols-1),$=this._renderService.dimensions.css.cell.height,V=L.getWidth(U),K=this._renderService.dimensions.css.cell.width*V,Y=this.buffer.y*this._renderService.dimensions.css.cell.height,ne=U*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ne+"px",this.textarea.style.top=Y+"px",this.textarea.style.width=K+"px",this.textarea.style.height=$+"px",this.textarea.style.lineHeight=$+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,f.addDisposableDomListener)(this.element,"copy",L=>{this.hasSelection()&&(0,h.copyHandler)(L,this._selectionService)}));const P=L=>(0,h.handlePasteEvent)(L,this.textarea,this.coreService,this.optionsService);this.register((0,f.addDisposableDomListener)(this.textarea,"paste",P)),this.register((0,f.addDisposableDomListener)(this.element,"paste",P)),I.isFirefox?this.register((0,f.addDisposableDomListener)(this.element,"mousedown",L=>{L.button===2&&(0,h.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,f.addDisposableDomListener)(this.element,"contextmenu",L=>{(0,h.rightClickHandler)(L,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),I.isLinux&&this.register((0,f.addDisposableDomListener)(this.element,"auxclick",L=>{L.button===1&&(0,h.moveTextAreaUnderMouseCursor)(L,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,f.addDisposableDomListener)(this.textarea,"keyup",P=>this._keyUp(P),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keydown",P=>this._keyDown(P),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keypress",P=>this._keyPress(P),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionupdate",P=>this._compositionHelper.compositionupdate(P))),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,f.addDisposableDomListener)(this.textarea,"input",P=>this._inputEvent(P),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(P){var U;if(!P)throw new Error("Terminal requires a parent element.");if(P.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((U=this.element)==null?void 0:U.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=P.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),P.appendChild(this.element);const L=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),L.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,f.addDisposableDomListener)(this.screenElement,"mousemove",$=>this.updateCursorStyle($))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),L.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",g.promptLabel),I.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(S.CoreBrowserService,this.textarea,P.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,f.addDisposableDomListener)(this.textarea,"focus",$=>this._handleTextAreaFocus($))),this.register((0,f.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(s.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(R.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(_.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange($=>this._onRender.fire($))),this.onResize($=>this._renderService.resize($.cols,$.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(a.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(y.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(l.Linkifier,this.screenElement)),this.element.appendChild(L);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(C.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines($=>this.scrollLines($.amount,$.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(m.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines($=>this.scrollLines($.amount,$.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw($=>this._renderService.handleSelectionChanged($.start,$.end,$.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection($=>{this.textarea.value=$,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event($=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,f.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(p.BufferDecorationRenderer,this.screenElement)),this.register((0,f.addDisposableDomListener)(this.element,"mousedown",$=>this._selectionService.handleMouseDown($))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(F.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",$=>this._handleScreenReaderModeOptionChange($))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",$=>{!this._overviewRulerRenderer&&$&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const P=this,L=this.element;function U(K){const Y=P._mouseService.getMouseReportCoords(K,P.screenElement);if(!Y)return!1;let ne,oe;switch(K.overrideType||K.type){case"mousemove":oe=32,K.buttons===void 0?(ne=3,K.button!==void 0&&(ne=K.button<3?K.button:3)):ne=1&K.buttons?0:4&K.buttons?1:2&K.buttons?2:3;break;case"mouseup":oe=0,ne=K.button<3?K.button:3;break;case"mousedown":oe=1,ne=K.button<3?K.button:3;break;case"wheel":if(P._customWheelEventHandler&&P._customWheelEventHandler(K)===!1||P.viewport.getLinesScrolled(K)===0)return!1;oe=K.deltaY<0?0:1,ne=4;break;default:return!1}return!(oe===void 0||ne===void 0||ne>4)&&P.coreMouseService.triggerMouseEvent({col:Y.col,row:Y.row,x:Y.x,y:Y.y,button:ne,action:oe,ctrl:K.ctrlKey,alt:K.altKey,shift:K.shiftKey})}const $={mouseup:null,wheel:null,mousedrag:null,mousemove:null},V={mouseup:K=>(U(K),K.buttons||(this._document.removeEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.removeEventListener("mousemove",$.mousedrag)),this.cancel(K)),wheel:K=>(U(K),this.cancel(K,!0)),mousedrag:K=>{K.buttons&&U(K)},mousemove:K=>{K.buttons||U(K)}};this.register(this.coreMouseService.onProtocolChange(K=>{K?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(K)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&K?$.mousemove||(L.addEventListener("mousemove",V.mousemove),$.mousemove=V.mousemove):(L.removeEventListener("mousemove",$.mousemove),$.mousemove=null),16&K?$.wheel||(L.addEventListener("wheel",V.wheel,{passive:!1}),$.wheel=V.wheel):(L.removeEventListener("wheel",$.wheel),$.wheel=null),2&K?$.mouseup||($.mouseup=V.mouseup):(this._document.removeEventListener("mouseup",$.mouseup),$.mouseup=null),4&K?$.mousedrag||($.mousedrag=V.mousedrag):(this._document.removeEventListener("mousemove",$.mousedrag),$.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,f.addDisposableDomListener)(L,"mousedown",K=>{if(K.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(K))return U(K),$.mouseup&&this._document.addEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.addEventListener("mousemove",$.mousedrag),this.cancel(K)})),this.register((0,f.addDisposableDomListener)(L,"wheel",K=>{if(!$.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(K)===!1)return!1;if(!this.buffer.hasScrollback){const Y=this.viewport.getLinesScrolled(K);if(Y===0)return;const ne=q.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(K.deltaY<0?"A":"B");let oe="";for(let he=0;he<Math.abs(Y);he++)oe+=ne;return this.coreService.triggerDataEvent(oe,!0),this.cancel(K,!0)}return this.viewport.handleWheel(K)?this.cancel(K):void 0}},{passive:!1})),this.register((0,f.addDisposableDomListener)(L,"touchstart",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(K),this.cancel(K)},{passive:!0})),this.register((0,f.addDisposableDomListener)(L,"touchmove",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(K)?void 0:this.cancel(K)},{passive:!1}))}refresh(P,L){var U;(U=this._renderService)==null||U.refreshRows(P,L)}updateCursorStyle(P){var L;(L=this._selectionService)!=null&&L.shouldColumnSelect(P)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(P,L,U=0){var $;U===1?(super.scrollLines(P,L,U),this.refresh(0,this.rows-1)):($=this.viewport)==null||$.scrollLines(P)}paste(P){(0,h.paste)(P,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(P){this._customKeyEventHandler=P}attachCustomWheelEventHandler(P){this._customWheelEventHandler=P}registerLinkProvider(P){return this._linkProviderService.registerLinkProvider(P)}registerCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const L=this._characterJoinerService.register(P);return this.refresh(0,this.rows-1),L}deregisterCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(P)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(P){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+P)}registerDecoration(P){return this._decorationService.registerDecoration(P)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(P,L,U){this._selectionService.setSelection(P,L,U)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var P;(P=this._selectionService)==null||P.clearSelection()}selectAll(){var P;(P=this._selectionService)==null||P.selectAll()}selectLines(P,L){var U;(U=this._selectionService)==null||U.selectLines(P,L)}_keyDown(P){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;const L=this.browser.isMac&&this.options.macOptionIsMeta&&P.altKey;if(!L&&!this._compositionHelper.keydown(P))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;L||P.key!=="Dead"&&P.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const U=(0,j.evaluateKeyboardEvent)(P,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(P),U.type===3||U.type===2){const $=this.rows-1;return this.scrollLines(U.type===2?-$:$),this.cancel(P,!0)}return U.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,P)||(U.cancel&&this.cancel(P,!0),!U.key||!!(P.key&&!P.ctrlKey&&!P.altKey&&!P.metaKey&&P.key.length===1&&P.key.charCodeAt(0)>=65&&P.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(U.key!==q.C0.ETX&&U.key!==q.C0.CR||(this.textarea.value=""),this._onKey.fire({key:U.key,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(U.key,!0),!this.optionsService.rawOptions.screenReaderMode||P.altKey||P.ctrlKey?this.cancel(P,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(P,L){const U=P.isMac&&!this.options.macOptionIsMeta&&L.altKey&&!L.ctrlKey&&!L.metaKey||P.isWindows&&L.altKey&&L.ctrlKey&&!L.metaKey||P.isWindows&&L.getModifierState("AltGraph");return L.type==="keypress"?U:U&&(!L.keyCode||L.keyCode>47)}_keyUp(P){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1||(function(L){return L.keyCode===16||L.keyCode===17||L.keyCode===18}(P)||this.focus(),this.updateCursorStyle(P),this._keyPressHandled=!1)}_keyPress(P){let L;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;if(this.cancel(P),P.charCode)L=P.charCode;else if(P.which===null||P.which===void 0)L=P.keyCode;else{if(P.which===0||P.charCode===0)return!1;L=P.which}return!(!L||(P.altKey||P.ctrlKey||P.metaKey)&&!this._isThirdLevelShift(this.browser,P)||(L=String.fromCharCode(L),this._onKey.fire({key:L,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(L,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(P){if(P.data&&P.inputType==="insertText"&&(!P.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const L=P.data;return this.coreService.triggerDataEvent(L,!0),this.cancel(P),!0}return!1}resize(P,L){P!==this.cols||L!==this.rows?super.resize(P,L):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(P,L){var U,$;(U=this._charSizeService)==null||U.measure(),($=this.viewport)==null||$.syncScrollArea(!0)}clear(){var P;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let L=1;L<this.rows;L++)this.buffer.lines.push(this.buffer.getBlankLine(N.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(P=this.viewport)==null||P.reset(),this.refresh(0,this.rows-1)}}reset(){var L,U;this.options.rows=this.rows,this.options.cols=this.cols;const P=this._customKeyEventHandler;this._setup(),super.reset(),(L=this._selectionService)==null||L.reset(),this._decorationService.reset(),(U=this.viewport)==null||U.reset(),this._customKeyEventHandler=P,this.refresh(0,this.rows-1)}clearTextureAtlas(){var P;(P=this._renderService)==null||P.clearTextureAtlas()}_reportFocus(){var P;(P=this.element)!=null&&P.classList.contains("focus")?this.coreService.triggerDataEvent(q.C0.ESC+"[I"):this.coreService.triggerDataEvent(q.C0.ESC+"[O")}_reportWindowsOptions(P){if(this._renderService)switch(P){case M.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const L=this._renderService.dimensions.css.canvas.width.toFixed(0),U=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${q.C0.ESC}[4;${U};${L}t`);break;case M.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const $=this._renderService.dimensions.css.cell.width.toFixed(0),V=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${q.C0.ESC}[6;${V};${$}t`)}}cancel(P,L){if(this.options.cancelEvents||L)return P.preventDefault(),P.stopPropagation(),!1}}t.Terminal=G},9924:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(o,h=1e3){this._renderCallback=o,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(o,h,f){this._rowCount=f,o=o!==void 0?o:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,o):o,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;const l=Date.now();if(l-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=l,this._innerRefresh();else if(!this._additionalRefreshRequested){const g=l-this._lastRefreshMs,v=this._debounceThresholdMS-g;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},v)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const o=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(o,h)}}},1680:function(w,t,o){var h=this&&this.__decorate||function(a,i,s,_){var S,y=arguments.length,k=y<3?i:_===null?_=Object.getOwnPropertyDescriptor(i,s):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(a,i,s,_);else for(var m=a.length-1;m>=0;m--)(S=a[m])&&(k=(y<3?S(k):y>3?S(i,s,k):S(i,s))||k);return y>3&&k&&Object.defineProperty(i,s,k),k},f=this&&this.__param||function(a,i){return function(s,_){i(s,_,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const l=o(3656),g=o(4725),v=o(8460),C=o(844),p=o(2585);let n=t.Viewport=class extends C.Disposable{constructor(a,i,s,_,S,y,k,m){super(),this._viewportElement=a,this._scrollArea=i,this._bufferService=s,this._optionsService=_,this._charSizeService=S,this._renderService=y,this._coreBrowserService=k,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,l.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(m.colors),this.register(m.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(a){this._viewportElement.style.backgroundColor=a.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(a){if(a)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const i=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==i&&(this._lastRecordedBufferHeight=i,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const a=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==a&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=a),this._refreshAnimationFrame=null}syncScrollArea(a=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(a);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(a)}_handleScroll(a){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const i=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:i,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const a=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(a*(this._smoothScrollState.target-this._smoothScrollState.origin)),a<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(a,i){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(i<0&&this._viewportElement.scrollTop!==0||i>0&&s<this._lastRecordedBufferHeight)||(a.cancelable&&a.preventDefault(),!1)}handleWheel(a){const i=this._getPixelsScrolled(a);return i!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+i:this._smoothScrollState.target+=i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=i,this._bubbleScroll(a,i))}scrollLines(a){if(a!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const i=a*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+i,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:a,suppressScrollEvent:!1})}_getPixelsScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let i=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_LINE?i*=this._currentRowHeight:a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._currentRowHeight*this._bufferService.rows),i}getBufferElements(a,i){var m;let s,_="";const S=[],y=i??this._bufferService.buffer.lines.length,k=this._bufferService.buffer.lines;for(let E=a;E<y;E++){const R=k.get(E);if(!R)continue;const B=(m=k.get(E+1))==null?void 0:m.isWrapped;if(_+=R.translateToString(!B),!B||E===k.length-1){const O=document.createElement("div");O.textContent=_,S.push(O),_.length>0&&(s=O),_=""}}return{bufferElements:S,cursorElement:s}}getLinesScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let i=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(i/=this._currentRowHeight+0,this._wheelPartialScroll+=i,i=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(i*=this._bufferService.rows),i}_applyScrollModifier(a,i){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&i.altKey||s==="ctrl"&&i.ctrlKey||s==="shift"&&i.shiftKey?a*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:a*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(a){this._lastTouchY=a.touches[0].pageY}handleTouchMove(a){const i=this._lastTouchY-a.touches[0].pageY;return this._lastTouchY=a.touches[0].pageY,i!==0&&(this._viewportElement.scrollTop+=i,this._bubbleScroll(a,i))}};t.Viewport=n=h([f(2,p.IBufferService),f(3,p.IOptionsService),f(4,g.ICharSizeService),f(5,g.IRenderService),f(6,g.ICoreBrowserService),f(7,g.IThemeService)],n)},3107:function(w,t,o){var h=this&&this.__decorate||function(p,n,a,i){var s,_=arguments.length,S=_<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,a):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,n,a,i);else for(var y=p.length-1;y>=0;y--)(s=p[y])&&(S=(_<3?s(S):_>3?s(n,a,S):s(n,a))||S);return _>3&&S&&Object.defineProperty(n,a,S),S},f=this&&this.__param||function(p,n){return function(a,i){n(a,i,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const l=o(4725),g=o(844),v=o(2585);let C=t.BufferDecorationRenderer=class extends g.Disposable{constructor(p,n,a,i,s){super(),this._screenElement=p,this._bufferService=n,this._coreBrowserService=a,this._decorationService=i,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(_=>this._removeDecoration(_))),this.register((0,g.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const p of this._decorationService.decorations)this._renderDecoration(p);this._dimensionsChanged=!1}_renderDecoration(p){this._refreshStyle(p),this._dimensionsChanged&&this._refreshXPosition(p)}_createElement(p){var i;const n=this._coreBrowserService.mainDocument.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer",((i=p==null?void 0:p.options)==null?void 0:i.layer)==="top"),n.style.width=`${Math.round((p.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(p.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(p.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const a=p.options.x??0;return a&&a>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(p,n),n}_refreshStyle(p){const n=p.marker.line-this._bufferService.buffers.active.ydisp;if(n<0||n>=this._bufferService.rows)p.element&&(p.element.style.display="none",p.onRenderEmitter.fire(p.element));else{let a=this._decorationElements.get(p);a||(a=this._createElement(p),p.element=a,this._decorationElements.set(p,a),this._container.appendChild(a),p.onDispose(()=>{this._decorationElements.delete(p),a.remove()})),a.style.top=n*this._renderService.dimensions.css.cell.height+"px",a.style.display=this._altBufferIsActive?"none":"block",p.onRenderEmitter.fire(a)}}_refreshXPosition(p,n=p.element){if(!n)return;const a=p.options.x??0;(p.options.anchor||"left")==="right"?n.style.right=a?a*this._renderService.dimensions.css.cell.width+"px":"":n.style.left=a?a*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(p){var n;(n=this._decorationElements.get(p))==null||n.remove(),this._decorationElements.delete(p),p.dispose()}};t.BufferDecorationRenderer=C=h([f(1,v.IBufferService),f(2,l.ICoreBrowserService),f(3,v.IDecorationService),f(4,l.IRenderService)],C)},5871:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(o){if(o.options.overviewRulerOptions){for(const h of this._zones)if(h.color===o.options.overviewRulerOptions.color&&h.position===o.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,o.marker.line))return;if(this._lineAdjacentToZone(h,o.marker.line,o.options.overviewRulerOptions.position))return void this._addLineToZone(h,o.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=o.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=o.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=o.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=o.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:o.options.overviewRulerOptions.color,position:o.options.overviewRulerOptions.position,startBufferLine:o.marker.line,endBufferLine:o.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(o){this._linePadding=o}_lineIntersectsZone(o,h){return h>=o.startBufferLine&&h<=o.endBufferLine}_lineAdjacentToZone(o,h,f){return h>=o.startBufferLine-this._linePadding[f||"full"]&&h<=o.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(o,h){o.startBufferLine=Math.min(o.startBufferLine,h),o.endBufferLine=Math.max(o.endBufferLine,h)}}},5744:function(w,t,o){var h=this&&this.__decorate||function(s,_,S,y){var k,m=arguments.length,E=m<3?_:y===null?y=Object.getOwnPropertyDescriptor(_,S):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(s,_,S,y);else for(var R=s.length-1;R>=0;R--)(k=s[R])&&(E=(m<3?k(E):m>3?k(_,S,E):k(_,S))||E);return m>3&&E&&Object.defineProperty(_,S,E),E},f=this&&this.__param||function(s,_){return function(S,y){_(S,y,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const l=o(5871),g=o(4725),v=o(844),C=o(2585),p={full:0,left:0,center:0,right:0},n={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0};let i=t.OverviewRulerRenderer=class extends v.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(s,_,S,y,k,m,E){var B;super(),this._viewportElement=s,this._screenElement=_,this._bufferService=S,this._decorationService=y,this._renderService=k,this._optionsService=m,this._coreBrowserService=E,this._colorZoneStore=new l.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(B=this._viewportElement.parentElement)==null||B.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var O;(O=this._canvas)==null||O.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const s=Math.floor(this._canvas.width/3),_=Math.ceil(this._canvas.width/3);n.full=this._canvas.width,n.left=s,n.center=_,n.right=s,this._refreshDrawHeightConstants(),a.full=0,a.left=0,a.center=n.left,a.right=n.left+n.center}_refreshDrawHeightConstants(){p.full=Math.round(2*this._coreBrowserService.dpr);const s=this._canvas.height/this._bufferService.buffer.lines.length,_=Math.round(Math.max(Math.min(s,12),6)*this._coreBrowserService.dpr);p.left=_,p.center=_,p.right=_}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*p.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const _ of this._decorationService.decorations)this._colorZoneStore.addDecoration(_);this._ctx.lineWidth=1;const s=this._colorZoneStore.zones;for(const _ of s)_.position!=="full"&&this._renderColorZone(_);for(const _ of s)_.position==="full"&&this._renderColorZone(_);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(s){this._ctx.fillStyle=s.color,this._ctx.fillRect(a[s.position||"full"],Math.round((this._canvas.height-1)*(s.startBufferLine/this._bufferService.buffers.active.lines.length)-p[s.position||"full"]/2),n[s.position||"full"],Math.round((this._canvas.height-1)*((s.endBufferLine-s.startBufferLine)/this._bufferService.buffers.active.lines.length)+p[s.position||"full"]))}_queueRefresh(s,_){this._shouldUpdateDimensions=s||this._shouldUpdateDimensions,this._shouldUpdateAnchor=_||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};t.OverviewRulerRenderer=i=h([f(2,C.IBufferService),f(3,C.IDecorationService),f(4,g.IRenderService),f(5,C.IOptionsService),f(6,g.ICoreBrowserService)],i)},2950:function(w,t,o){var h=this&&this.__decorate||function(p,n,a,i){var s,_=arguments.length,S=_<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,a):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,n,a,i);else for(var y=p.length-1;y>=0;y--)(s=p[y])&&(S=(_<3?s(S):_>3?s(n,a,S):s(n,a))||S);return _>3&&S&&Object.defineProperty(n,a,S),S},f=this&&this.__param||function(p,n){return function(a,i){n(a,i,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const l=o(4725),g=o(2585),v=o(2584);let C=t.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(p,n,a,i,s,_){this._textarea=p,this._compositionView=n,this._bufferService=a,this._optionsService=i,this._coreService=s,this._renderService=_,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(p){this._compositionView.textContent=p.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(p){if(this._isComposing||this._isSendingComposition){if(p.keyCode===229||p.keyCode===16||p.keyCode===17||p.keyCode===18)return!1;this._finalizeComposition(!1)}return p.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(p){if(this._compositionView.classList.remove("active"),this._isComposing=!1,p){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let a;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,a=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),a.length>0&&this._coreService.triggerDataEvent(a,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const p=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,a=n.replace(p,"");this._dataAlreadySent=a,n.length>p.length?this._coreService.triggerDataEvent(a,!0):n.length<p.length?this._coreService.triggerDataEvent(`${v.C0.DEL}`,!0):n.length===p.length&&n!==p&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(p){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const _=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(_.width,1)+"px",this._textarea.style.height=Math.max(_.height,1)+"px",this._textarea.style.lineHeight=_.height+"px"}p||setTimeout(()=>this.updateCompositionElements(!0),0)}}};t.CompositionHelper=C=h([f(2,g.IBufferService),f(3,g.IOptionsService),f(4,g.ICoreService),f(5,l.IRenderService)],C)},9806:(w,t)=>{function o(h,f,l){const g=l.getBoundingClientRect(),v=h.getComputedStyle(l),C=parseInt(v.getPropertyValue("padding-left")),p=parseInt(v.getPropertyValue("padding-top"));return[f.clientX-g.left-C,f.clientY-g.top-p]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=o,t.getCoords=function(h,f,l,g,v,C,p,n,a){if(!C)return;const i=o(h,f,l);return i?(i[0]=Math.ceil((i[0]+(a?p/2:0))/p),i[1]=Math.ceil(i[1]/n),i[0]=Math.min(Math.max(i[0],1),g+(a?1:0)),i[1]=Math.min(Math.max(i[1],1),v),i):void 0}},9504:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const h=o(2584);function f(n,a,i,s){const _=n-l(n,i),S=a-l(a,i),y=Math.abs(_-S)-function(k,m,E){let R=0;const B=k-l(k,E),O=m-l(m,E);for(let A=0;A<Math.abs(B-O);A++){const H=g(k,m)==="A"?-1:1,I=E.buffer.lines.get(B+H*A);I!=null&&I.isWrapped&&R++}return R}(n,a,i);return p(y,C(g(n,a),s))}function l(n,a){let i=0,s=a.buffer.lines.get(n),_=s==null?void 0:s.isWrapped;for(;_&&n>=0&&n<a.rows;)i++,s=a.buffer.lines.get(--n),_=s==null?void 0:s.isWrapped;return i}function g(n,a){return n>a?"A":"B"}function v(n,a,i,s,_,S){let y=n,k=a,m="";for(;y!==i||k!==s;)y+=_?1:-1,_&&y>S.cols-1?(m+=S.buffer.translateBufferLineToString(k,!1,n,y),y=0,n=0,k++):!_&&y<0&&(m+=S.buffer.translateBufferLineToString(k,!1,0,n+1),y=S.cols-1,n=y,k--);return m+S.buffer.translateBufferLineToString(k,!1,n,y)}function C(n,a){const i=a?"O":"[";return h.C0.ESC+i+n}function p(n,a){n=Math.floor(n);let i="";for(let s=0;s<n;s++)i+=a;return i}t.moveToCellSequence=function(n,a,i,s){const _=i.buffer.x,S=i.buffer.y;if(!i.buffer.hasScrollback)return function(m,E,R,B,O,A){return f(E,B,O,A).length===0?"":p(v(m,E,m,E-l(E,O),!1,O).length,C("D",A))}(_,S,0,a,i,s)+f(S,a,i,s)+function(m,E,R,B,O,A){let H;H=f(E,B,O,A).length>0?B-l(B,O):E;const I=B,N=function(q,j,x,T,D,M){let F;return F=f(x,T,D,M).length>0?T-l(T,D):j,q<x&&F<=T||q>=x&&F<T?"C":"D"}(m,E,R,B,O,A);return p(v(m,H,R,I,N==="C",O).length,C(N,A))}(_,S,n,a,i,s);let y;if(S===a)return y=_>n?"D":"C",p(Math.abs(_-n),C(y,s));y=S>a?"D":"C";const k=Math.abs(S-a);return p(function(m,E){return E.cols-m}(S>a?n:_,i)+(k-1)*i.cols+1+((S>a?_:n)-1),C(y,s))}},1296:function(w,t,o){var h=this&&this.__decorate||function(A,H,I,N){var q,j=arguments.length,x=j<3?H:N===null?N=Object.getOwnPropertyDescriptor(H,I):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(A,H,I,N);else for(var T=A.length-1;T>=0;T--)(q=A[T])&&(x=(j<3?q(x):j>3?q(H,I,x):q(H,I))||x);return j>3&&x&&Object.defineProperty(H,I,x),x},f=this&&this.__param||function(A,H){return function(I,N){H(I,N,A)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const l=o(3787),g=o(2550),v=o(2223),C=o(6171),p=o(6052),n=o(4725),a=o(8055),i=o(8460),s=o(844),_=o(2585),S="xterm-dom-renderer-owner-",y="xterm-rows",k="xterm-fg-",m="xterm-bg-",E="xterm-focus",R="xterm-selection";let B=1,O=t.DomRenderer=class extends s.Disposable{constructor(A,H,I,N,q,j,x,T,D,M,F,z,G){super(),this._terminal=A,this._document=H,this._element=I,this._screenElement=N,this._viewportElement=q,this._helperContainer=j,this._linkifier2=x,this._charSizeService=D,this._optionsService=M,this._bufferService=F,this._coreBrowserService=z,this._themeService=G,this._terminalClass=B++,this._rowElements=[],this._selectionRenderModel=(0,p.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(y),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(R),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,C.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(X=>this._injectCss(X))),this._injectCss(this._themeService.colors),this._rowFactory=T.createInstance(l.DomRendererRowFactory,document),this._element.classList.add(S+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(X=>this._handleLinkHover(X))),this.register(this._linkifier2.onHideLinkUnderline(X=>this._handleLinkLeave(X))),this.register((0,s.toDisposable)(()=>{this._element.classList.remove(S+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new g.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const A=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*A,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*A),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/A),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/A),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const I of this._rowElements)I.style.width=`${this.dimensions.css.canvas.width}px`,I.style.height=`${this.dimensions.css.cell.height}px`,I.style.lineHeight=`${this.dimensions.css.cell.height}px`,I.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const H=`${this._terminalSelector} .${y} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=H,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(A){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let H=`${this._terminalSelector} .${y} { color: ${A.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;H+=`${this._terminalSelector} .${y} .xterm-dim { color: ${a.color.multiplyOpacity(A.foreground,.5).css};}`,H+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const I=`blink_underline_${this._terminalClass}`,N=`blink_bar_${this._terminalClass}`,q=`blink_block_${this._terminalClass}`;H+=`@keyframes ${I} { 50% {  border-bottom-style: hidden; }}`,H+=`@keyframes ${N} { 50% {  box-shadow: none; }}`,H+=`@keyframes ${q} { 0% {  background-color: ${A.cursor.css};  color: ${A.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${A.cursor.css}; }}`,H+=`${this._terminalSelector} .${y}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${I} 1s step-end infinite;}${this._terminalSelector} .${y}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${N} 1s step-end infinite;}${this._terminalSelector} .${y}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${q} 1s step-end infinite;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-block { background-color: ${A.cursor.css}; color: ${A.cursorAccent.css};}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${A.cursor.css} !important; color: ${A.cursorAccent.css} !important;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${A.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${A.cursor.css} inset;}${this._terminalSelector} .${y} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${A.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,H+=`${this._terminalSelector} .${R} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${R} div { position: absolute; background-color: ${A.selectionBackgroundOpaque.css};}${this._terminalSelector} .${R} div { position: absolute; background-color: ${A.selectionInactiveBackgroundOpaque.css};}`;for(const[j,x]of A.ansi.entries())H+=`${this._terminalSelector} .${k}${j} { color: ${x.css}; }${this._terminalSelector} .${k}${j}.xterm-dim { color: ${a.color.multiplyOpacity(x,.5).css}; }${this._terminalSelector} .${m}${j} { background-color: ${x.css}; }`;H+=`${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR} { color: ${a.color.opaque(A.background).css}; }${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${a.color.multiplyOpacity(a.color.opaque(A.background),.5).css}; }${this._terminalSelector} .${m}${v.INVERTED_DEFAULT_COLOR} { background-color: ${A.foreground.css}; }`,this._themeStyleElement.textContent=H}_setDefaultSpacing(){const A=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${A}px`,this._rowFactory.defaultSpacing=A}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(A,H){for(let I=this._rowElements.length;I<=H;I++){const N=this._document.createElement("div");this._rowContainer.appendChild(N),this._rowElements.push(N)}for(;this._rowElements.length>H;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(A,H){this._refreshRowElements(A,H),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(E),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(E),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(A,H,I){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(A,H,I),this.renderRows(0,this._bufferService.rows-1),!A||!H)return;this._selectionRenderModel.update(this._terminal,A,H,I);const N=this._selectionRenderModel.viewportStartRow,q=this._selectionRenderModel.viewportEndRow,j=this._selectionRenderModel.viewportCappedStartRow,x=this._selectionRenderModel.viewportCappedEndRow;if(j>=this._bufferService.rows||x<0)return;const T=this._document.createDocumentFragment();if(I){const D=A[0]>H[0];T.appendChild(this._createSelectionElement(j,D?H[0]:A[0],D?A[0]:H[0],x-j+1))}else{const D=N===j?A[0]:0,M=j===q?H[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(j,D,M));const F=x-j-1;if(T.appendChild(this._createSelectionElement(j+1,0,this._bufferService.cols,F)),j!==x){const z=q===x?H[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(x,0,z))}}this._selectionContainer.appendChild(T)}_createSelectionElement(A,H,I,N=1){const q=this._document.createElement("div"),j=H*this.dimensions.css.cell.width;let x=this.dimensions.css.cell.width*(I-H);return j+x>this.dimensions.css.canvas.width&&(x=this.dimensions.css.canvas.width-j),q.style.height=N*this.dimensions.css.cell.height+"px",q.style.top=A*this.dimensions.css.cell.height+"px",q.style.left=`${j}px`,q.style.width=`${x}px`,q}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const A of this._rowElements)A.replaceChildren()}renderRows(A,H){const I=this._bufferService.buffer,N=I.ybase+I.y,q=Math.min(I.x,this._bufferService.cols-1),j=this._optionsService.rawOptions.cursorBlink,x=this._optionsService.rawOptions.cursorStyle,T=this._optionsService.rawOptions.cursorInactiveStyle;for(let D=A;D<=H;D++){const M=D+I.ydisp,F=this._rowElements[D],z=I.lines.get(M);if(!F||!z)break;F.replaceChildren(...this._rowFactory.createRow(z,M,M===N,x,T,q,j,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${S}${this._terminalClass}`}_handleLinkHover(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!0)}_handleLinkLeave(A){this._setCellUnderline(A.x1,A.x2,A.y1,A.y2,A.cols,!1)}_setCellUnderline(A,H,I,N,q,j){I<0&&(A=0),N<0&&(H=0);const x=this._bufferService.rows-1;I=Math.max(Math.min(I,x),0),N=Math.max(Math.min(N,x),0),q=Math.min(q,this._bufferService.cols);const T=this._bufferService.buffer,D=T.ybase+T.y,M=Math.min(T.x,q-1),F=this._optionsService.rawOptions.cursorBlink,z=this._optionsService.rawOptions.cursorStyle,G=this._optionsService.rawOptions.cursorInactiveStyle;for(let X=I;X<=N;++X){const P=X+T.ydisp,L=this._rowElements[X],U=T.lines.get(P);if(!L||!U)break;L.replaceChildren(...this._rowFactory.createRow(U,P,P===D,z,G,M,F,this.dimensions.css.cell.width,this._widthCache,j?X===I?A:0:-1,j?(X===N?H:q)-1:-1))}}};t.DomRenderer=O=h([f(7,_.IInstantiationService),f(8,n.ICharSizeService),f(9,_.IOptionsService),f(10,_.IBufferService),f(11,n.ICoreBrowserService),f(12,n.IThemeService)],O)},3787:function(w,t,o){var h=this&&this.__decorate||function(y,k,m,E){var R,B=arguments.length,O=B<3?k:E===null?E=Object.getOwnPropertyDescriptor(k,m):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(y,k,m,E);else for(var A=y.length-1;A>=0;A--)(R=y[A])&&(O=(B<3?R(O):B>3?R(k,m,O):R(k,m))||O);return B>3&&O&&Object.defineProperty(k,m,O),O},f=this&&this.__param||function(y,k){return function(m,E){k(m,E,y)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;const l=o(2223),g=o(643),v=o(511),C=o(2585),p=o(8055),n=o(4725),a=o(4269),i=o(6171),s=o(3734);let _=t.DomRendererRowFactory=class{constructor(y,k,m,E,R,B,O){this._document=y,this._characterJoinerService=k,this._optionsService=m,this._coreBrowserService=E,this._coreService=R,this._decorationService=B,this._themeService=O,this._workCell=new v.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(y,k,m){this._selectionStart=y,this._selectionEnd=k,this._columnSelectMode=m}createRow(y,k,m,E,R,B,O,A,H,I,N){const q=[],j=this._characterJoinerService.getJoinedCharacters(k),x=this._themeService.colors;let T,D=y.getNoBgTrimmedLength();m&&D<B+1&&(D=B+1);let M=0,F="",z=0,G=0,X=0,P=!1,L=0,U=!1,$=0;const V=[],K=I!==-1&&N!==-1;for(let Y=0;Y<D;Y++){y.loadCell(Y,this._workCell);let ne=this._workCell.getWidth();if(ne===0)continue;let oe=!1,he=Y,J=this._workCell;if(j.length>0&&Y===j[0][0]){oe=!0;const re=j.shift();J=new a.JoinedCellData(this._workCell,y.translateToString(!0,re[0],re[1]),re[1]-re[0]),he=re[1]-1,ne=J.getWidth()}const Ie=this._isCellInSelection(Y,k),Lt=m&&Y===B,Rt=K&&Y>=I&&Y<=N;let Dt=!1;this._decorationService.forEachDecorationAtCell(Y,k,void 0,re=>{Dt=!0});let st=J.getChars()||g.WHITESPACE_CELL_CHAR;if(st===" "&&(J.isUnderline()||J.isOverline())&&(st=" "),$=ne*A-H.get(st,J.isBold(),J.isItalic()),T){if(M&&(Ie&&U||!Ie&&!U&&J.bg===z)&&(Ie&&U&&x.selectionForeground||J.fg===G)&&J.extended.ext===X&&Rt===P&&$===L&&!Lt&&!oe&&!Dt){J.isInvisible()?F+=g.WHITESPACE_CELL_CHAR:F+=st,M++;continue}M&&(T.textContent=F),T=this._document.createElement("span"),M=0,F=""}else T=this._document.createElement("span");if(z=J.bg,G=J.fg,X=J.extended.ext,P=Rt,L=$,U=Ie,oe&&B>=Y&&B<=he&&(B=Y),!this._coreService.isCursorHidden&&Lt&&this._coreService.isCursorInitialized){if(V.push("xterm-cursor"),this._coreBrowserService.isFocused)O&&V.push("xterm-cursor-blink"),V.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(R)switch(R){case"outline":V.push("xterm-cursor-outline");break;case"block":V.push("xterm-cursor-block");break;case"bar":V.push("xterm-cursor-bar");break;case"underline":V.push("xterm-cursor-underline")}}if(J.isBold()&&V.push("xterm-bold"),J.isItalic()&&V.push("xterm-italic"),J.isDim()&&V.push("xterm-dim"),F=J.isInvisible()?g.WHITESPACE_CELL_CHAR:J.getChars()||g.WHITESPACE_CELL_CHAR,J.isUnderline()&&(V.push(`xterm-underline-${J.extended.underlineStyle}`),F===" "&&(F=" "),!J.isUnderlineColorDefault()))if(J.isUnderlineColorRGB())T.style.textDecorationColor=`rgb(${s.AttributeData.toColorRGB(J.getUnderlineColor()).join(",")})`;else{let re=J.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&J.isBold()&&re<8&&(re+=8),T.style.textDecorationColor=x.ansi[re].css}J.isOverline()&&(V.push("xterm-overline"),F===" "&&(F=" ")),J.isStrikethrough()&&V.push("xterm-strikethrough"),Rt&&(T.style.textDecoration="underline");let _e=J.getFgColor(),He=J.getFgColorMode(),fe=J.getBgColor(),$e=J.getBgColorMode();const At=!!J.isInverse();if(At){const re=_e;_e=fe,fe=re;const Or=He;He=$e,$e=Or}let Ce,nt,ke,Fe=!1;switch(this._decorationService.forEachDecorationAtCell(Y,k,void 0,re=>{re.options.layer!=="top"&&Fe||(re.backgroundColorRGB&&($e=50331648,fe=re.backgroundColorRGB.rgba>>8&16777215,Ce=re.backgroundColorRGB),re.foregroundColorRGB&&(He=50331648,_e=re.foregroundColorRGB.rgba>>8&16777215,nt=re.foregroundColorRGB),Fe=re.options.layer==="top")}),!Fe&&Ie&&(Ce=this._coreBrowserService.isFocused?x.selectionBackgroundOpaque:x.selectionInactiveBackgroundOpaque,fe=Ce.rgba>>8&16777215,$e=50331648,Fe=!0,x.selectionForeground&&(He=50331648,_e=x.selectionForeground.rgba>>8&16777215,nt=x.selectionForeground)),Fe&&V.push("xterm-decoration-top"),$e){case 16777216:case 33554432:ke=x.ansi[fe],V.push(`xterm-bg-${fe}`);break;case 50331648:ke=p.channels.toColor(fe>>16,fe>>8&255,255&fe),this._addStyle(T,`background-color:#${S((fe>>>0).toString(16),"0",6)}`);break;default:At?(ke=x.foreground,V.push(`xterm-bg-${l.INVERTED_DEFAULT_COLOR}`)):ke=x.background}switch(Ce||J.isDim()&&(Ce=p.color.multiplyOpacity(ke,.5)),He){case 16777216:case 33554432:J.isBold()&&_e<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(_e+=8),this._applyMinimumContrast(T,ke,x.ansi[_e],J,Ce,void 0)||V.push(`xterm-fg-${_e}`);break;case 50331648:const re=p.channels.toColor(_e>>16&255,_e>>8&255,255&_e);this._applyMinimumContrast(T,ke,re,J,Ce,nt)||this._addStyle(T,`color:#${S(_e.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(T,ke,x.foreground,J,Ce,nt)||At&&V.push(`xterm-fg-${l.INVERTED_DEFAULT_COLOR}`)}V.length&&(T.className=V.join(" "),V.length=0),Lt||oe||Dt?T.textContent=F:M++,$!==this.defaultSpacing&&(T.style.letterSpacing=`${$}px`),q.push(T),Y=he}return T&&M&&(T.textContent=F),q}_applyMinimumContrast(y,k,m,E,R,B){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,i.treatGlyphAsBackgroundColor)(E.getCode()))return!1;const O=this._getContrastCache(E);let A;if(R||B||(A=O.getColor(k.rgba,m.rgba)),A===void 0){const H=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);A=p.color.ensureContrastRatio(R||k,B||m,H),O.setColor((R||k).rgba,(B||m).rgba,A??null)}return!!A&&(this._addStyle(y,`color:${A.css}`),!0)}_getContrastCache(y){return y.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(y,k){y.setAttribute("style",`${y.getAttribute("style")||""}${k};`)}_isCellInSelection(y,k){const m=this._selectionStart,E=this._selectionEnd;return!(!m||!E)&&(this._columnSelectMode?m[0]<=E[0]?y>=m[0]&&k>=m[1]&&y<E[0]&&k<=E[1]:y<m[0]&&k>=m[1]&&y>=E[0]&&k<=E[1]:k>m[1]&&k<E[1]||m[1]===E[1]&&k===m[1]&&y>=m[0]&&y<E[0]||m[1]<E[1]&&k===E[1]&&y<E[0]||m[1]<E[1]&&k===m[1]&&y>=m[0])}};function S(y,k,m){for(;y.length<m;)y=k+y;return y}t.DomRendererRowFactory=_=h([f(1,n.ICharacterJoinerService),f(2,C.IOptionsService),f(3,n.ICoreBrowserService),f(4,C.ICoreService),f(5,C.IDecorationService),f(6,n.IThemeService)],_)},2550:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=class{constructor(o,h){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=o.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const f=o.createElement("span");f.classList.add("xterm-char-measure-element");const l=o.createElement("span");l.classList.add("xterm-char-measure-element"),l.style.fontWeight="bold";const g=o.createElement("span");g.classList.add("xterm-char-measure-element"),g.style.fontStyle="italic";const v=o.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontWeight="bold",v.style.fontStyle="italic",this._measureElements=[f,l,g,v],this._container.appendChild(f),this._container.appendChild(l),this._container.appendChild(g),this._container.appendChild(v),h.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(o,h,f,l){o===this._font&&h===this._fontSize&&f===this._weight&&l===this._weightBold||(this._font=o,this._fontSize=h,this._weight=f,this._weightBold=l,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${f}`,this._measureElements[1].style.fontWeight=`${l}`,this._measureElements[2].style.fontWeight=`${f}`,this._measureElements[3].style.fontWeight=`${l}`,this.clear())}get(o,h,f){let l=0;if(!h&&!f&&o.length===1&&(l=o.charCodeAt(0))<256){if(this._flat[l]!==-9999)return this._flat[l];const C=this._measure(o,0);return C>0&&(this._flat[l]=C),C}let g=o;h&&(g+="B"),f&&(g+="I");let v=this._holey.get(g);if(v===void 0){let C=0;h&&(C|=1),f&&(C|=2),v=this._measure(o,C),v>0&&this._holey.set(g,v)}return v}_measure(o,h){const f=this._measureElements[h];return f.textContent=o.repeat(32),f.offsetWidth/32}}},2223:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const h=o(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(w,t)=>{function o(f){return 57508<=f&&f<=57558}function h(f){return f>=128512&&f<=128591||f>=127744&&f<=128511||f>=128640&&f<=128767||f>=9728&&f<=9983||f>=9984&&f<=10175||f>=65024&&f<=65039||f>=129280&&f<=129535||f>=127462&&f<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},t.isPowerlineGlyph=o,t.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},t.isEmoji=h,t.allowRescaling=function(f,l,g,v){return l===1&&g>Math.ceil(1.5*v)&&f!==void 0&&f>255&&!h(f)&&!o(f)&&!function(C){return 57344<=C&&C<=63743}(f)},t.treatGlyphAsBackgroundColor=function(f){return o(f)||function(l){return 9472<=l&&l<=9631}(f)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(f,l,g=0){return(f-(2*Math.round(l)-g))%(2*Math.round(l))}},6052:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class o{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,l,g,v=!1){if(this.selectionStart=l,this.selectionEnd=g,!l||!g||l[0]===g[0]&&l[1]===g[1])return void this.clear();const C=f.buffers.active.ydisp,p=l[1]-C,n=g[1]-C,a=Math.max(p,0),i=Math.min(n,f.rows-1);a>=f.rows||i<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=v,this.viewportStartRow=p,this.viewportEndRow=n,this.viewportCappedStartRow=a,this.viewportCappedEndRow=i,this.startCol=l[0],this.endCol=g[0])}isCellSelected(f,l,g){return!!this.hasSelection&&(g-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?l>=this.startCol&&g>=this.viewportCappedStartRow&&l<this.endCol&&g<=this.viewportCappedEndRow:l<this.startCol&&g>=this.viewportCappedStartRow&&l>=this.endCol&&g<=this.viewportCappedEndRow:g>this.viewportStartRow&&g<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&g===this.viewportStartRow&&l>=this.startCol&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&g===this.viewportEndRow&&l<this.endCol||this.viewportStartRow<this.viewportEndRow&&g===this.viewportStartRow&&l>=this.startCol)}}t.createSelectionRenderModel=function(){return new o}},456:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(o){this._bufferService=o,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?o%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)-1]:[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[o,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const o=this.selectionStart[0]+this.selectionStartLength;return o>this._bufferService.cols?[o%this._bufferService.cols,this.selectionStart[1]+Math.floor(o/this._bufferService.cols)]:[Math.max(o,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const o=this.selectionStart,h=this.selectionEnd;return!(!o||!h)&&(o[1]>h[1]||o[1]===h[1]&&o[0]>h[0])}handleTrim(o){return this.selectionStart&&(this.selectionStart[1]-=o),this.selectionEnd&&(this.selectionEnd[1]-=o),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(w,t,o){var h=this&&this.__decorate||function(i,s,_,S){var y,k=arguments.length,m=k<3?s:S===null?S=Object.getOwnPropertyDescriptor(s,_):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(i,s,_,S);else for(var E=i.length-1;E>=0;E--)(y=i[E])&&(m=(k<3?y(m):k>3?y(s,_,m):y(s,_))||m);return k>3&&m&&Object.defineProperty(s,_,m),m},f=this&&this.__param||function(i,s){return function(_,S){s(_,S,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const l=o(2585),g=o(8460),v=o(844);let C=t.CharSizeService=class extends v.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(i,s,_){super(),this._optionsService=_,this.width=0,this.height=0,this._onCharSizeChange=this.register(new g.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new a(this._optionsService))}catch{this._measureStrategy=this.register(new n(i,s,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};t.CharSizeService=C=h([f(2,l.IOptionsService)],C);class p extends v.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(s,_){s!==void 0&&s>0&&_!==void 0&&_>0&&(this._result.width=s,this._result.height=_)}}class n extends p{constructor(s,_,S){super(),this._document=s,this._parentElement=_,this._optionsService=S,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class a extends p{constructor(s){super(),this._optionsService=s,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const _=this._ctx.measureText("W");if(!("width"in _&&"fontBoundingBoxAscent"in _&&"fontBoundingBoxDescent"in _))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const s=this._ctx.measureText("W");return this._validateAndSet(s.width,s.fontBoundingBoxAscent+s.fontBoundingBoxDescent),this._result}}},4269:function(w,t,o){var h=this&&this.__decorate||function(a,i,s,_){var S,y=arguments.length,k=y<3?i:_===null?_=Object.getOwnPropertyDescriptor(i,s):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(a,i,s,_);else for(var m=a.length-1;m>=0;m--)(S=a[m])&&(k=(y<3?S(k):y>3?S(i,s,k):S(i,s))||k);return y>3&&k&&Object.defineProperty(i,s,k),k},f=this&&this.__param||function(a,i){return function(s,_){i(s,_,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const l=o(3734),g=o(643),v=o(511),C=o(2585);class p extends l.AttributeData{constructor(i,s,_){super(),this.content=0,this.combinedData="",this.fg=i.fg,this.bg=i.bg,this.combinedData=s,this._width=_}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(i){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=p;let n=t.CharacterJoinerService=class Ar{constructor(i){this._bufferService=i,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new v.CellData}register(i){const s={id:this._nextCharacterJoinerId++,handler:i};return this._characterJoiners.push(s),s.id}deregister(i){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===i)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(i){if(this._characterJoiners.length===0)return[];const s=this._bufferService.buffer.lines.get(i);if(!s||s.length===0)return[];const _=[],S=s.translateToString(!0);let y=0,k=0,m=0,E=s.getFg(0),R=s.getBg(0);for(let B=0;B<s.getTrimmedLength();B++)if(s.loadCell(B,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==R){if(B-y>1){const O=this._getJoinedRanges(S,m,k,s,y);for(let A=0;A<O.length;A++)_.push(O[A])}y=B,m=k,E=this._workCell.fg,R=this._workCell.bg}k+=this._workCell.getChars().length||g.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-y>1){const B=this._getJoinedRanges(S,m,k,s,y);for(let O=0;O<B.length;O++)_.push(B[O])}return _}_getJoinedRanges(i,s,_,S,y){const k=i.substring(s,_);let m=[];try{m=this._characterJoiners[0].handler(k)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const R=this._characterJoiners[E].handler(k);for(let B=0;B<R.length;B++)Ar._mergeRanges(m,R[B])}catch(R){console.error(R)}return this._stringRangesToCellRanges(m,S,y),m}_stringRangesToCellRanges(i,s,_){let S=0,y=!1,k=0,m=i[S];if(m){for(let E=_;E<this._bufferService.cols;E++){const R=s.getWidth(E),B=s.getString(E).length||g.WHITESPACE_CELL_CHAR.length;if(R!==0){if(!y&&m[0]<=k&&(m[0]=E,y=!0),m[1]<=k){if(m[1]=E,m=i[++S],!m)break;m[0]<=k?(m[0]=E,y=!0):y=!1}k+=B}}m&&(m[1]=this._bufferService.cols)}}static _mergeRanges(i,s){let _=!1;for(let S=0;S<i.length;S++){const y=i[S];if(_){if(s[1]<=y[0])return i[S-1][1]=s[1],i;if(s[1]<=y[1])return i[S-1][1]=Math.max(s[1],y[1]),i.splice(S,1),i;i.splice(S,1),S--}else{if(s[1]<=y[0])return i.splice(S,0,s),i;if(s[1]<=y[1])return y[0]=Math.min(s[0],y[0]),i;s[0]<y[1]&&(y[0]=Math.min(s[0],y[0]),_=!0)}}return _?i[i.length-1][1]=s[1]:i.push(s),i}};t.CharacterJoinerService=n=h([f(0,C.IBufferService)],n)},5114:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;const h=o(844),f=o(8460),l=o(3656);class g extends h.Disposable{constructor(p,n,a){super(),this._textarea=p,this._window=n,this.mainDocument=a,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new v(this._window),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new f.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(i=>this._screenDprMonitor.setWindow(i))),this.register((0,f.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(p){this._window!==p&&(this._window=p,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}t.CoreBrowserService=g;class v extends h.Disposable{constructor(p){super(),this._parentWindow=p,this._windowResizeListener=this.register(new h.MutableDisposable),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,h.toDisposable)(()=>this.clearListener()))}setWindow(p){this._parentWindow=p,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,l.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var p;this._outerListener&&((p=this._resolutionMediaMatchList)==null||p.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;const h=o(844);class f extends h.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,h.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(g){return this.linkProviders.push(g),{dispose:()=>{const v=this.linkProviders.indexOf(g);v!==-1&&this.linkProviders.splice(v,1)}}}}t.LinkProviderService=f},8934:function(w,t,o){var h=this&&this.__decorate||function(C,p,n,a){var i,s=arguments.length,_=s<3?p:a===null?a=Object.getOwnPropertyDescriptor(p,n):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(C,p,n,a);else for(var S=C.length-1;S>=0;S--)(i=C[S])&&(_=(s<3?i(_):s>3?i(p,n,_):i(p,n))||_);return s>3&&_&&Object.defineProperty(p,n,_),_},f=this&&this.__param||function(C,p){return function(n,a){p(n,a,C)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const l=o(4725),g=o(9806);let v=t.MouseService=class{constructor(C,p){this._renderService=C,this._charSizeService=p}getCoords(C,p,n,a,i){return(0,g.getCoords)(window,C,p,n,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,i)}getMouseReportCoords(C,p){const n=(0,g.getCoordsRelativeToElement)(window,C,p);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};t.MouseService=v=h([f(0,l.IRenderService),f(1,l.ICharSizeService)],v)},3230:function(w,t,o){var h=this&&this.__decorate||function(i,s,_,S){var y,k=arguments.length,m=k<3?s:S===null?S=Object.getOwnPropertyDescriptor(s,_):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(i,s,_,S);else for(var E=i.length-1;E>=0;E--)(y=i[E])&&(m=(k<3?y(m):k>3?y(s,_,m):y(s,_))||m);return k>3&&m&&Object.defineProperty(s,_,m),m},f=this&&this.__param||function(i,s){return function(_,S){s(_,S,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const l=o(6193),g=o(4725),v=o(8460),C=o(844),p=o(7226),n=o(2585);let a=t.RenderService=class extends C.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(i,s,_,S,y,k,m,E){super(),this._rowCount=i,this._charSizeService=S,this._renderer=this.register(new C.MutableDisposable),this._pausedResizeTask=new p.DebouncedIdleTask,this._observerDisposable=this.register(new C.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new v.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new v.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new v.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new v.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new l.RenderDebouncer((R,B)=>this._renderRows(R,B),m),this.register(this._renderDebouncer),this.register(m.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var R;return(R=this._renderer.value)==null?void 0:R.clear()})),this.register(_.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(y.onDecorationRegistered(()=>this._fullRefresh())),this.register(y.onDecorationRemoved(()=>this._fullRefresh())),this.register(_.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(_.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,!0))),this.register(E.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(m.window,s),this.register(m.onWindowChange(R=>this._registerIntersectionObserver(R,s)))}_registerIntersectionObserver(i,s){if("IntersectionObserver"in i){const _=new i.IntersectionObserver(S=>this._handleIntersectionChange(S[S.length-1]),{threshold:0});_.observe(s),this._observerDisposable.value=(0,C.toDisposable)(()=>_.disconnect())}}_handleIntersectionChange(i){this._isPaused=i.isIntersecting===void 0?i.intersectionRatio===0:!i.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(i,s,_=!1){this._isPaused?this._needsFullRefresh=!0:(_||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(i,s,this._rowCount))}_renderRows(i,s){this._renderer.value&&(i=Math.min(i,this._rowCount-1),s=Math.min(s,this._rowCount-1),this._renderer.value.renderRows(i,s),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:i,end:s}),this._onRender.fire({start:i,end:s}),this._isNextRenderRedrawOnly=!0)}resize(i,s){this._rowCount=s,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(i){this._renderer.value=i,this._renderer.value&&(this._renderer.value.onRequestRedraw(s=>this.refreshRows(s.start,s.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(i){return this._renderDebouncer.addRefreshCallback(i)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var i,s;this._renderer.value&&((s=(i=this._renderer.value).clearTextureAtlas)==null||s.call(i),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(i,s){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var _;return(_=this._renderer.value)==null?void 0:_.handleResize(i,s)}):this._renderer.value.handleResize(i,s),this._fullRefresh())}handleCharSizeChanged(){var i;(i=this._renderer.value)==null||i.handleCharSizeChanged()}handleBlur(){var i;(i=this._renderer.value)==null||i.handleBlur()}handleFocus(){var i;(i=this._renderer.value)==null||i.handleFocus()}handleSelectionChanged(i,s,_){var S;this._selectionState.start=i,this._selectionState.end=s,this._selectionState.columnSelectMode=_,(S=this._renderer.value)==null||S.handleSelectionChanged(i,s,_)}handleCursorMove(){var i;(i=this._renderer.value)==null||i.handleCursorMove()}clear(){var i;(i=this._renderer.value)==null||i.clear()}};t.RenderService=a=h([f(2,n.IOptionsService),f(3,g.ICharSizeService),f(4,n.IDecorationService),f(5,n.IBufferService),f(6,g.ICoreBrowserService),f(7,g.IThemeService)],a)},9312:function(w,t,o){var h=this&&this.__decorate||function(m,E,R,B){var O,A=arguments.length,H=A<3?E:B===null?B=Object.getOwnPropertyDescriptor(E,R):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(m,E,R,B);else for(var I=m.length-1;I>=0;I--)(O=m[I])&&(H=(A<3?O(H):A>3?O(E,R,H):O(E,R))||H);return A>3&&H&&Object.defineProperty(E,R,H),H},f=this&&this.__param||function(m,E){return function(R,B){E(R,B,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const l=o(9806),g=o(9504),v=o(456),C=o(4725),p=o(8460),n=o(844),a=o(6114),i=o(4841),s=o(511),_=o(2585),S=" ",y=new RegExp(S,"g");let k=t.SelectionService=class extends n.Disposable{constructor(m,E,R,B,O,A,H,I,N){super(),this._element=m,this._screenElement=E,this._linkifier=R,this._bufferService=B,this._coreService=O,this._mouseService=A,this._optionsService=H,this._renderService=I,this._coreBrowserService=N,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new s.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new p.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new p.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new p.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=q=>this._handleMouseMove(q),this._mouseUpListener=q=>this._handleMouseUp(q),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(q=>this._handleTrim(q)),this.register(this._bufferService.buffers.onBufferActivate(q=>this._handleBufferActivate(q))),this.enable(),this._model=new v.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const m=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!m||!E||m[0]===E[0]&&m[1]===E[1])}get selectionText(){const m=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!m||!E)return"";const R=this._bufferService.buffer,B=[];if(this._activeSelectionMode===3){if(m[0]===E[0])return"";const O=m[0]<E[0]?m[0]:E[0],A=m[0]<E[0]?E[0]:m[0];for(let H=m[1];H<=E[1];H++){const I=R.translateBufferLineToString(H,!0,O,A);B.push(I)}}else{const O=m[1]===E[1]?E[0]:void 0;B.push(R.translateBufferLineToString(m[1],!0,m[0],O));for(let A=m[1]+1;A<=E[1]-1;A++){const H=R.lines.get(A),I=R.translateBufferLineToString(A,!0);H!=null&&H.isWrapped?B[B.length-1]+=I:B.push(I)}if(m[1]!==E[1]){const A=R.lines.get(E[1]),H=R.translateBufferLineToString(E[1],!0,0,E[0]);A&&A.isWrapped?B[B.length-1]+=H:B.push(H)}}return B.map(O=>O.replace(y," ")).join(a.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(m){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),a.isLinux&&m&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(m){const E=this._getMouseBufferCoords(m),R=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!!(R&&B&&E)&&this._areCoordsInSelection(E,R,B)}isCellInSelection(m,E){const R=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!(!R||!B)&&this._areCoordsInSelection([m,E],R,B)}_areCoordsInSelection(m,E,R){return m[1]>E[1]&&m[1]<R[1]||E[1]===R[1]&&m[1]===E[1]&&m[0]>=E[0]&&m[0]<R[0]||E[1]<R[1]&&m[1]===R[1]&&m[0]<R[0]||E[1]<R[1]&&m[1]===E[1]&&m[0]>=E[0]}_selectWordAtCursor(m,E){var O,A;const R=(A=(O=this._linkifier.currentLink)==null?void 0:O.link)==null?void 0:A.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,i.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(m);return!!B&&(this._selectWordAt(B,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(m,E){this._model.clearSelection(),m=Math.max(m,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,m],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(m){this._model.handleTrim(m)&&this.refresh()}_getMouseBufferCoords(m){const E=this._mouseService.getCoords(m,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(m){let E=(0,l.getCoordsRelativeToElement)(this._coreBrowserService.window,m,this._screenElement)[1];const R=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=R?0:(E>R&&(E-=R),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(m){return a.isMac?m.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:m.shiftKey}handleMouseDown(m){if(this._mouseDownTimeStamp=m.timeStamp,(m.button!==2||!this.hasSelection)&&m.button===0){if(!this._enabled){if(!this.shouldForceSelection(m))return;m.stopPropagation()}m.preventDefault(),this._dragScrollAmount=0,this._enabled&&m.shiftKey?this._handleIncrementalClick(m):m.detail===1?this._handleSingleClick(m):m.detail===2?this._handleDoubleClick(m):m.detail===3&&this._handleTripleClick(m),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(m){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(m))}_handleSingleClick(m){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(m)?3:0,this._model.selectionStart=this._getMouseBufferCoords(m),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(m){this._selectWordAtCursor(m,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(m){const E=this._getMouseBufferCoords(m);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(m){return m.altKey&&!(a.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(m){if(m.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(m),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(m),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const R=this._bufferService.buffer;if(this._model.selectionEnd[1]<R.lines.length){const B=R.lines.get(this._model.selectionEnd[1]);B&&B.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const m=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(m.ydisp+this._bufferService.rows,m.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=m.ydisp),this.refresh()}}_handleMouseUp(m){const E=m.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&m.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const R=this._mouseService.getCoords(m,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(R&&R[0]!==void 0&&R[1]!==void 0){const B=(0,g.moveToCellSequence)(R[0]-1,R[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(B,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const m=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,R=!(!m||!E||m[0]===E[0]&&m[1]===E[1]);R?m&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&m[0]===this._oldSelectionStart[0]&&m[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(m,E,R)):this._oldHasSelection&&this._fireOnSelectionChange(m,E,R)}_fireOnSelectionChange(m,E,R){this._oldSelectionStart=m,this._oldSelectionEnd=E,this._oldHasSelection=R,this._onSelectionChange.fire()}_handleBufferActivate(m){this.clearSelection(),this._trimListener.dispose(),this._trimListener=m.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(m,E){let R=E;for(let B=0;E>=B;B++){const O=m.loadCell(B,this._workCell).getChars().length;this._workCell.getWidth()===0?R--:O>1&&E!==B&&(R+=O-1)}return R}setSelection(m,E,R){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[m,E],this._model.selectionStartLength=R,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(m){this._isClickInSelection(m)||(this._selectWordAtCursor(m,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(m,E,R=!0,B=!0){if(m[0]>=this._bufferService.cols)return;const O=this._bufferService.buffer,A=O.lines.get(m[1]);if(!A)return;const H=O.translateBufferLineToString(m[1],!1);let I=this._convertViewportColToCharacterIndex(A,m[0]),N=I;const q=m[0]-I;let j=0,x=0,T=0,D=0;if(H.charAt(I)===" "){for(;I>0&&H.charAt(I-1)===" ";)I--;for(;N<H.length&&H.charAt(N+1)===" ";)N++}else{let z=m[0],G=m[0];A.getWidth(z)===0&&(j++,z--),A.getWidth(G)===2&&(x++,G++);const X=A.getString(G).length;for(X>1&&(D+=X-1,N+=X-1);z>0&&I>0&&!this._isCharWordSeparator(A.loadCell(z-1,this._workCell));){A.loadCell(z-1,this._workCell);const P=this._workCell.getChars().length;this._workCell.getWidth()===0?(j++,z--):P>1&&(T+=P-1,I-=P-1),I--,z--}for(;G<A.length&&N+1<H.length&&!this._isCharWordSeparator(A.loadCell(G+1,this._workCell));){A.loadCell(G+1,this._workCell);const P=this._workCell.getChars().length;this._workCell.getWidth()===2?(x++,G++):P>1&&(D+=P-1,N+=P-1),N++,G++}}N++;let M=I+q-j+T,F=Math.min(this._bufferService.cols,N-I+j+x-T-D);if(E||H.slice(I,N).trim()!==""){if(R&&M===0&&A.getCodePoint(0)!==32){const z=O.lines.get(m[1]-1);if(z&&A.isWrapped&&z.getCodePoint(this._bufferService.cols-1)!==32){const G=this._getWordAt([this._bufferService.cols-1,m[1]-1],!1,!0,!1);if(G){const X=this._bufferService.cols-G.start;M-=X,F+=X}}}if(B&&M+F===this._bufferService.cols&&A.getCodePoint(this._bufferService.cols-1)!==32){const z=O.lines.get(m[1]+1);if(z!=null&&z.isWrapped&&z.getCodePoint(0)!==32){const G=this._getWordAt([0,m[1]+1],!1,!1,!0);G&&(F+=G.length)}}return{start:M,length:F}}}_selectWordAt(m,E){const R=this._getWordAt(m,E);if(R){for(;R.start<0;)R.start+=this._bufferService.cols,m[1]--;this._model.selectionStart=[R.start,m[1]],this._model.selectionStartLength=R.length}}_selectToWordAt(m){const E=this._getWordAt(m,!0);if(E){let R=m[1];for(;E.start<0;)E.start+=this._bufferService.cols,R--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,R++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,R]}}_isCharWordSeparator(m){return m.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(m.getChars())>=0}_selectLineAt(m){const E=this._bufferService.buffer.getWrappedRangeForLine(m),R={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,i.getRangeLength)(R,this._bufferService.cols)}};t.SelectionService=k=h([f(3,_.IBufferService),f(4,_.ICoreService),f(5,C.IMouseService),f(6,_.IOptionsService),f(7,C.IRenderService),f(8,C.ICoreBrowserService)],k)},4725:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const h=o(8343);t.ICharSizeService=(0,h.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),t.IMouseService=(0,h.createDecorator)("MouseService"),t.IRenderService=(0,h.createDecorator)("RenderService"),t.ISelectionService=(0,h.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,h.createDecorator)("ThemeService"),t.ILinkProviderService=(0,h.createDecorator)("LinkProviderService")},6731:function(w,t,o){var h=this&&this.__decorate||function(k,m,E,R){var B,O=arguments.length,A=O<3?m:R===null?R=Object.getOwnPropertyDescriptor(m,E):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(k,m,E,R);else for(var H=k.length-1;H>=0;H--)(B=k[H])&&(A=(O<3?B(A):O>3?B(m,E,A):B(m,E))||A);return O>3&&A&&Object.defineProperty(m,E,A),A},f=this&&this.__param||function(k,m){return function(E,R){m(E,R,k)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const l=o(7239),g=o(8055),v=o(8460),C=o(844),p=o(2585),n=g.css.toColor("#ffffff"),a=g.css.toColor("#000000"),i=g.css.toColor("#ffffff"),s=g.css.toColor("#000000"),_={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const k=[g.css.toColor("#2e3436"),g.css.toColor("#cc0000"),g.css.toColor("#4e9a06"),g.css.toColor("#c4a000"),g.css.toColor("#3465a4"),g.css.toColor("#75507b"),g.css.toColor("#06989a"),g.css.toColor("#d3d7cf"),g.css.toColor("#555753"),g.css.toColor("#ef2929"),g.css.toColor("#8ae234"),g.css.toColor("#fce94f"),g.css.toColor("#729fcf"),g.css.toColor("#ad7fa8"),g.css.toColor("#34e2e2"),g.css.toColor("#eeeeec")],m=[0,95,135,175,215,255];for(let E=0;E<216;E++){const R=m[E/36%6|0],B=m[E/6%6|0],O=m[E%6];k.push({css:g.channels.toCss(R,B,O),rgba:g.channels.toRgba(R,B,O)})}for(let E=0;E<24;E++){const R=8+10*E;k.push({css:g.channels.toCss(R,R,R),rgba:g.channels.toRgba(R,R,R)})}return k})());let S=t.ThemeService=class extends C.Disposable{get colors(){return this._colors}constructor(k){super(),this._optionsService=k,this._contrastCache=new l.ColorContrastCache,this._halfContrastCache=new l.ColorContrastCache,this._onChangeColors=this.register(new v.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:a,cursor:i,cursorAccent:s,selectionForeground:void 0,selectionBackgroundTransparent:_,selectionBackgroundOpaque:g.color.blend(a,_),selectionInactiveBackgroundTransparent:_,selectionInactiveBackgroundOpaque:g.color.blend(a,_),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(k={}){const m=this._colors;if(m.foreground=y(k.foreground,n),m.background=y(k.background,a),m.cursor=y(k.cursor,i),m.cursorAccent=y(k.cursorAccent,s),m.selectionBackgroundTransparent=y(k.selectionBackground,_),m.selectionBackgroundOpaque=g.color.blend(m.background,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundTransparent=y(k.selectionInactiveBackground,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundOpaque=g.color.blend(m.background,m.selectionInactiveBackgroundTransparent),m.selectionForeground=k.selectionForeground?y(k.selectionForeground,g.NULL_COLOR):void 0,m.selectionForeground===g.NULL_COLOR&&(m.selectionForeground=void 0),g.color.isOpaque(m.selectionBackgroundTransparent)&&(m.selectionBackgroundTransparent=g.color.opacity(m.selectionBackgroundTransparent,.3)),g.color.isOpaque(m.selectionInactiveBackgroundTransparent)&&(m.selectionInactiveBackgroundTransparent=g.color.opacity(m.selectionInactiveBackgroundTransparent,.3)),m.ansi=t.DEFAULT_ANSI_COLORS.slice(),m.ansi[0]=y(k.black,t.DEFAULT_ANSI_COLORS[0]),m.ansi[1]=y(k.red,t.DEFAULT_ANSI_COLORS[1]),m.ansi[2]=y(k.green,t.DEFAULT_ANSI_COLORS[2]),m.ansi[3]=y(k.yellow,t.DEFAULT_ANSI_COLORS[3]),m.ansi[4]=y(k.blue,t.DEFAULT_ANSI_COLORS[4]),m.ansi[5]=y(k.magenta,t.DEFAULT_ANSI_COLORS[5]),m.ansi[6]=y(k.cyan,t.DEFAULT_ANSI_COLORS[6]),m.ansi[7]=y(k.white,t.DEFAULT_ANSI_COLORS[7]),m.ansi[8]=y(k.brightBlack,t.DEFAULT_ANSI_COLORS[8]),m.ansi[9]=y(k.brightRed,t.DEFAULT_ANSI_COLORS[9]),m.ansi[10]=y(k.brightGreen,t.DEFAULT_ANSI_COLORS[10]),m.ansi[11]=y(k.brightYellow,t.DEFAULT_ANSI_COLORS[11]),m.ansi[12]=y(k.brightBlue,t.DEFAULT_ANSI_COLORS[12]),m.ansi[13]=y(k.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),m.ansi[14]=y(k.brightCyan,t.DEFAULT_ANSI_COLORS[14]),m.ansi[15]=y(k.brightWhite,t.DEFAULT_ANSI_COLORS[15]),k.extendedAnsi){const E=Math.min(m.ansi.length-16,k.extendedAnsi.length);for(let R=0;R<E;R++)m.ansi[R+16]=y(k.extendedAnsi[R],t.DEFAULT_ANSI_COLORS[R+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(k){this._restoreColor(k),this._onChangeColors.fire(this.colors)}_restoreColor(k){if(k!==void 0)switch(k){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[k]=this._restoreColors.ansi[k]}else for(let m=0;m<this._restoreColors.ansi.length;++m)this._colors.ansi[m]=this._restoreColors.ansi[m]}modifyColors(k){k(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function y(k,m){if(k!==void 0)try{return g.css.toColor(k)}catch{}return m}t.ThemeService=S=h([f(0,p.IOptionsService)],S)},6349:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const h=o(8460),f=o(844);class l extends f.Disposable{constructor(v){super(),this._maxLength=v,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(v){if(this._maxLength===v)return;const C=new Array(v);for(let p=0;p<Math.min(v,this.length);p++)C[p]=this._array[this._getCyclicIndex(p)];this._array=C,this._maxLength=v,this._startIndex=0}get length(){return this._length}set length(v){if(v>this._length)for(let C=this._length;C<v;C++)this._array[C]=void 0;this._length=v}get(v){return this._array[this._getCyclicIndex(v)]}set(v,C){this._array[this._getCyclicIndex(v)]=C}push(v){this._array[this._getCyclicIndex(this._length)]=v,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(v,C,...p){if(C){for(let n=v;n<this._length-C;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+C)];this._length-=C,this.onDeleteEmitter.fire({index:v,amount:C})}for(let n=this._length-1;n>=v;n--)this._array[this._getCyclicIndex(n+p.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<p.length;n++)this._array[this._getCyclicIndex(v+n)]=p[n];if(p.length&&this.onInsertEmitter.fire({index:v,amount:p.length}),this._length+p.length>this._maxLength){const n=this._length+p.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=p.length}trimStart(v){v>this._length&&(v=this._length),this._startIndex+=v,this._length-=v,this.onTrimEmitter.fire(v)}shiftElements(v,C,p){if(!(C<=0)){if(v<0||v>=this._length)throw new Error("start argument out of range");if(v+p<0)throw new Error("Cannot shift elements in list beyond index 0");if(p>0){for(let a=C-1;a>=0;a--)this.set(v+a+p,this.get(v+a));const n=v+C+p-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<C;n++)this.set(v+n+p,this.get(v+n))}}_getCyclicIndex(v){return(this._startIndex+v)%this._maxLength}}t.CircularList=l},1439:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function o(h,f=5){if(typeof h!="object")return h;const l=Array.isArray(h)?[]:{};for(const g in h)l[g]=f<=1?h[g]:h[g]&&o(h[g],f-1);return l}},8055:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let o=0,h=0,f=0,l=0;var g,v,C,p,n;function a(s){const _=s.toString(16);return _.length<2?"0"+_:_}function i(s,_){return s<_?(_+.05)/(s+.05):(s+.05)/(_+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(_,S,y,k){return k!==void 0?`#${a(_)}${a(S)}${a(y)}${a(k)}`:`#${a(_)}${a(S)}${a(y)}`},s.toRgba=function(_,S,y,k=255){return(_<<24|S<<16|y<<8|k)>>>0},s.toColor=function(_,S,y,k){return{css:s.toCss(_,S,y,k),rgba:s.toRgba(_,S,y,k)}}}(g||(t.channels=g={})),function(s){function _(S,y){return l=Math.round(255*y),[o,h,f]=n.toChannels(S.rgba),{css:g.toCss(o,h,f,l),rgba:g.toRgba(o,h,f,l)}}s.blend=function(S,y){if(l=(255&y.rgba)/255,l===1)return{css:y.css,rgba:y.rgba};const k=y.rgba>>24&255,m=y.rgba>>16&255,E=y.rgba>>8&255,R=S.rgba>>24&255,B=S.rgba>>16&255,O=S.rgba>>8&255;return o=R+Math.round((k-R)*l),h=B+Math.round((m-B)*l),f=O+Math.round((E-O)*l),{css:g.toCss(o,h,f),rgba:g.toRgba(o,h,f)}},s.isOpaque=function(S){return(255&S.rgba)==255},s.ensureContrastRatio=function(S,y,k){const m=n.ensureContrastRatio(S.rgba,y.rgba,k);if(m)return g.toColor(m>>24&255,m>>16&255,m>>8&255)},s.opaque=function(S){const y=(255|S.rgba)>>>0;return[o,h,f]=n.toChannels(y),{css:g.toCss(o,h,f),rgba:y}},s.opacity=_,s.multiplyOpacity=function(S,y){return l=255&S.rgba,_(S,l*y/255)},s.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}}(v||(t.color=v={})),function(s){let _,S;try{const y=document.createElement("canvas");y.width=1,y.height=1;const k=y.getContext("2d",{willReadFrequently:!0});k&&(_=k,_.globalCompositeOperation="copy",S=_.createLinearGradient(0,0,1,1))}catch{}s.toColor=function(y){if(y.match(/#[\da-f]{3,8}/i))switch(y.length){case 4:return o=parseInt(y.slice(1,2).repeat(2),16),h=parseInt(y.slice(2,3).repeat(2),16),f=parseInt(y.slice(3,4).repeat(2),16),g.toColor(o,h,f);case 5:return o=parseInt(y.slice(1,2).repeat(2),16),h=parseInt(y.slice(2,3).repeat(2),16),f=parseInt(y.slice(3,4).repeat(2),16),l=parseInt(y.slice(4,5).repeat(2),16),g.toColor(o,h,f,l);case 7:return{css:y,rgba:(parseInt(y.slice(1),16)<<8|255)>>>0};case 9:return{css:y,rgba:parseInt(y.slice(1),16)>>>0}}const k=y.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return o=parseInt(k[1]),h=parseInt(k[2]),f=parseInt(k[3]),l=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),g.toColor(o,h,f,l);if(!_||!S)throw new Error("css.toColor: Unsupported css format");if(_.fillStyle=S,_.fillStyle=y,typeof _.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(_.fillRect(0,0,1,1),[o,h,f,l]=_.getImageData(0,0,1,1).data,l!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:g.toRgba(o,h,f,l),css:y}}}(C||(t.css=C={})),function(s){function _(S,y,k){const m=S/255,E=y/255,R=k/255;return .2126*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.7152*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))+.0722*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))}s.relativeLuminance=function(S){return _(S>>16&255,S>>8&255,255&S)},s.relativeLuminance2=_}(p||(t.rgb=p={})),function(s){function _(y,k,m){const E=y>>24&255,R=y>>16&255,B=y>>8&255;let O=k>>24&255,A=k>>16&255,H=k>>8&255,I=i(p.relativeLuminance2(O,A,H),p.relativeLuminance2(E,R,B));for(;I<m&&(O>0||A>0||H>0);)O-=Math.max(0,Math.ceil(.1*O)),A-=Math.max(0,Math.ceil(.1*A)),H-=Math.max(0,Math.ceil(.1*H)),I=i(p.relativeLuminance2(O,A,H),p.relativeLuminance2(E,R,B));return(O<<24|A<<16|H<<8|255)>>>0}function S(y,k,m){const E=y>>24&255,R=y>>16&255,B=y>>8&255;let O=k>>24&255,A=k>>16&255,H=k>>8&255,I=i(p.relativeLuminance2(O,A,H),p.relativeLuminance2(E,R,B));for(;I<m&&(O<255||A<255||H<255);)O=Math.min(255,O+Math.ceil(.1*(255-O))),A=Math.min(255,A+Math.ceil(.1*(255-A))),H=Math.min(255,H+Math.ceil(.1*(255-H))),I=i(p.relativeLuminance2(O,A,H),p.relativeLuminance2(E,R,B));return(O<<24|A<<16|H<<8|255)>>>0}s.blend=function(y,k){if(l=(255&k)/255,l===1)return k;const m=k>>24&255,E=k>>16&255,R=k>>8&255,B=y>>24&255,O=y>>16&255,A=y>>8&255;return o=B+Math.round((m-B)*l),h=O+Math.round((E-O)*l),f=A+Math.round((R-A)*l),g.toRgba(o,h,f)},s.ensureContrastRatio=function(y,k,m){const E=p.relativeLuminance(y>>8),R=p.relativeLuminance(k>>8);if(i(E,R)<m){if(R<E){const A=_(y,k,m),H=i(E,p.relativeLuminance(A>>8));if(H<m){const I=S(y,k,m);return H>i(E,p.relativeLuminance(I>>8))?A:I}return A}const B=S(y,k,m),O=i(E,p.relativeLuminance(B>>8));if(O<m){const A=_(y,k,m);return O>i(E,p.relativeLuminance(A>>8))?B:A}return B}},s.reduceLuminance=_,s.increaseLuminance=S,s.toChannels=function(y){return[y>>24&255,y>>16&255,y>>8&255,255&y]}}(n||(t.rgba=n={})),t.toPaddedHex=a,t.contrastRatio=i},8969:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const h=o(844),f=o(2585),l=o(4348),g=o(7866),v=o(744),C=o(7302),p=o(6975),n=o(8460),a=o(1753),i=o(1480),s=o(7994),_=o(9282),S=o(5435),y=o(5981),k=o(2660);let m=!1;class E extends h.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(B=>{var O;(O=this._onScrollApi)==null||O.fire(B.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(B){for(const O in B)this.optionsService.options[O]=B[O]}constructor(B){super(),this._windowsWrappingHeuristics=this.register(new h.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new l.InstantiationService,this.optionsService=this.register(new C.OptionsService(B)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(v.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(g.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(p.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(a.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(i.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(s.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(k.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new S.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(O=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(O=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new y.WriteBuffer((O,A)=>this._inputHandler.parse(O,A))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(B,O){this._writeBuffer.write(B,O)}writeSync(B,O){this._logService.logLevel<=f.LogLevelEnum.WARN&&!m&&(this._logService.warn("writeSync is unreliable and will be removed soon."),m=!0),this._writeBuffer.writeSync(B,O)}input(B,O=!0){this.coreService.triggerDataEvent(B,O)}resize(B,O){isNaN(B)||isNaN(O)||(B=Math.max(B,v.MINIMUM_COLS),O=Math.max(O,v.MINIMUM_ROWS),this._bufferService.resize(B,O))}scroll(B,O=!1){this._bufferService.scroll(B,O)}scrollLines(B,O,A){this._bufferService.scrollLines(B,O,A)}scrollPages(B){this.scrollLines(B*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(B){const O=B-this._bufferService.buffer.ydisp;O!==0&&this.scrollLines(O)}registerEscHandler(B,O){return this._inputHandler.registerEscHandler(B,O)}registerDcsHandler(B,O){return this._inputHandler.registerDcsHandler(B,O)}registerCsiHandler(B,O){return this._inputHandler.registerCsiHandler(B,O)}registerOscHandler(B,O){return this._inputHandler.registerOscHandler(B,O)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let B=!1;const O=this.optionsService.rawOptions.windowsPty;O&&O.buildNumber!==void 0&&O.buildNumber!==void 0?B=O.backend==="conpty"&&O.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(B=!0),B?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const B=[];B.push(this.onLineFeed(_.updateWindowsModeWrappedState.bind(null,this._bufferService))),B.push(this.registerCsiHandler({final:"H"},()=>((0,_.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,h.toDisposable)(()=>{for(const O of B)O.dispose()})}}}t.CoreTerminal=E},8460:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=o=>(this._listeners.push(o),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===o)return void this._listeners.splice(h,1)}}})),this._event}fire(o,h){const f=[];for(let l=0;l<this._listeners.length;l++)f.push(this._listeners[l]);for(let l=0;l<f.length;l++)f[l].call(void 0,o,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(o,h){return o(f=>h.fire(f))},t.runAndSubscribe=function(o,h){return h(void 0),o(f=>h(f))}},5435:function(w,t,o){var h=this&&this.__decorate||function(j,x,T,D){var M,F=arguments.length,z=F<3?x:D===null?D=Object.getOwnPropertyDescriptor(x,T):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")z=Reflect.decorate(j,x,T,D);else for(var G=j.length-1;G>=0;G--)(M=j[G])&&(z=(F<3?M(z):F>3?M(x,T,z):M(x,T))||z);return F>3&&z&&Object.defineProperty(x,T,z),z},f=this&&this.__param||function(j,x){return function(T,D){x(T,D,j)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const l=o(2584),g=o(7116),v=o(2015),C=o(844),p=o(482),n=o(8437),a=o(8460),i=o(643),s=o(511),_=o(3734),S=o(2585),y=o(1480),k=o(6242),m=o(6351),E=o(5941),R={"(":0,")":1,"*":2,"+":3,"-":1,".":2},B=131072;function O(j,x){if(j>24)return x.setWinLines||!1;switch(j){case 1:return!!x.restoreWin;case 2:return!!x.minimizeWin;case 3:return!!x.setWinPosition;case 4:return!!x.setWinSizePixels;case 5:return!!x.raiseWin;case 6:return!!x.lowerWin;case 7:return!!x.refreshWin;case 8:return!!x.setWinSizeChars;case 9:return!!x.maximizeWin;case 10:return!!x.fullscreenWin;case 11:return!!x.getWinState;case 13:return!!x.getWinPosition;case 14:return!!x.getWinSizePixels;case 15:return!!x.getScreenSizePixels;case 16:return!!x.getCellSizePixels;case 18:return!!x.getWinSizeChars;case 19:return!!x.getScreenSizeChars;case 20:return!!x.getIconTitle;case 21:return!!x.getWinTitle;case 22:return!!x.pushTitle;case 23:return!!x.popTitle;case 24:return!!x.setWinLines}return!1}var A;(function(j){j[j.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",j[j.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(A||(t.WindowsOptionsReportType=A={}));let H=0;class I extends C.Disposable{getAttrData(){return this._curAttrData}constructor(x,T,D,M,F,z,G,X,P=new v.EscapeSequenceParser){super(),this._bufferService=x,this._charsetService=T,this._coreService=D,this._logService=M,this._optionsService=F,this._oscLinkService=z,this._coreMouseService=G,this._unicodeService=X,this._parser=P,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new p.StringToUtf32,this._utf8Decoder=new p.Utf8ToUtf32,this._workCell=new s.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new a.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new a.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new a.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new a.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new a.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new a.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new a.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new a.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new a.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new a.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new a.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new N(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(L=>this._activeBuffer=L.activeBuffer)),this._parser.setCsiHandlerFallback((L,U)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(L),params:U.toArray()})}),this._parser.setEscHandlerFallback(L=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(L)})}),this._parser.setExecuteHandlerFallback(L=>{this._logService.debug("Unknown EXECUTE code: ",{code:L})}),this._parser.setOscHandlerFallback((L,U,$)=>{this._logService.debug("Unknown OSC code: ",{identifier:L,action:U,data:$})}),this._parser.setDcsHandlerFallback((L,U,$)=>{U==="HOOK"&&($=$.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(L),action:U,payload:$})}),this._parser.setPrintHandler((L,U,$)=>this.print(L,U,$)),this._parser.registerCsiHandler({final:"@"},L=>this.insertChars(L)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},L=>this.scrollLeft(L)),this._parser.registerCsiHandler({final:"A"},L=>this.cursorUp(L)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},L=>this.scrollRight(L)),this._parser.registerCsiHandler({final:"B"},L=>this.cursorDown(L)),this._parser.registerCsiHandler({final:"C"},L=>this.cursorForward(L)),this._parser.registerCsiHandler({final:"D"},L=>this.cursorBackward(L)),this._parser.registerCsiHandler({final:"E"},L=>this.cursorNextLine(L)),this._parser.registerCsiHandler({final:"F"},L=>this.cursorPrecedingLine(L)),this._parser.registerCsiHandler({final:"G"},L=>this.cursorCharAbsolute(L)),this._parser.registerCsiHandler({final:"H"},L=>this.cursorPosition(L)),this._parser.registerCsiHandler({final:"I"},L=>this.cursorForwardTab(L)),this._parser.registerCsiHandler({final:"J"},L=>this.eraseInDisplay(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},L=>this.eraseInDisplay(L,!0)),this._parser.registerCsiHandler({final:"K"},L=>this.eraseInLine(L,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},L=>this.eraseInLine(L,!0)),this._parser.registerCsiHandler({final:"L"},L=>this.insertLines(L)),this._parser.registerCsiHandler({final:"M"},L=>this.deleteLines(L)),this._parser.registerCsiHandler({final:"P"},L=>this.deleteChars(L)),this._parser.registerCsiHandler({final:"S"},L=>this.scrollUp(L)),this._parser.registerCsiHandler({final:"T"},L=>this.scrollDown(L)),this._parser.registerCsiHandler({final:"X"},L=>this.eraseChars(L)),this._parser.registerCsiHandler({final:"Z"},L=>this.cursorBackwardTab(L)),this._parser.registerCsiHandler({final:"`"},L=>this.charPosAbsolute(L)),this._parser.registerCsiHandler({final:"a"},L=>this.hPositionRelative(L)),this._parser.registerCsiHandler({final:"b"},L=>this.repeatPrecedingCharacter(L)),this._parser.registerCsiHandler({final:"c"},L=>this.sendDeviceAttributesPrimary(L)),this._parser.registerCsiHandler({prefix:">",final:"c"},L=>this.sendDeviceAttributesSecondary(L)),this._parser.registerCsiHandler({final:"d"},L=>this.linePosAbsolute(L)),this._parser.registerCsiHandler({final:"e"},L=>this.vPositionRelative(L)),this._parser.registerCsiHandler({final:"f"},L=>this.hVPosition(L)),this._parser.registerCsiHandler({final:"g"},L=>this.tabClear(L)),this._parser.registerCsiHandler({final:"h"},L=>this.setMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"h"},L=>this.setModePrivate(L)),this._parser.registerCsiHandler({final:"l"},L=>this.resetMode(L)),this._parser.registerCsiHandler({prefix:"?",final:"l"},L=>this.resetModePrivate(L)),this._parser.registerCsiHandler({final:"m"},L=>this.charAttributes(L)),this._parser.registerCsiHandler({final:"n"},L=>this.deviceStatus(L)),this._parser.registerCsiHandler({prefix:"?",final:"n"},L=>this.deviceStatusPrivate(L)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},L=>this.softReset(L)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},L=>this.setCursorStyle(L)),this._parser.registerCsiHandler({final:"r"},L=>this.setScrollRegion(L)),this._parser.registerCsiHandler({final:"s"},L=>this.saveCursor(L)),this._parser.registerCsiHandler({final:"t"},L=>this.windowOptions(L)),this._parser.registerCsiHandler({final:"u"},L=>this.restoreCursor(L)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},L=>this.insertColumns(L)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},L=>this.deleteColumns(L)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},L=>this.selectProtected(L)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},L=>this.requestMode(L,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},L=>this.requestMode(L,!1)),this._parser.setExecuteHandler(l.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(l.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(l.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(l.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(l.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(l.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(l.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(l.C1.IND,()=>this.index()),this._parser.setExecuteHandler(l.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(l.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new k.OscHandler(L=>(this.setTitle(L),this.setIconName(L),!0))),this._parser.registerOscHandler(1,new k.OscHandler(L=>this.setIconName(L))),this._parser.registerOscHandler(2,new k.OscHandler(L=>this.setTitle(L))),this._parser.registerOscHandler(4,new k.OscHandler(L=>this.setOrReportIndexedColor(L))),this._parser.registerOscHandler(8,new k.OscHandler(L=>this.setHyperlink(L))),this._parser.registerOscHandler(10,new k.OscHandler(L=>this.setOrReportFgColor(L))),this._parser.registerOscHandler(11,new k.OscHandler(L=>this.setOrReportBgColor(L))),this._parser.registerOscHandler(12,new k.OscHandler(L=>this.setOrReportCursorColor(L))),this._parser.registerOscHandler(104,new k.OscHandler(L=>this.restoreIndexedColor(L))),this._parser.registerOscHandler(110,new k.OscHandler(L=>this.restoreFgColor(L))),this._parser.registerOscHandler(111,new k.OscHandler(L=>this.restoreBgColor(L))),this._parser.registerOscHandler(112,new k.OscHandler(L=>this.restoreCursorColor(L))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const L in g.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:L},()=>this.selectCharset("("+L)),this._parser.registerEscHandler({intermediates:")",final:L},()=>this.selectCharset(")"+L)),this._parser.registerEscHandler({intermediates:"*",final:L},()=>this.selectCharset("*"+L)),this._parser.registerEscHandler({intermediates:"+",final:L},()=>this.selectCharset("+"+L)),this._parser.registerEscHandler({intermediates:"-",final:L},()=>this.selectCharset("-"+L)),this._parser.registerEscHandler({intermediates:".",final:L},()=>this.selectCharset("."+L)),this._parser.registerEscHandler({intermediates:"/",final:L},()=>this.selectCharset("/"+L));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(L=>(this._logService.error("Parsing error: ",L),L)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new m.DcsHandler((L,U)=>this.requestStatusString(L,U)))}_preserveStack(x,T,D,M){this._parseStack.paused=!0,this._parseStack.cursorStartX=x,this._parseStack.cursorStartY=T,this._parseStack.decodedLength=D,this._parseStack.position=M}_logSlowResolvingAsync(x){this._logService.logLevel<=S.LogLevelEnum.WARN&&Promise.race([x,new Promise((T,D)=>setTimeout(()=>D("#SLOW_TIMEOUT"),5e3))]).catch(T=>{if(T!=="#SLOW_TIMEOUT")throw T;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(x,T){let D,M=this._activeBuffer.x,F=this._activeBuffer.y,z=0;const G=this._parseStack.paused;if(G){if(D=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,T))return this._logSlowResolvingAsync(D),D;M=this._parseStack.cursorStartX,F=this._parseStack.cursorStartY,this._parseStack.paused=!1,x.length>B&&(z=this._parseStack.position+B)}if(this._logService.logLevel<=S.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof x=="string"?` "${x}"`:` "${Array.prototype.map.call(x,L=>String.fromCharCode(L)).join("")}"`),typeof x=="string"?x.split("").map(L=>L.charCodeAt(0)):x),this._parseBuffer.length<x.length&&this._parseBuffer.length<B&&(this._parseBuffer=new Uint32Array(Math.min(x.length,B))),G||this._dirtyRowTracker.clearRange(),x.length>B)for(let L=z;L<x.length;L+=B){const U=L+B<x.length?L+B:x.length,$=typeof x=="string"?this._stringDecoder.decode(x.substring(L,U),this._parseBuffer):this._utf8Decoder.decode(x.subarray(L,U),this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,$))return this._preserveStack(M,F,$,L),this._logSlowResolvingAsync(D),D}else if(!G){const L=typeof x=="string"?this._stringDecoder.decode(x,this._parseBuffer):this._utf8Decoder.decode(x,this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,L))return this._preserveStack(M,F,L,0),this._logSlowResolvingAsync(D),D}this._activeBuffer.x===M&&this._activeBuffer.y===F||this._onCursorMove.fire();const X=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),P=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);P<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(P,this._bufferService.rows-1),Math.min(X,this._bufferService.rows-1))}print(x,T,D){let M,F;const z=this._charsetService.charset,G=this._optionsService.rawOptions.screenReaderMode,X=this._bufferService.cols,P=this._coreService.decPrivateModes.wraparound,L=this._coreService.modes.insertMode,U=this._curAttrData;let $=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&D-T>0&&$.getWidth(this._activeBuffer.x-1)===2&&$.setCellFromCodepoint(this._activeBuffer.x-1,0,1,U);let V=this._parser.precedingJoinState;for(let K=T;K<D;++K){if(M=x[K],M<127&&z){const he=z[String.fromCharCode(M)];he&&(M=he.charCodeAt(0))}const Y=this._unicodeService.charProperties(M,V);F=y.UnicodeService.extractWidth(Y);const ne=y.UnicodeService.extractShouldJoin(Y),oe=ne?y.UnicodeService.extractWidth(V):0;if(V=Y,G&&this._onA11yChar.fire((0,p.stringFromCodePoint)(M)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+F-oe>X){if(P){const he=$;let J=this._activeBuffer.x-oe;for(this._activeBuffer.x=oe,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),$=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),oe>0&&$ instanceof n.BufferLine&&$.copyCellsFrom(he,J,0,oe,!1);J<X;)he.setCellFromCodepoint(J++,0,1,U)}else if(this._activeBuffer.x=X-1,F===2)continue}if(ne&&this._activeBuffer.x){const he=$.getWidth(this._activeBuffer.x-1)?1:2;$.addCodepointToCell(this._activeBuffer.x-he,M,F);for(let J=F-oe;--J>=0;)$.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}else if(L&&($.insertCells(this._activeBuffer.x,F-oe,this._activeBuffer.getNullCell(U)),$.getWidth(X-1)===2&&$.setCellFromCodepoint(X-1,i.NULL_CELL_CODE,i.NULL_CELL_WIDTH,U)),$.setCellFromCodepoint(this._activeBuffer.x++,M,F,U),F>0)for(;--F;)$.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}this._parser.precedingJoinState=V,this._activeBuffer.x<X&&D-T>0&&$.getWidth(this._activeBuffer.x)===0&&!$.hasContent(this._activeBuffer.x)&&$.setCellFromCodepoint(this._activeBuffer.x,0,1,U),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(x,T){return x.final!=="t"||x.prefix||x.intermediates?this._parser.registerCsiHandler(x,T):this._parser.registerCsiHandler(x,D=>!O(D.params[0],this._optionsService.rawOptions.windowOptions)||T(D))}registerDcsHandler(x,T){return this._parser.registerDcsHandler(x,new m.DcsHandler(T))}registerEscHandler(x,T){return this._parser.registerEscHandler(x,T)}registerOscHandler(x,T){return this._parser.registerOscHandler(x,new k.OscHandler(T))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var x;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&x.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);T.hasWidth(this._activeBuffer.x)&&!T.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const x=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-x),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(x=this._bufferService.cols-1){this._activeBuffer.x=Math.min(x,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(x,T){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=x,this._activeBuffer.y=this._activeBuffer.scrollTop+T):(this._activeBuffer.x=x,this._activeBuffer.y=T),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(x,T){this._restrictCursor(),this._setCursor(this._activeBuffer.x+x,this._activeBuffer.y+T)}cursorUp(x){const T=this._activeBuffer.y-this._activeBuffer.scrollTop;return T>=0?this._moveCursor(0,-Math.min(T,x.params[0]||1)):this._moveCursor(0,-(x.params[0]||1)),!0}cursorDown(x){const T=this._activeBuffer.scrollBottom-this._activeBuffer.y;return T>=0?this._moveCursor(0,Math.min(T,x.params[0]||1)):this._moveCursor(0,x.params[0]||1),!0}cursorForward(x){return this._moveCursor(x.params[0]||1,0),!0}cursorBackward(x){return this._moveCursor(-(x.params[0]||1),0),!0}cursorNextLine(x){return this.cursorDown(x),this._activeBuffer.x=0,!0}cursorPrecedingLine(x){return this.cursorUp(x),this._activeBuffer.x=0,!0}cursorCharAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(x){return this._setCursor(x.length>=2?(x.params[1]||1)-1:0,(x.params[0]||1)-1),!0}charPosAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(x){return this._moveCursor(x.params[0]||1,0),!0}linePosAbsolute(x){return this._setCursor(this._activeBuffer.x,(x.params[0]||1)-1),!0}vPositionRelative(x){return this._moveCursor(0,x.params[0]||1),!0}hVPosition(x){return this.cursorPosition(x),!0}tabClear(x){const T=x.params[0];return T===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:T===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=x.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=x.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(x){const T=x.params[0];return T===1&&(this._curAttrData.bg|=536870912),T!==2&&T!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(x,T,D,M=!1,F=!1){const z=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);z.replaceCells(T,D,this._activeBuffer.getNullCell(this._eraseAttrData()),F),M&&(z.isWrapped=!1)}_resetBufferLine(x,T=!1){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);D&&(D.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),T),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+x),D.isWrapped=!1)}eraseInDisplay(x,T=!1){let D;switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);D<this._bufferService.rows;D++)this._resetBufferLine(D,T);this._dirtyRowTracker.markDirty(D);break;case 1:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D,0,this._activeBuffer.x+1,!0,T),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(D+1).isWrapped=!1);D--;)this._resetBufferLine(D,T);this._dirtyRowTracker.markDirty(0);break;case 2:for(D=this._bufferService.rows,this._dirtyRowTracker.markDirty(D-1);D--;)this._resetBufferLine(D,T);this._dirtyRowTracker.markDirty(0);break;case 3:const M=this._activeBuffer.lines.length-this._bufferService.rows;M>0&&(this._activeBuffer.lines.trimStart(M),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-M,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-M,0),this._onScroll.fire(0))}return!0}eraseInLine(x,T=!1){switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,T);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,T)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(x){this._restrictCursor();let T=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y,M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,F=this._bufferService.rows-1+this._activeBuffer.ybase-M+1;for(;T--;)this._activeBuffer.lines.splice(F-1,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(x){this._restrictCursor();let T=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y;let M;for(M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,M=this._bufferService.rows-1+this._activeBuffer.ybase-M;T--;)this._activeBuffer.lines.splice(D,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(x){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.insertCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(x){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.deleteCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(x){let T=x.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(x){let T=x.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=x.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);M.deleteCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=x.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);M.insertCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=x.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);M.insertCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=x.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);M.deleteCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData())),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(x){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(x.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(x){const T=this._parser.precedingJoinState;if(!T)return!0;const D=x.params[0]||1,M=y.UnicodeService.extractWidth(T),F=this._activeBuffer.x-M,z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(F),G=new Uint32Array(z.length*D);let X=0;for(let L=0;L<z.length;){const U=z.codePointAt(L)||0;G[X++]=U,L+=U>65535?2:1}let P=X;for(let L=1;L<D;++L)G.copyWithin(P,0,X),P+=X;return this.print(G,0,P),!0}sendDeviceAttributesPrimary(x){return x.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(l.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(l.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(x){return x.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(l.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(l.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(x.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(l.C0.ESC+"[>83;40003;0c")),!0}_is(x){return(this._optionsService.rawOptions.termName+"").indexOf(x)===0}setMode(x){for(let T=0;T<x.length;T++)switch(x.params[T]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(x){for(let T=0;T<x.length;T++)switch(x.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),this._charsetService.setgCharset(1,g.DEFAULT_CHARSET),this._charsetService.setgCharset(2,g.DEFAULT_CHARSET),this._charsetService.setgCharset(3,g.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(x){for(let T=0;T<x.length;T++)switch(x.params[T]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(x){for(let T=0;T<x.length;T++)switch(x.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),x.params[T]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(x,T){const D=this._coreService.decPrivateModes,{activeProtocol:M,activeEncoding:F}=this._coreMouseService,z=this._coreService,{buffers:G,cols:X}=this._bufferService,{active:P,alt:L}=G,U=this._optionsService.rawOptions,$=ne=>ne?1:2,V=x.params[0];return K=V,Y=T?V===2?4:V===4?$(z.modes.insertMode):V===12?3:V===20?$(U.convertEol):0:V===1?$(D.applicationCursorKeys):V===3?U.windowOptions.setWinLines?X===80?2:X===132?1:0:0:V===6?$(D.origin):V===7?$(D.wraparound):V===8?3:V===9?$(M==="X10"):V===12?$(U.cursorBlink):V===25?$(!z.isCursorHidden):V===45?$(D.reverseWraparound):V===66?$(D.applicationKeypad):V===67?4:V===1e3?$(M==="VT200"):V===1002?$(M==="DRAG"):V===1003?$(M==="ANY"):V===1004?$(D.sendFocus):V===1005?4:V===1006?$(F==="SGR"):V===1015?4:V===1016?$(F==="SGR_PIXELS"):V===1048?1:V===47||V===1047||V===1049?$(P===L):V===2004?$(D.bracketedPasteMode):0,z.triggerDataEvent(`${l.C0.ESC}[${T?"":"?"}${K};${Y}$y`),!0;var K,Y}_updateAttrColor(x,T,D,M,F){return T===2?(x|=50331648,x&=-16777216,x|=_.AttributeData.fromColorRGB([D,M,F])):T===5&&(x&=-50331904,x|=33554432|255&D),x}_extractColor(x,T,D){const M=[0,0,-1,0,0,0];let F=0,z=0;do{if(M[z+F]=x.params[T+z],x.hasSubParams(T+z)){const G=x.getSubParams(T+z);let X=0;do M[1]===5&&(F=1),M[z+X+1+F]=G[X];while(++X<G.length&&X+z+1+F<M.length);break}if(M[1]===5&&z+F>=2||M[1]===2&&z+F>=5)break;M[1]&&(F=1)}while(++z+T<x.length&&z+F<M.length);for(let G=2;G<M.length;++G)M[G]===-1&&(M[G]=0);switch(M[0]){case 38:D.fg=this._updateAttrColor(D.fg,M[1],M[3],M[4],M[5]);break;case 48:D.bg=this._updateAttrColor(D.bg,M[1],M[3],M[4],M[5]);break;case 58:D.extended=D.extended.clone(),D.extended.underlineColor=this._updateAttrColor(D.extended.underlineColor,M[1],M[3],M[4],M[5])}return z}_processUnderline(x,T){T.extended=T.extended.clone(),(!~x||x>5)&&(x=1),T.extended.underlineStyle=x,T.fg|=268435456,x===0&&(T.fg&=-268435457),T.updateExtended()}_processSGR0(x){x.fg=n.DEFAULT_ATTR_DATA.fg,x.bg=n.DEFAULT_ATTR_DATA.bg,x.extended=x.extended.clone(),x.extended.underlineStyle=0,x.extended.underlineColor&=-67108864,x.updateExtended()}charAttributes(x){if(x.length===1&&x.params[0]===0)return this._processSGR0(this._curAttrData),!0;const T=x.length;let D;const M=this._curAttrData;for(let F=0;F<T;F++)D=x.params[F],D>=30&&D<=37?(M.fg&=-50331904,M.fg|=16777216|D-30):D>=40&&D<=47?(M.bg&=-50331904,M.bg|=16777216|D-40):D>=90&&D<=97?(M.fg&=-50331904,M.fg|=16777224|D-90):D>=100&&D<=107?(M.bg&=-50331904,M.bg|=16777224|D-100):D===0?this._processSGR0(M):D===1?M.fg|=134217728:D===3?M.bg|=67108864:D===4?(M.fg|=268435456,this._processUnderline(x.hasSubParams(F)?x.getSubParams(F)[0]:1,M)):D===5?M.fg|=536870912:D===7?M.fg|=67108864:D===8?M.fg|=1073741824:D===9?M.fg|=2147483648:D===2?M.bg|=134217728:D===21?this._processUnderline(2,M):D===22?(M.fg&=-134217729,M.bg&=-134217729):D===23?M.bg&=-67108865:D===24?(M.fg&=-268435457,this._processUnderline(0,M)):D===25?M.fg&=-536870913:D===27?M.fg&=-67108865:D===28?M.fg&=-1073741825:D===29?M.fg&=2147483647:D===39?(M.fg&=-67108864,M.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):D===49?(M.bg&=-67108864,M.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):D===38||D===48||D===58?F+=this._extractColor(x,F,M):D===53?M.bg|=1073741824:D===55?M.bg&=-1073741825:D===59?(M.extended=M.extended.clone(),M.extended.underlineColor=-1,M.updateExtended()):D===100?(M.fg&=-67108864,M.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,M.bg&=-67108864,M.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",D);return!0}deviceStatus(x){switch(x.params[0]){case 5:this._coreService.triggerDataEvent(`${l.C0.ESC}[0n`);break;case 6:const T=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[${T};${D}R`)}return!0}deviceStatusPrivate(x){if(x.params[0]===6){const T=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${l.C0.ESC}[?${T};${D}R`)}return!0}softReset(x){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(x){const T=x.params[0]||1;switch(T){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const D=T%2==1;return this._optionsService.options.cursorBlink=D,!0}setScrollRegion(x){const T=x.params[0]||1;let D;return(x.length<2||(D=x.params[1])>this._bufferService.rows||D===0)&&(D=this._bufferService.rows),D>T&&(this._activeBuffer.scrollTop=T-1,this._activeBuffer.scrollBottom=D-1,this._setCursor(0,0)),!0}windowOptions(x){if(!O(x.params[0],this._optionsService.rawOptions.windowOptions))return!0;const T=x.length>1?x.params[1]:0;switch(x.params[0]){case 14:T!==2&&this._onRequestWindowsOptionsReport.fire(A.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(A.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${l.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:T!==0&&T!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),T!==0&&T!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:T!==0&&T!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),T!==0&&T!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(x){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(x){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(x){return this._windowTitle=x,this._onTitleChange.fire(x),!0}setIconName(x){return this._iconName=x,!0}setOrReportIndexedColor(x){const T=[],D=x.split(";");for(;D.length>1;){const M=D.shift(),F=D.shift();if(/^\d+$/.exec(M)){const z=parseInt(M);if(q(z))if(F==="?")T.push({type:0,index:z});else{const G=(0,E.parseColor)(F);G&&T.push({type:1,index:z,color:G})}}}return T.length&&this._onColor.fire(T),!0}setHyperlink(x){const T=x.split(";");return!(T.length<2)&&(T[1]?this._createHyperlink(T[0],T[1]):!T[0]&&this._finishHyperlink())}_createHyperlink(x,T){this._getCurrentLinkId()&&this._finishHyperlink();const D=x.split(":");let M;const F=D.findIndex(z=>z.startsWith("id="));return F!==-1&&(M=D[F].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:M,uri:T}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(x,T){const D=x.split(";");for(let M=0;M<D.length&&!(T>=this._specialColors.length);++M,++T)if(D[M]==="?")this._onColor.fire([{type:0,index:this._specialColors[T]}]);else{const F=(0,E.parseColor)(D[M]);F&&this._onColor.fire([{type:1,index:this._specialColors[T],color:F}])}return!0}setOrReportFgColor(x){return this._setOrReportSpecialColor(x,0)}setOrReportBgColor(x){return this._setOrReportSpecialColor(x,1)}setOrReportCursorColor(x){return this._setOrReportSpecialColor(x,2)}restoreIndexedColor(x){if(!x)return this._onColor.fire([{type:2}]),!0;const T=[],D=x.split(";");for(let M=0;M<D.length;++M)if(/^\d+$/.exec(D[M])){const F=parseInt(D[M]);q(F)&&T.push({type:2,index:F})}return T.length&&this._onColor.fire(T),!0}restoreFgColor(x){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(x){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(x){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),!0}selectCharset(x){return x.length!==2?(this.selectDefaultCharset(),!0):(x[0]==="/"||this._charsetService.setgCharset(R[x[0]],g.CHARSETS[x[1]]||g.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const x=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,x,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(x){return this._charsetService.setgLevel(x),!0}screenAlignmentPattern(){const x=new s.CellData;x.content=4194373,x.fg=this._curAttrData.fg,x.bg=this._curAttrData.bg,this._setCursor(0,0);for(let T=0;T<this._bufferService.rows;++T){const D=this._activeBuffer.ybase+this._activeBuffer.y+T,M=this._activeBuffer.lines.get(D);M&&(M.fill(x),M.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(x,T){const D=this._bufferService.buffer,M=this._optionsService.rawOptions;return(F=>(this._coreService.triggerDataEvent(`${l.C0.ESC}${F}${l.C0.ESC}\\`),!0))(x==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:x==='"p'?'P1$r61;1"p':x==="r"?`P1$r${D.scrollTop+1};${D.scrollBottom+1}r`:x==="m"?"P1$r0m":x===" q"?`P1$r${{block:2,underline:4,bar:6}[M.cursorStyle]-(M.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(x,T){this._dirtyRowTracker.markRangeDirty(x,T)}}t.InputHandler=I;let N=class{constructor(j){this._bufferService=j,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(j){j<this.start?this.start=j:j>this.end&&(this.end=j)}markRangeDirty(j,x){j>x&&(H=j,j=x,x=H),j<this.start&&(this.start=j),x>this.end&&(this.end=x)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function q(j){return 0<=j&&j<256}N=h([f(0,S.IBufferService)],N)},844:(w,t)=>{function o(h){for(const f of h)f.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){const f=this._disposables.indexOf(h);f!==-1&&this._disposables.splice(f,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){var f;this._isDisposed||h===this._value||((f=this._value)==null||f.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){var h;this._isDisposed=!0,(h=this._value)==null||h.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=o,t.getDisposeArrayDisposable=function(h){return{dispose:()=>o(h)}}},1505:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class o{constructor(){this._data={}}set(f,l,g){this._data[f]||(this._data[f]={}),this._data[f][l]=g}get(f,l){return this._data[f]?this._data[f][l]:void 0}clear(){this._data={}}}t.TwoKeyMap=o,t.FourKeyMap=class{constructor(){this._data=new o}set(h,f,l,g,v){this._data.get(h,f)||this._data.set(h,f,new o),this._data.get(h,f).set(l,g,v)}get(h,f,l,g){var v;return(v=this._data.get(h,f))==null?void 0:v.get(l,g)}clear(){this._data.clear()}}},6114:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof process<"u"&&"title"in process;const o=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=o.includes("Firefox"),t.isLegacyEdge=o.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(o),t.getSafariVersion=function(){if(!t.isSafari)return 0;const f=o.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(o)},6106:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let o=0;t.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(o=this._search(this._getKey(h)),this._array.splice(o,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;const f=this._getKey(h);if(f===void 0||(o=this._search(f),o===-1)||this._getKey(this._array[o])!==f)return!1;do if(this._array[o]===h)return this._array.splice(o,1),!0;while(++o<this._array.length&&this._getKey(this._array[o])===f);return!1}*getKeyIterator(h){if(this._array.length!==0&&(o=this._search(h),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===h))do yield this._array[o];while(++o<this._array.length&&this._getKey(this._array[o])===h)}forEachByKey(h,f){if(this._array.length!==0&&(o=this._search(h),!(o<0||o>=this._array.length)&&this._getKey(this._array[o])===h))do f(this._array[o]);while(++o<this._array.length&&this._getKey(this._array[o])===h)}values(){return[...this._array].values()}_search(h){let f=0,l=this._array.length-1;for(;l>=f;){let g=f+l>>1;const v=this._getKey(this._array[g]);if(v>h)l=g-1;else{if(!(v<h)){for(;g>0&&this._getKey(this._array[g-1])===h;)g--;return g}f=g+1}}return f}}},7226:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const h=o(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(v){this._tasks.push(v),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(v){this._idleCallback=void 0;let C=0,p=0,n=v.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(C=Date.now(),this._tasks[this._i]()||this._i++,C=Math.max(1,Date.now()-C),p=Math.max(C,p),a=v.timeRemaining(),1.5*p>a)return n-C<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-C))}ms`),void this._start();n=a}this.clear()}}class l extends f{_requestCallback(v){return setTimeout(()=>v(this._createDeadline(16)))}_cancelCallback(v){clearTimeout(v)}_createDeadline(v){const C=Date.now()+v;return{timeRemaining:()=>Math.max(0,C-Date.now())}}}t.PriorityTaskQueue=l,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(g){return requestIdleCallback(g)}_cancelCallback(g){cancelIdleCallback(g)}}:l,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(g){this._queue.clear(),this._queue.enqueue(g)}flush(){this._queue.flush()}}},9282:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const h=o(643);t.updateWindowsModeWrappedState=function(f){const l=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),g=l==null?void 0:l.get(f.cols-1),v=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);v&&g&&(v.isWrapped=g[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&g[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class o{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(l){return[l>>>16&255,l>>>8&255,255&l]}static fromColorRGB(l){return(255&l[0])<<16|(255&l[1])<<8|255&l[2]}clone(){const l=new o;return l.fg=this.fg,l.bg=this.bg,l.extended=this.extended.clone(),l}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=o;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(l){this._ext=l}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(l){this._ext&=-469762049,this._ext|=l<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(l){this._ext&=-67108864,this._ext|=67108863&l}get urlId(){return this._urlId}set urlId(l){this._urlId=l}get underlineVariantOffset(){const l=(3758096384&this._ext)>>29;return l<0?4294967288^l:l}set underlineVariantOffset(l){this._ext&=536870911,this._ext|=l<<29&3758096384}constructor(l=0,g=0){this._ext=0,this._urlId=0,this._ext=l,this._urlId=g}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},9092:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const h=o(6349),f=o(7226),l=o(3734),g=o(8437),v=o(4634),C=o(511),p=o(643),n=o(4863),a=o(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(i,s,_){this._hasScrollback=i,this._optionsService=s,this._bufferService=_,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=g.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=C.CellData.fromCharData([0,p.NULL_CELL_CHAR,p.NULL_CELL_WIDTH,p.NULL_CELL_CODE]),this._whitespaceCell=C.CellData.fromCharData([0,p.WHITESPACE_CELL_CHAR,p.WHITESPACE_CELL_WIDTH,p.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new f.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(i){return i?(this._nullCell.fg=i.fg,this._nullCell.bg=i.bg,this._nullCell.extended=i.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new l.ExtendedAttrs),this._nullCell}getWhitespaceCell(i){return i?(this._whitespaceCell.fg=i.fg,this._whitespaceCell.bg=i.bg,this._whitespaceCell.extended=i.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new l.ExtendedAttrs),this._whitespaceCell}getBlankLine(i,s){return new g.BufferLine(this._bufferService.cols,this.getNullCell(i),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const i=this.ybase+this.y-this.ydisp;return i>=0&&i<this._rows}_getCorrectBufferLength(i){if(!this._hasScrollback)return i;const s=i+this._optionsService.rawOptions.scrollback;return s>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:s}fillViewportRows(i){if(this.lines.length===0){i===void 0&&(i=g.DEFAULT_ATTR_DATA);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(i))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(i,s){const _=this.getNullCell(g.DEFAULT_ATTR_DATA);let S=0;const y=this._getCorrectBufferLength(s);if(y>this.lines.maxLength&&(this.lines.maxLength=y),this.lines.length>0){if(this._cols<i)for(let m=0;m<this.lines.length;m++)S+=+this.lines.get(m).resize(i,_);let k=0;if(this._rows<s)for(let m=this._rows;m<s;m++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new g.BufferLine(i,_)):this.ybase>0&&this.lines.length<=this.ybase+this.y+k+1?(this.ybase--,k++,this.ydisp>0&&this.ydisp--):this.lines.push(new g.BufferLine(i,_)));else for(let m=this._rows;m>s;m--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(y<this.lines.maxLength){const m=this.lines.length-y;m>0&&(this.lines.trimStart(m),this.ybase=Math.max(this.ybase-m,0),this.ydisp=Math.max(this.ydisp-m,0),this.savedY=Math.max(this.savedY-m,0)),this.lines.maxLength=y}this.x=Math.min(this.x,i-1),this.y=Math.min(this.y,s-1),k&&(this.y+=k),this.savedX=Math.min(this.savedX,i-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(i,s),this._cols>i))for(let k=0;k<this.lines.length;k++)S+=+this.lines.get(k).resize(i,_);this._cols=i,this._rows=s,this._memoryCleanupQueue.clear(),S>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let i=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,i=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return i}get _isReflowEnabled(){const i=this._optionsService.rawOptions.windowsPty;return i&&i.buildNumber?this._hasScrollback&&i.backend==="conpty"&&i.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(i,s){this._cols!==i&&(i>this._cols?this._reflowLarger(i,s):this._reflowSmaller(i,s))}_reflowLarger(i,s){const _=(0,v.reflowLargerGetLinesToRemove)(this.lines,this._cols,i,this.ybase+this.y,this.getNullCell(g.DEFAULT_ATTR_DATA));if(_.length>0){const S=(0,v.reflowLargerCreateNewLayout)(this.lines,_);(0,v.reflowLargerApplyNewLayout)(this.lines,S.layout),this._reflowLargerAdjustViewport(i,s,S.countRemoved)}}_reflowLargerAdjustViewport(i,s,_){const S=this.getNullCell(g.DEFAULT_ATTR_DATA);let y=_;for(;y-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new g.BufferLine(i,S))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-_,0)}_reflowSmaller(i,s){const _=this.getNullCell(g.DEFAULT_ATTR_DATA),S=[];let y=0;for(let k=this.lines.length-1;k>=0;k--){let m=this.lines.get(k);if(!m||!m.isWrapped&&m.getTrimmedLength()<=i)continue;const E=[m];for(;m.isWrapped&&k>0;)m=this.lines.get(--k),E.unshift(m);const R=this.ybase+this.y;if(R>=k&&R<k+E.length)continue;const B=E[E.length-1].getTrimmedLength(),O=(0,v.reflowSmallerGetNewLineLengths)(E,this._cols,i),A=O.length-E.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+A):Math.max(0,this.lines.length-this.lines.maxLength+A);const I=[];for(let D=0;D<A;D++){const M=this.getBlankLine(g.DEFAULT_ATTR_DATA,!0);I.push(M)}I.length>0&&(S.push({start:k+E.length+y,newLines:I}),y+=I.length),E.push(...I);let N=O.length-1,q=O[N];q===0&&(N--,q=O[N]);let j=E.length-A-1,x=B;for(;j>=0;){const D=Math.min(x,q);if(E[N]===void 0)break;if(E[N].copyCellsFrom(E[j],x-D,q-D,D,!0),q-=D,q===0&&(N--,q=O[N]),x-=D,x===0){j--;const M=Math.max(j,0);x=(0,v.getWrappedLineTrimmedLength)(E,M,this._cols)}}for(let D=0;D<E.length;D++)O[D]<i&&E[D].setCell(O[D],_);let T=A-H;for(;T-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+y)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+A,this.ybase+s-1)}if(S.length>0){const k=[],m=[];for(let N=0;N<this.lines.length;N++)m.push(this.lines.get(N));const E=this.lines.length;let R=E-1,B=0,O=S[B];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+y);let A=0;for(let N=Math.min(this.lines.maxLength-1,E+y-1);N>=0;N--)if(O&&O.start>R+A){for(let q=O.newLines.length-1;q>=0;q--)this.lines.set(N--,O.newLines[q]);N++,k.push({index:R+1,amount:O.newLines.length}),A+=O.newLines.length,O=S[++B]}else this.lines.set(N,m[R--]);let H=0;for(let N=k.length-1;N>=0;N--)k[N].index+=H,this.lines.onInsertEmitter.fire(k[N]),H+=k[N].amount;const I=Math.max(0,E+y-this.lines.maxLength);I>0&&this.lines.onTrimEmitter.fire(I)}}translateBufferLineToString(i,s,_=0,S){const y=this.lines.get(i);return y?y.translateToString(s,_,S):""}getWrappedRangeForLine(i){let s=i,_=i;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;_+1<this.lines.length&&this.lines.get(_+1).isWrapped;)_++;return{first:s,last:_}}setupTabStops(i){for(i!=null?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this._cols;i+=this._optionsService.rawOptions.tabStopWidth)this.tabs[i]=!0}prevStop(i){for(i==null&&(i=this.x);!this.tabs[--i]&&i>0;);return i>=this._cols?this._cols-1:i<0?0:i}nextStop(i){for(i==null&&(i=this.x);!this.tabs[++i]&&i<this._cols;);return i>=this._cols?this._cols-1:i<0?0:i}clearMarkers(i){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===i&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].dispose(),this.markers.splice(i--,1);this._isClearing=!1}addMarker(i){const s=new n.Marker(i);return this.markers.push(s),s.register(this.lines.onTrim(_=>{s.line-=_,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(_=>{s.line>=_.index&&(s.line+=_.amount)})),s.register(this.lines.onDelete(_=>{s.line>=_.index&&s.line<_.index+_.amount&&s.dispose(),s.line>_.index&&(s.line-=_.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(i){this._isClearing||this.markers.splice(this.markers.indexOf(i),1)}}},8437:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const h=o(3734),f=o(511),l=o(643),g=o(482);t.DEFAULT_ATTR_DATA=Object.freeze(new h.AttributeData);let v=0;class C{constructor(n,a,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const s=a||f.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]);for(let _=0;_<n;++_)this.setCell(_,s);this.length=n}get(n){const a=this._data[3*n+0],i=2097151&a;return[this._data[3*n+1],2097152&a?this._combined[n]:i?(0,g.stringFromCodePoint)(i):"",a>>22,2097152&a?this._combined[n].charCodeAt(this._combined[n].length-1):i]}set(n,a){this._data[3*n+1]=a[l.CHAR_DATA_ATTR_INDEX],a[l.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=a[1],this._data[3*n+0]=2097152|n|a[l.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=a[l.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[l.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const a=this._data[3*n+0];return 2097152&a?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&a}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const a=this._data[3*n+0];return 2097152&a?this._combined[n]:2097151&a?(0,g.stringFromCodePoint)(2097151&a):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,a){return v=3*n,a.content=this._data[v+0],a.fg=this._data[v+1],a.bg=this._data[v+2],2097152&a.content&&(a.combinedData=this._combined[n]),268435456&a.bg&&(a.extended=this._extendedAttrs[n]),a}setCell(n,a){2097152&a.content&&(this._combined[n]=a.combinedData),268435456&a.bg&&(this._extendedAttrs[n]=a.extended),this._data[3*n+0]=a.content,this._data[3*n+1]=a.fg,this._data[3*n+2]=a.bg}setCellFromCodepoint(n,a,i,s){268435456&s.bg&&(this._extendedAttrs[n]=s.extended),this._data[3*n+0]=a|i<<22,this._data[3*n+1]=s.fg,this._data[3*n+2]=s.bg}addCodepointToCell(n,a,i){let s=this._data[3*n+0];2097152&s?this._combined[n]+=(0,g.stringFromCodePoint)(a):2097151&s?(this._combined[n]=(0,g.stringFromCodePoint)(2097151&s)+(0,g.stringFromCodePoint)(a),s&=-2097152,s|=2097152):s=a|4194304,i&&(s&=-12582913,s|=i<<22),this._data[3*n+0]=s}insertCells(n,a,i){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),a<this.length-n){const s=new f.CellData;for(let _=this.length-n-a-1;_>=0;--_)this.setCell(n+a+_,this.loadCell(n+_,s));for(let _=0;_<a;++_)this.setCell(n+_,i)}else for(let s=n;s<this.length;++s)this.setCell(s,i);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,i)}deleteCells(n,a,i){if(n%=this.length,a<this.length-n){const s=new f.CellData;for(let _=0;_<this.length-n-a;++_)this.setCell(n+_,this.loadCell(n+a+_,s));for(let _=this.length-a;_<this.length;++_)this.setCell(_,i)}else for(let s=n;s<this.length;++s)this.setCell(s,i);n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodepoint(n,0,1,i)}replaceCells(n,a,i,s=!1){if(s)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodepoint(n-1,0,1,i),a<this.length&&this.getWidth(a-1)===2&&!this.isProtected(a)&&this.setCellFromCodepoint(a,0,1,i);n<a&&n<this.length;)this.isProtected(n)||this.setCell(n,i),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n-1,0,1,i),a<this.length&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a,0,1,i);n<a&&n<this.length;)this.setCell(n++,i)}resize(n,a){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const s=new Uint32Array(i);s.set(this._data),this._data=s}for(let s=this.length;s<n;++s)this.setCell(s,a)}else{this._data=this._data.subarray(0,i);const s=Object.keys(this._combined);for(let S=0;S<s.length;S++){const y=parseInt(s[S],10);y>=n&&delete this._combined[y]}const _=Object.keys(this._extendedAttrs);for(let S=0;S<_.length;S++){const y=parseInt(_[S],10);y>=n&&delete this._extendedAttrs[y]}}return this.length=n,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,a=!1){if(a)for(let i=0;i<this.length;++i)this.isProtected(i)||this.setCell(i,n);else{this._combined={},this._extendedAttrs={};for(let i=0;i<this.length;++i)this.setCell(i,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const a in n._combined)this._combined[a]=n._combined[a];this._extendedAttrs={};for(const a in n._extendedAttrs)this._extendedAttrs[a]=n._extendedAttrs[a];this.isWrapped=n.isWrapped}clone(){const n=new C(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const a in this._combined)n._combined[a]=this._combined[a];for(const a in this._extendedAttrs)n._extendedAttrs[a]=this._extendedAttrs[a];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,a,i,s,_){const S=n._data;if(_)for(let k=s-1;k>=0;k--){for(let m=0;m<3;m++)this._data[3*(i+k)+m]=S[3*(a+k)+m];268435456&S[3*(a+k)+2]&&(this._extendedAttrs[i+k]=n._extendedAttrs[a+k])}else for(let k=0;k<s;k++){for(let m=0;m<3;m++)this._data[3*(i+k)+m]=S[3*(a+k)+m];268435456&S[3*(a+k)+2]&&(this._extendedAttrs[i+k]=n._extendedAttrs[a+k])}const y=Object.keys(n._combined);for(let k=0;k<y.length;k++){const m=parseInt(y[k],10);m>=a&&(this._combined[m-a+i]=n._combined[m])}}translateToString(n,a,i,s){a=a??0,i=i??this.length,n&&(i=Math.min(i,this.getTrimmedLength())),s&&(s.length=0);let _="";for(;a<i;){const S=this._data[3*a+0],y=2097151&S,k=2097152&S?this._combined[a]:y?(0,g.stringFromCodePoint)(y):l.WHITESPACE_CELL_CHAR;if(_+=k,s)for(let m=0;m<k.length;++m)s.push(a);a+=S>>22||1}return s&&s.push(a),_}}t.BufferLine=C},4841:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(o,h){if(o.start.y>o.end.y)throw new Error(`Buffer range end (${o.end.x}, ${o.end.y}) cannot be before start (${o.start.x}, ${o.start.y})`);return h*(o.end.y-o.start.y)+(o.end.x-o.start.x+1)}},4634:(w,t)=>{function o(h,f,l){if(f===h.length-1)return h[f].getTrimmedLength();const g=!h[f].hasContent(l-1)&&h[f].getWidth(l-1)===1,v=h[f+1].getWidth(0)===2;return g&&v?l-1:l}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(h,f,l,g,v){const C=[];for(let p=0;p<h.length-1;p++){let n=p,a=h.get(++n);if(!a.isWrapped)continue;const i=[h.get(p)];for(;n<h.length&&a.isWrapped;)i.push(a),a=h.get(++n);if(g>=p&&g<n){p+=i.length-1;continue}let s=0,_=o(i,s,f),S=1,y=0;for(;S<i.length;){const m=o(i,S,f),E=m-y,R=l-_,B=Math.min(E,R);i[s].copyCellsFrom(i[S],y,_,B,!1),_+=B,_===l&&(s++,_=0),y+=B,y===m&&(S++,y=0),_===0&&s!==0&&i[s-1].getWidth(l-1)===2&&(i[s].copyCellsFrom(i[s-1],l-1,_++,1,!1),i[s-1].setCell(l-1,v))}i[s].replaceCells(_,l,v);let k=0;for(let m=i.length-1;m>0&&(m>s||i[m].getTrimmedLength()===0);m--)k++;k>0&&(C.push(p+i.length-k),C.push(k)),p+=i.length-1}return C},t.reflowLargerCreateNewLayout=function(h,f){const l=[];let g=0,v=f[g],C=0;for(let p=0;p<h.length;p++)if(v===p){const n=f[++g];h.onDeleteEmitter.fire({index:p-C,amount:n}),p+=n-1,C+=n,v=f[++g]}else l.push(p);return{layout:l,countRemoved:C}},t.reflowLargerApplyNewLayout=function(h,f){const l=[];for(let g=0;g<f.length;g++)l.push(h.get(f[g]));for(let g=0;g<l.length;g++)h.set(g,l[g]);h.length=f.length},t.reflowSmallerGetNewLineLengths=function(h,f,l){const g=[],v=h.map((a,i)=>o(h,i,f)).reduce((a,i)=>a+i);let C=0,p=0,n=0;for(;n<v;){if(v-n<l){g.push(v-n);break}C+=l;const a=o(h,p,f);C>a&&(C-=a,p++);const i=h[p].getWidth(C-1)===2;i&&C--;const s=i?l-1:l;g.push(s),n+=s}return g},t.getWrappedLineTrimmedLength=o},5295:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const h=o(8460),f=o(844),l=o(9092);class g extends f.Disposable{constructor(C,p){super(),this._optionsService=C,this._bufferService=p,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new l.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new l.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(C){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(C),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(C,p){this._normal.resize(C,p),this._alt.resize(C,p),this.setupTabStops(C)}setupTabStops(C){this._normal.setupTabStops(C),this._alt.setupTabStops(C)}}t.BufferSet=g},511:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const h=o(482),f=o(643),l=o(3734);class g extends l.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new l.ExtendedAttrs,this.combinedData=""}static fromCharData(C){const p=new g;return p.setFromCharData(C),p}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(C){this.fg=C[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let p=!1;if(C[f.CHAR_DATA_CHAR_INDEX].length>2)p=!0;else if(C[f.CHAR_DATA_CHAR_INDEX].length===2){const n=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const a=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(n-55296)+a-56320+65536|C[f.CHAR_DATA_WIDTH_INDEX]<<22:p=!0}else p=!0}else this.content=C[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|C[f.CHAR_DATA_WIDTH_INDEX]<<22;p&&(this.combinedData=C[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|C[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=g},643:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const h=o(8460),f=o(844);class l{get id(){return this._id}constructor(v){this.line=v,this.isDisposed=!1,this._disposables=[],this._id=l._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(v){return this._disposables.push(v),v}}t.Marker=l,l._nextId=1},7116:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(w,t)=>{var o,h,f;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(l){l.NUL="\0",l.SOH="",l.STX="",l.ETX="",l.EOT="",l.ENQ="",l.ACK="",l.BEL="\x07",l.BS="\b",l.HT="	",l.LF=`
`,l.VT="\v",l.FF="\f",l.CR="\r",l.SO="",l.SI="",l.DLE="",l.DC1="",l.DC2="",l.DC3="",l.DC4="",l.NAK="",l.SYN="",l.ETB="",l.CAN="",l.EM="",l.SUB="",l.ESC="\x1B",l.FS="",l.GS="",l.RS="",l.US="",l.SP=" ",l.DEL=""}(o||(t.C0=o={})),function(l){l.PAD="",l.HOP="",l.BPH="",l.NBH="",l.IND="",l.NEL="",l.SSA="",l.ESA="",l.HTS="",l.HTJ="",l.VTS="",l.PLD="",l.PLU="",l.RI="",l.SS2="",l.SS3="",l.DCS="",l.PU1="",l.PU2="",l.STS="",l.CCH="",l.MW="",l.SPA="",l.EPA="",l.SOS="",l.SGCI="",l.SCI="",l.CSI="",l.ST="",l.OSC="",l.PM="",l.APC=""}(h||(t.C1=h={})),function(l){l.ST=`${o.ESC}\\`}(f||(t.C1_ESCAPED=f={}))},7399:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const h=o(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(l,g,v,C){const p={type:0,cancel:!1,key:void 0},n=(l.shiftKey?1:0)|(l.altKey?2:0)|(l.ctrlKey?4:0)|(l.metaKey?8:0);switch(l.keyCode){case 0:l.key==="UIKeyInputUpArrow"?p.key=g?h.C0.ESC+"OA":h.C0.ESC+"[A":l.key==="UIKeyInputLeftArrow"?p.key=g?h.C0.ESC+"OD":h.C0.ESC+"[D":l.key==="UIKeyInputRightArrow"?p.key=g?h.C0.ESC+"OC":h.C0.ESC+"[C":l.key==="UIKeyInputDownArrow"&&(p.key=g?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:p.key=l.ctrlKey?"\b":h.C0.DEL,l.altKey&&(p.key=h.C0.ESC+p.key);break;case 9:if(l.shiftKey){p.key=h.C0.ESC+"[Z";break}p.key=h.C0.HT,p.cancel=!0;break;case 13:p.key=l.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,p.cancel=!0;break;case 27:p.key=h.C0.ESC,l.altKey&&(p.key=h.C0.ESC+h.C0.ESC),p.cancel=!0;break;case 37:if(l.metaKey)break;n?(p.key=h.C0.ESC+"[1;"+(n+1)+"D",p.key===h.C0.ESC+"[1;3D"&&(p.key=h.C0.ESC+(v?"b":"[1;5D"))):p.key=g?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(l.metaKey)break;n?(p.key=h.C0.ESC+"[1;"+(n+1)+"C",p.key===h.C0.ESC+"[1;3C"&&(p.key=h.C0.ESC+(v?"f":"[1;5C"))):p.key=g?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(l.metaKey)break;n?(p.key=h.C0.ESC+"[1;"+(n+1)+"A",v||p.key!==h.C0.ESC+"[1;3A"||(p.key=h.C0.ESC+"[1;5A")):p.key=g?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(l.metaKey)break;n?(p.key=h.C0.ESC+"[1;"+(n+1)+"B",v||p.key!==h.C0.ESC+"[1;3B"||(p.key=h.C0.ESC+"[1;5B")):p.key=g?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:l.shiftKey||l.ctrlKey||(p.key=h.C0.ESC+"[2~");break;case 46:p.key=n?h.C0.ESC+"[3;"+(n+1)+"~":h.C0.ESC+"[3~";break;case 36:p.key=n?h.C0.ESC+"[1;"+(n+1)+"H":g?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:p.key=n?h.C0.ESC+"[1;"+(n+1)+"F":g?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:l.shiftKey?p.type=2:l.ctrlKey?p.key=h.C0.ESC+"[5;"+(n+1)+"~":p.key=h.C0.ESC+"[5~";break;case 34:l.shiftKey?p.type=3:l.ctrlKey?p.key=h.C0.ESC+"[6;"+(n+1)+"~":p.key=h.C0.ESC+"[6~";break;case 112:p.key=n?h.C0.ESC+"[1;"+(n+1)+"P":h.C0.ESC+"OP";break;case 113:p.key=n?h.C0.ESC+"[1;"+(n+1)+"Q":h.C0.ESC+"OQ";break;case 114:p.key=n?h.C0.ESC+"[1;"+(n+1)+"R":h.C0.ESC+"OR";break;case 115:p.key=n?h.C0.ESC+"[1;"+(n+1)+"S":h.C0.ESC+"OS";break;case 116:p.key=n?h.C0.ESC+"[15;"+(n+1)+"~":h.C0.ESC+"[15~";break;case 117:p.key=n?h.C0.ESC+"[17;"+(n+1)+"~":h.C0.ESC+"[17~";break;case 118:p.key=n?h.C0.ESC+"[18;"+(n+1)+"~":h.C0.ESC+"[18~";break;case 119:p.key=n?h.C0.ESC+"[19;"+(n+1)+"~":h.C0.ESC+"[19~";break;case 120:p.key=n?h.C0.ESC+"[20;"+(n+1)+"~":h.C0.ESC+"[20~";break;case 121:p.key=n?h.C0.ESC+"[21;"+(n+1)+"~":h.C0.ESC+"[21~";break;case 122:p.key=n?h.C0.ESC+"[23;"+(n+1)+"~":h.C0.ESC+"[23~";break;case 123:p.key=n?h.C0.ESC+"[24;"+(n+1)+"~":h.C0.ESC+"[24~";break;default:if(!l.ctrlKey||l.shiftKey||l.altKey||l.metaKey)if(v&&!C||!l.altKey||l.metaKey)!v||l.altKey||l.ctrlKey||l.shiftKey||!l.metaKey?l.key&&!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.keyCode>=48&&l.key.length===1?p.key=l.key:l.key&&l.ctrlKey&&(l.key==="_"&&(p.key=h.C0.US),l.key==="@"&&(p.key=h.C0.NUL)):l.keyCode===65&&(p.type=1);else{const a=f[l.keyCode],i=a==null?void 0:a[l.shiftKey?1:0];if(i)p.key=h.C0.ESC+i;else if(l.keyCode>=65&&l.keyCode<=90){const s=l.ctrlKey?l.keyCode-64:l.keyCode+32;let _=String.fromCharCode(s);l.shiftKey&&(_=_.toUpperCase()),p.key=h.C0.ESC+_}else if(l.keyCode===32)p.key=h.C0.ESC+(l.ctrlKey?h.C0.NUL:" ");else if(l.key==="Dead"&&l.code.startsWith("Key")){let s=l.code.slice(3,4);l.shiftKey||(s=s.toLowerCase()),p.key=h.C0.ESC+s,p.cancel=!0}}else l.keyCode>=65&&l.keyCode<=90?p.key=String.fromCharCode(l.keyCode-64):l.keyCode===32?p.key=h.C0.NUL:l.keyCode>=51&&l.keyCode<=55?p.key=String.fromCharCode(l.keyCode-51+27):l.keyCode===56?p.key=h.C0.DEL:l.keyCode===219?p.key=h.C0.ESC:l.keyCode===220?p.key=h.C0.FS:l.keyCode===221&&(p.key=h.C0.GS)}return p}},482:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(o){return o>65535?(o-=65536,String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):String.fromCharCode(o)},t.utf32ToString=function(o,h=0,f=o.length){let l="";for(let g=h;g<f;++g){let v=o[g];v>65535?(v-=65536,l+=String.fromCharCode(55296+(v>>10))+String.fromCharCode(v%1024+56320)):l+=String.fromCharCode(v)}return l},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(o,h){const f=o.length;if(!f)return 0;let l=0,g=0;if(this._interim){const v=o.charCodeAt(g++);56320<=v&&v<=57343?h[l++]=1024*(this._interim-55296)+v-56320+65536:(h[l++]=this._interim,h[l++]=v),this._interim=0}for(let v=g;v<f;++v){const C=o.charCodeAt(v);if(55296<=C&&C<=56319){if(++v>=f)return this._interim=C,l;const p=o.charCodeAt(v);56320<=p&&p<=57343?h[l++]=1024*(C-55296)+p-56320+65536:(h[l++]=C,h[l++]=p)}else C!==65279&&(h[l++]=C)}return l}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(o,h){const f=o.length;if(!f)return 0;let l,g,v,C,p=0,n=0,a=0;if(this.interim[0]){let _=!1,S=this.interim[0];S&=(224&S)==192?31:(240&S)==224?15:7;let y,k=0;for(;(y=63&this.interim[++k])&&k<4;)S<<=6,S|=y;const m=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=m-k;for(;a<E;){if(a>=f)return 0;if(y=o[a++],(192&y)!=128){a--,_=!0;break}this.interim[k++]=y,S<<=6,S|=63&y}_||(m===2?S<128?a--:h[p++]=S:m===3?S<2048||S>=55296&&S<=57343||S===65279||(h[p++]=S):S<65536||S>1114111||(h[p++]=S)),this.interim.fill(0)}const i=f-4;let s=a;for(;s<f;){for(;!(!(s<i)||128&(l=o[s])||128&(g=o[s+1])||128&(v=o[s+2])||128&(C=o[s+3]));)h[p++]=l,h[p++]=g,h[p++]=v,h[p++]=C,s+=4;if(l=o[s++],l<128)h[p++]=l;else if((224&l)==192){if(s>=f)return this.interim[0]=l,p;if(g=o[s++],(192&g)!=128){s--;continue}if(n=(31&l)<<6|63&g,n<128){s--;continue}h[p++]=n}else if((240&l)==224){if(s>=f)return this.interim[0]=l,p;if(g=o[s++],(192&g)!=128){s--;continue}if(s>=f)return this.interim[0]=l,this.interim[1]=g,p;if(v=o[s++],(192&v)!=128){s--;continue}if(n=(15&l)<<12|(63&g)<<6|63&v,n<2048||n>=55296&&n<=57343||n===65279)continue;h[p++]=n}else if((248&l)==240){if(s>=f)return this.interim[0]=l,p;if(g=o[s++],(192&g)!=128){s--;continue}if(s>=f)return this.interim[0]=l,this.interim[1]=g,p;if(v=o[s++],(192&v)!=128){s--;continue}if(s>=f)return this.interim[0]=l,this.interim[1]=g,this.interim[2]=v,p;if(C=o[s++],(192&C)!=128){s--;continue}if(n=(7&l)<<18|(63&g)<<12|(63&v)<<6|63&C,n<65536||n>1114111)continue;h[p++]=n}}return p}}},225:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const h=o(1480),f=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let g;t.UnicodeV6=class{constructor(){if(this.version="6",!g){g=new Uint8Array(65536),g.fill(1),g[0]=0,g.fill(0,1,32),g.fill(0,127,160),g.fill(2,4352,4448),g[9001]=2,g[9002]=2,g.fill(2,11904,42192),g[12351]=1,g.fill(2,44032,55204),g.fill(2,63744,64256),g.fill(2,65040,65050),g.fill(2,65072,65136),g.fill(2,65280,65377),g.fill(2,65504,65511);for(let v=0;v<f.length;++v)g.fill(0,f[v][0],f[v][1]+1)}}wcwidth(v){return v<32?0:v<127?1:v<65536?g[v]:function(C,p){let n,a=0,i=p.length-1;if(C<p[0][0]||C>p[i][1])return!1;for(;i>=a;)if(n=a+i>>1,C>p[n][1])a=n+1;else{if(!(C<p[n][0]))return!0;i=n-1}return!1}(v,l)?0:v>=131072&&v<=196605||v>=196608&&v<=262141?2:1}charProperties(v,C){let p=this.wcwidth(v),n=p===0&&C!==0;if(n){const a=h.UnicodeService.extractWidth(C);a===0?n=!1:a>p&&(p=a)}return h.UnicodeService.createPropertyValue(0,p,n)}}},5981:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const h=o(8460),f=o(844);class l extends f.Disposable{constructor(v){super(),this._action=v,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(v,C){if(C!==void 0&&this._syncCalls>C)return void(this._syncCalls=0);if(this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let p;for(this._isSyncWriting=!0;p=this._writeBuffer.shift();){this._action(p);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(v,C){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(C),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(C)}_innerWrite(v=0,C=!0){const p=v||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],a=this._action(n,C);if(a){const s=_=>Date.now()-p>=12?setTimeout(()=>this._innerWrite(0,_)):this._innerWrite(p,_);return void a.catch(_=>(queueMicrotask(()=>{throw _}),Promise.resolve(!1))).then(s)}const i=this._callbacks[this._bufferOffset];if(i&&i(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-p>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=l},5941:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const o=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function f(l,g){const v=l.toString(16),C=v.length<2?"0"+v:v;switch(g){case 4:return v[0];case 8:return C;case 12:return(C+C).slice(0,3);default:return C+C}}t.parseColor=function(l){if(!l)return;let g=l.toLowerCase();if(g.indexOf("rgb:")===0){g=g.slice(4);const v=o.exec(g);if(v){const C=v[1]?15:v[4]?255:v[7]?4095:65535;return[Math.round(parseInt(v[1]||v[4]||v[7]||v[10],16)/C*255),Math.round(parseInt(v[2]||v[5]||v[8]||v[11],16)/C*255),Math.round(parseInt(v[3]||v[6]||v[9]||v[12],16)/C*255)]}}else if(g.indexOf("#")===0&&(g=g.slice(1),h.exec(g)&&[3,6,9,12].includes(g.length))){const v=g.length/3,C=[0,0,0];for(let p=0;p<3;++p){const n=parseInt(g.slice(v*p,v*p+v),16);C[p]=v===1?n<<4:v===2?n:v===3?n>>4:n>>8}return C}},t.toRgbString=function(l,g=16){const[v,C,p]=l;return`rgb:${f(v,g)}/${f(C,g)}/${f(p,g)}`}},5770:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const h=o(482),f=o(8742),l=o(5770),g=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=g,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=g}registerHandler(C,p){this._handlers[C]===void 0&&(this._handlers[C]=[]);const n=this._handlers[C];return n.push(p),{dispose:()=>{const a=n.indexOf(p);a!==-1&&n.splice(a,1)}}}clearHandler(C){this._handlers[C]&&delete this._handlers[C]}setHandlerFallback(C){this._handlerFb=C}reset(){if(this._active.length)for(let C=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;C>=0;--C)this._active[C].unhook(!1);this._stack.paused=!1,this._active=g,this._ident=0}hook(C,p){if(this.reset(),this._ident=C,this._active=this._handlers[C]||g,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(p);else this._handlerFb(this._ident,"HOOK",p)}put(C,p,n){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(C,p,n);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(C,p,n))}unhook(C,p=!0){if(this._active.length){let n=!1,a=this._active.length-1,i=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,n=p,i=this._stack.fallThrough,this._stack.paused=!1),!i&&n===!1){for(;a>=0&&(n=this._active[a].unhook(C),n!==!0);a--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,n;a--}for(;a>=0;a--)if(n=this._active[a].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",C);this._active=g,this._ident=0}};const v=new f.Params;v.addParam(0),t.DcsHandler=class{constructor(C){this._handler=C,this._data="",this._params=v,this._hitLimit=!1}hook(C){this._params=C.length>1||C.params[0]?C.clone():v,this._data="",this._hitLimit=!1}put(C,p,n){this._hitLimit||(this._data+=(0,h.utf32ToString)(C,p,n),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(C){let p=!1;if(this._hitLimit)p=!1;else if(C&&(p=this._handler(this._data,this._params),p instanceof Promise))return p.then(n=>(this._params=v,this._data="",this._hitLimit=!1,n));return this._params=v,this._data="",this._hitLimit=!1,p}}},2015:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const h=o(844),f=o(8742),l=o(6242),g=o(6351);class v{constructor(a){this.table=new Uint8Array(a)}setDefault(a,i){this.table.fill(a<<4|i)}add(a,i,s,_){this.table[i<<8|a]=s<<4|_}addMany(a,i,s,_){for(let S=0;S<a.length;S++)this.table[i<<8|a[S]]=s<<4|_}}t.TransitionTable=v;const C=160;t.VT500_TRANSITION_TABLE=function(){const n=new v(4095),a=Array.apply(null,Array(256)).map((k,m)=>m),i=(k,m)=>a.slice(k,m),s=i(32,127),_=i(0,24);_.push(25),_.push.apply(_,i(28,32));const S=i(0,14);let y;for(y in n.setDefault(1,0),n.addMany(s,0,2,0),S)n.addMany([24,26,153,154],y,3,0),n.addMany(i(128,144),y,3,0),n.addMany(i(144,152),y,3,0),n.add(156,y,0,0),n.add(27,y,11,1),n.add(157,y,4,8),n.addMany([152,158,159],y,0,7),n.add(155,y,11,3),n.add(144,y,11,9);return n.addMany(_,0,3,0),n.addMany(_,1,3,1),n.add(127,1,0,1),n.addMany(_,8,0,8),n.addMany(_,3,3,3),n.add(127,3,0,3),n.addMany(_,4,3,4),n.add(127,4,0,4),n.addMany(_,6,3,6),n.addMany(_,5,3,5),n.add(127,5,0,5),n.addMany(_,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(s,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(i(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(s,7,0,7),n.addMany(_,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(i(64,127),3,7,0),n.addMany(i(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(i(48,60),4,8,4),n.addMany(i(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(i(32,64),6,0,6),n.add(127,6,0,6),n.addMany(i(64,127),6,0,0),n.addMany(i(32,48),3,9,5),n.addMany(i(32,48),5,9,5),n.addMany(i(48,64),5,0,6),n.addMany(i(64,127),5,7,0),n.addMany(i(32,48),4,9,5),n.addMany(i(32,48),1,9,2),n.addMany(i(32,48),2,9,2),n.addMany(i(48,127),2,10,0),n.addMany(i(48,80),1,10,0),n.addMany(i(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(i(96,127),1,10,0),n.add(80,1,11,9),n.addMany(_,9,0,9),n.add(127,9,0,9),n.addMany(i(28,32),9,0,9),n.addMany(i(32,48),9,9,12),n.addMany(i(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(_,11,0,11),n.addMany(i(32,128),11,0,11),n.addMany(i(28,32),11,0,11),n.addMany(_,10,0,10),n.add(127,10,0,10),n.addMany(i(28,32),10,0,10),n.addMany(i(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(i(32,48),10,9,12),n.addMany(_,12,0,12),n.add(127,12,0,12),n.addMany(i(28,32),12,0,12),n.addMany(i(32,48),12,9,12),n.addMany(i(48,64),12,0,11),n.addMany(i(64,127),12,12,13),n.addMany(i(64,127),10,12,13),n.addMany(i(64,127),9,12,13),n.addMany(_,13,13,13),n.addMany(s,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(C,0,2,0),n.add(C,8,5,8),n.add(C,6,0,6),n.add(C,11,0,11),n.add(C,13,13,13),n}();class p extends h.Disposable{constructor(a=t.VT500_TRANSITION_TABLE){super(),this._transitions=a,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(i,s,_)=>{},this._executeHandlerFb=i=>{},this._csiHandlerFb=(i,s)=>{},this._escHandlerFb=i=>{},this._errorHandlerFb=i=>i,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new l.OscParser),this._dcsParser=this.register(new g.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(a,i=[64,126]){let s=0;if(a.prefix){if(a.prefix.length>1)throw new Error("only one byte as prefix supported");if(s=a.prefix.charCodeAt(0),s&&60>s||s>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(a.intermediates){if(a.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let S=0;S<a.intermediates.length;++S){const y=a.intermediates.charCodeAt(S);if(32>y||y>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");s<<=8,s|=y}}if(a.final.length!==1)throw new Error("final must be a single byte");const _=a.final.charCodeAt(0);if(i[0]>_||_>i[1])throw new Error(`final must be in range ${i[0]} .. ${i[1]}`);return s<<=8,s|=_,s}identToString(a){const i=[];for(;a;)i.push(String.fromCharCode(255&a)),a>>=8;return i.reverse().join("")}setPrintHandler(a){this._printHandler=a}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(a,i){const s=this._identifier(a,[48,126]);this._escHandlers[s]===void 0&&(this._escHandlers[s]=[]);const _=this._escHandlers[s];return _.push(i),{dispose:()=>{const S=_.indexOf(i);S!==-1&&_.splice(S,1)}}}clearEscHandler(a){this._escHandlers[this._identifier(a,[48,126])]&&delete this._escHandlers[this._identifier(a,[48,126])]}setEscHandlerFallback(a){this._escHandlerFb=a}setExecuteHandler(a,i){this._executeHandlers[a.charCodeAt(0)]=i}clearExecuteHandler(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]}setExecuteHandlerFallback(a){this._executeHandlerFb=a}registerCsiHandler(a,i){const s=this._identifier(a);this._csiHandlers[s]===void 0&&(this._csiHandlers[s]=[]);const _=this._csiHandlers[s];return _.push(i),{dispose:()=>{const S=_.indexOf(i);S!==-1&&_.splice(S,1)}}}clearCsiHandler(a){this._csiHandlers[this._identifier(a)]&&delete this._csiHandlers[this._identifier(a)]}setCsiHandlerFallback(a){this._csiHandlerFb=a}registerDcsHandler(a,i){return this._dcsParser.registerHandler(this._identifier(a),i)}clearDcsHandler(a){this._dcsParser.clearHandler(this._identifier(a))}setDcsHandlerFallback(a){this._dcsParser.setHandlerFallback(a)}registerOscHandler(a,i){return this._oscParser.registerHandler(a,i)}clearOscHandler(a){this._oscParser.clearHandler(a)}setOscHandlerFallback(a){this._oscParser.setHandlerFallback(a)}setErrorHandler(a){this._errorHandler=a}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(a,i,s,_,S){this._parseStack.state=a,this._parseStack.handlers=i,this._parseStack.handlerPos=s,this._parseStack.transition=_,this._parseStack.chunkPos=S}parse(a,i,s){let _,S=0,y=0,k=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,k=this._parseStack.chunkPos+1;else{if(s===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const m=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(s===!1&&E>-1){for(;E>=0&&(_=m[E](this._params),_!==!0);E--)if(_ instanceof Promise)return this._parseStack.handlerPos=E,_}this._parseStack.handlers=[];break;case 4:if(s===!1&&E>-1){for(;E>=0&&(_=m[E](),_!==!0);E--)if(_ instanceof Promise)return this._parseStack.handlerPos=E,_}this._parseStack.handlers=[];break;case 6:if(S=a[this._parseStack.chunkPos],_=this._dcsParser.unhook(S!==24&&S!==26,s),_)return _;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(S=a[this._parseStack.chunkPos],_=this._oscParser.end(S!==24&&S!==26,s),_)return _;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,k=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let m=k;m<i;++m){switch(S=a[m],y=this._transitions.table[this.currentState<<8|(S<160?S:C)],y>>4){case 2:for(let A=m+1;;++A){if(A>=i||(S=a[A])<32||S>126&&S<C){this._printHandler(a,m,A),m=A-1;break}if(++A>=i||(S=a[A])<32||S>126&&S<C){this._printHandler(a,m,A),m=A-1;break}if(++A>=i||(S=a[A])<32||S>126&&S<C){this._printHandler(a,m,A),m=A-1;break}if(++A>=i||(S=a[A])<32||S>126&&S<C){this._printHandler(a,m,A),m=A-1;break}}break;case 3:this._executeHandlers[S]?this._executeHandlers[S]():this._executeHandlerFb(S),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:m,code:S,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|S];let R=E?E.length-1:-1;for(;R>=0&&(_=E[R](this._params),_!==!0);R--)if(_ instanceof Promise)return this._preserveStack(3,E,R,y,m),_;R<0&&this._csiHandlerFb(this._collect<<8|S,this._params),this.precedingJoinState=0;break;case 8:do switch(S){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(S-48)}while(++m<i&&(S=a[m])>47&&S<60);m--;break;case 9:this._collect<<=8,this._collect|=S;break;case 10:const B=this._escHandlers[this._collect<<8|S];let O=B?B.length-1:-1;for(;O>=0&&(_=B[O](),_!==!0);O--)if(_ instanceof Promise)return this._preserveStack(4,B,O,y,m),_;O<0&&this._escHandlerFb(this._collect<<8|S),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|S,this._params);break;case 13:for(let A=m+1;;++A)if(A>=i||(S=a[A])===24||S===26||S===27||S>127&&S<C){this._dcsParser.put(a,m,A),m=A-1;break}break;case 14:if(_=this._dcsParser.unhook(S!==24&&S!==26),_)return this._preserveStack(6,[],0,y,m),_;S===27&&(y|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let A=m+1;;A++)if(A>=i||(S=a[A])<32||S>127&&S<C){this._oscParser.put(a,m,A),m=A-1;break}break;case 6:if(_=this._oscParser.end(S!==24&&S!==26),_)return this._preserveStack(5,[],0,y,m),_;S===27&&(y|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&y}}}t.EscapeSequenceParser=p},6242:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const h=o(5770),f=o(482),l=[];t.OscParser=class{constructor(){this._state=0,this._active=l,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(g,v){this._handlers[g]===void 0&&(this._handlers[g]=[]);const C=this._handlers[g];return C.push(v),{dispose:()=>{const p=C.indexOf(v);p!==-1&&C.splice(p,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=l}reset(){if(this._state===2)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].end(!1);this._stack.paused=!1,this._active=l,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||l,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].start();else this._handlerFb(this._id,"START")}_put(g,v,C){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(g,v,C);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(g,v,C))}start(){this.reset(),this._state=1}put(g,v,C){if(this._state!==3){if(this._state===1)for(;v<C;){const p=g[v++];if(p===59){this._state=2,this._start();break}if(p<48||57<p)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+p-48}this._state===2&&C-v>0&&this._put(g,v,C)}}end(g,v=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let C=!1,p=this._active.length-1,n=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,C=v,n=this._stack.fallThrough,this._stack.paused=!1),!n&&C===!1){for(;p>=0&&(C=this._active[p].end(g),C!==!0);p--)if(C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,C;p--}for(;p>=0;p--)if(C=this._active[p].end(!1),C instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,C}else this._handlerFb(this._id,"END",g);this._active=l,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(g){this._handler=g,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(g,v,C){this._hitLimit||(this._data+=(0,f.utf32ToString)(g,v,C),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(g){let v=!1;if(this._hitLimit)v=!1;else if(g&&(v=this._handler(this._data),v instanceof Promise))return v.then(C=>(this._data="",this._hitLimit=!1,C));return this._data="",this._hitLimit=!1,v}}},8742:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const o=2147483647;class h{static fromArray(l){const g=new h;if(!l.length)return g;for(let v=Array.isArray(l[0])?1:0;v<l.length;++v){const C=l[v];if(Array.isArray(C))for(let p=0;p<C.length;++p)g.addSubParam(C[p]);else g.addParam(C)}return g}constructor(l=32,g=32){if(this.maxLength=l,this.maxSubParamsLength=g,g>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(l),this.length=0,this._subParams=new Int32Array(g),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(l),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const l=new h(this.maxLength,this.maxSubParamsLength);return l.params.set(this.params),l.length=this.length,l._subParams.set(this._subParams),l._subParamsLength=this._subParamsLength,l._subParamsIdx.set(this._subParamsIdx),l._rejectDigits=this._rejectDigits,l._rejectSubDigits=this._rejectSubDigits,l._digitIsSub=this._digitIsSub,l}toArray(){const l=[];for(let g=0;g<this.length;++g){l.push(this.params[g]);const v=this._subParamsIdx[g]>>8,C=255&this._subParamsIdx[g];C-v>0&&l.push(Array.prototype.slice.call(this._subParams,v,C))}return l}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(l){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=l>o?o:l}}addSubParam(l){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(l<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=l>o?o:l,this._subParamsIdx[this.length-1]++}}hasSubParams(l){return(255&this._subParamsIdx[l])-(this._subParamsIdx[l]>>8)>0}getSubParams(l){const g=this._subParamsIdx[l]>>8,v=255&this._subParamsIdx[l];return v-g>0?this._subParams.subarray(g,v):null}getSubParamsAll(){const l={};for(let g=0;g<this.length;++g){const v=this._subParamsIdx[g]>>8,C=255&this._subParamsIdx[g];C-v>0&&(l[g]=this._subParams.slice(v,C))}return l}addDigit(l){let g;if(this._rejectDigits||!(g=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const v=this._digitIsSub?this._subParams:this.params,C=v[g-1];v[g-1]=~C?Math.min(10*C+l,o):l}}t.Params=h},5741:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let o=this._addons.length-1;o>=0;o--)this._addons[o].instance.dispose()}loadAddon(o,h){const f={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(f),h.dispose=()=>this._wrappedAddonDispose(f),h.activate(o)}_wrappedAddonDispose(o){if(o.isDisposed)return;let h=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===o){h=f;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");o.isDisposed=!0,o.dispose.apply(o.instance),this._addons.splice(h,1)}}},8771:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const h=o(3785),f=o(511);t.BufferApiView=class{constructor(l,g){this._buffer=l,this.type=g}init(l){return this._buffer=l,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(l){const g=this._buffer.lines.get(l);if(g)return new h.BufferLineApiView(g)}getNullCell(){return new f.CellData}}},3785:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const h=o(511);t.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,l){if(!(f<0||f>=this._line.length))return l?(this._line.loadCell(f,l),l):this._line.loadCell(f,new h.CellData)}translateToString(f,l,g){return this._line.translateToString(f,l,g)}}},8285:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const h=o(8771),f=o(8460),l=o(844);class g extends l.Disposable{constructor(C){super(),this._core=C,this._onBufferChange=this.register(new f.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}t.BufferNamespaceApi=g},7975:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(o){this._core=o}registerCsiHandler(o,h){return this._core.registerCsiHandler(o,f=>h(f.toArray()))}addCsiHandler(o,h){return this.registerCsiHandler(o,h)}registerDcsHandler(o,h){return this._core.registerDcsHandler(o,(f,l)=>h(f,l.toArray()))}addDcsHandler(o,h){return this.registerDcsHandler(o,h)}registerEscHandler(o,h){return this._core.registerEscHandler(o,h)}addEscHandler(o,h){return this.registerEscHandler(o,h)}registerOscHandler(o,h){return this._core.registerOscHandler(o,h)}addOscHandler(o,h){return this.registerOscHandler(o,h)}}},7090:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(o){this._core=o}register(o){this._core.unicodeService.register(o)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(o){this._core.unicodeService.activeVersion=o}}},744:function(w,t,o){var h=this&&this.__decorate||function(n,a,i,s){var _,S=arguments.length,y=S<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,a,i,s);else for(var k=n.length-1;k>=0;k--)(_=n[k])&&(y=(S<3?_(y):S>3?_(a,i,y):_(a,i))||y);return S>3&&y&&Object.defineProperty(a,i,y),y},f=this&&this.__param||function(n,a){return function(i,s){a(i,s,n)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const l=o(8460),g=o(844),v=o(5295),C=o(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let p=t.BufferService=class extends g.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new l.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new l.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new v.BufferSet(n,this))}resize(n,a){this.cols=n,this.rows=a,this.buffers.resize(n,a),this._onResize.fire({cols:n,rows:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,a=!1){const i=this.buffer;let s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===n.fg&&s.getBg(0)===n.bg||(s=i.getBlankLine(n,a),this._cachedBlankLine=s),s.isWrapped=a;const _=i.ybase+i.scrollTop,S=i.ybase+i.scrollBottom;if(i.scrollTop===0){const y=i.lines.isFull;S===i.lines.length-1?y?i.lines.recycle().copyFrom(s):i.lines.push(s.clone()):i.lines.splice(S+1,0,s.clone()),y?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const y=S-_+1;i.lines.shiftElements(_+1,y-1,-1),i.lines.set(S,s.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(n,a,i){const s=this.buffer;if(n<0){if(s.ydisp===0)return;this.isUserScrolling=!0}else n+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);const _=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+n,s.ybase),0),_!==s.ydisp&&(a||this._onScroll.fire(s.ydisp))}};t.BufferService=p=h([f(0,C.IOptionsService)],p)},7994:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(o){this.glevel=o,this.charset=this._charsets[o]}setgCharset(o,h){this._charsets[o]=h,this.glevel===o&&(this.charset=h)}}},1753:function(w,t,o){var h=this&&this.__decorate||function(s,_,S,y){var k,m=arguments.length,E=m<3?_:y===null?y=Object.getOwnPropertyDescriptor(_,S):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(s,_,S,y);else for(var R=s.length-1;R>=0;R--)(k=s[R])&&(E=(m<3?k(E):m>3?k(_,S,E):k(_,S))||E);return m>3&&E&&Object.defineProperty(_,S,E),E},f=this&&this.__param||function(s,_){return function(S,y){_(S,y,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const l=o(2585),g=o(8460),v=o(844),C={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:s=>s.button!==4&&s.action===1&&(s.ctrl=!1,s.alt=!1,s.shift=!1,!0)},VT200:{events:19,restrict:s=>s.action!==32},DRAG:{events:23,restrict:s=>s.action!==32||s.button!==3},ANY:{events:31,restrict:s=>!0}};function p(s,_){let S=(s.ctrl?16:0)|(s.shift?4:0)|(s.alt?8:0);return s.button===4?(S|=64,S|=s.action):(S|=3&s.button,4&s.button&&(S|=64),8&s.button&&(S|=128),s.action===32?S|=32:s.action!==0||_||(S|=3)),S}const n=String.fromCharCode,a={DEFAULT:s=>{const _=[p(s,!1)+32,s.col+32,s.row+32];return _[0]>255||_[1]>255||_[2]>255?"":`\x1B[M${n(_[0])}${n(_[1])}${n(_[2])}`},SGR:s=>{const _=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${p(s,!0)};${s.col};${s.row}${_}`},SGR_PIXELS:s=>{const _=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${p(s,!0)};${s.x};${s.y}${_}`}};let i=t.CoreMouseService=class extends v.Disposable{constructor(s,_){super(),this._bufferService=s,this._coreService=_,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new g.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const S of Object.keys(C))this.addProtocol(S,C[S]);for(const S of Object.keys(a))this.addEncoding(S,a[S]);this.reset()}addProtocol(s,_){this._protocols[s]=_}addEncoding(s,_){this._encodings[s]=_}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(s){if(!this._protocols[s])throw new Error(`unknown protocol "${s}"`);this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(s){if(!this._encodings[s])throw new Error(`unknown encoding "${s}"`);this._activeEncoding=s}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,s,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(s))return!1;const _=this._encodings[this._activeEncoding](s);return _&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(_):this._coreService.triggerDataEvent(_,!0)),this._lastEvent=s,!0}explainEvents(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}}_equalEvents(s,_,S){if(S){if(s.x!==_.x||s.y!==_.y)return!1}else if(s.col!==_.col||s.row!==_.row)return!1;return s.button===_.button&&s.action===_.action&&s.ctrl===_.ctrl&&s.alt===_.alt&&s.shift===_.shift}};t.CoreMouseService=i=h([f(0,l.IBufferService),f(1,l.ICoreService)],i)},6975:function(w,t,o){var h=this&&this.__decorate||function(i,s,_,S){var y,k=arguments.length,m=k<3?s:S===null?S=Object.getOwnPropertyDescriptor(s,_):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(i,s,_,S);else for(var E=i.length-1;E>=0;E--)(y=i[E])&&(m=(k<3?y(m):k>3?y(s,_,m):y(s,_))||m);return k>3&&m&&Object.defineProperty(s,_,m),m},f=this&&this.__param||function(i,s){return function(_,S){s(_,S,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const l=o(1439),g=o(8460),v=o(844),C=o(2585),p=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let a=t.CoreService=class extends v.Disposable{constructor(i,s,_){super(),this._bufferService=i,this._logService=s,this._optionsService=_,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new g.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new g.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,l.clone)(p),this.decPrivateModes=(0,l.clone)(n)}reset(){this.modes=(0,l.clone)(p),this.decPrivateModes=(0,l.clone)(n)}triggerDataEvent(i,s=!1){if(this._optionsService.rawOptions.disableStdin)return;const _=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&_.ybase!==_.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${i}"`,()=>i.split("").map(S=>S.charCodeAt(0))),this._onData.fire(i)}triggerBinaryEvent(i){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${i}"`,()=>i.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(i))}};t.CoreService=a=h([f(0,C.IBufferService),f(1,C.ILogService),f(2,C.IOptionsService)],a)},9074:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const h=o(8055),f=o(8460),l=o(844),g=o(6106);let v=0,C=0;class p extends l.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new g.SortedList(i=>i==null?void 0:i.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,l.toDisposable)(()=>this.reset()))}registerDecoration(i){if(i.marker.isDisposed)return;const s=new n(i);if(s){const _=s.marker.onDispose(()=>s.dispose());s.onDispose(()=>{s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),_.dispose())}),this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(const i of this._decorations.values())i.dispose();this._decorations.clear()}*getDecorationsAtCell(i,s,_){let S=0,y=0;for(const k of this._decorations.getKeyIterator(s))S=k.options.x??0,y=S+(k.options.width??1),i>=S&&i<y&&(!_||(k.options.layer??"bottom")===_)&&(yield k)}forEachDecorationAtCell(i,s,_,S){this._decorations.forEachByKey(s,y=>{v=y.options.x??0,C=v+(y.options.width??1),i>=v&&i<C&&(!_||(y.options.layer??"bottom")===_)&&S(y)})}}t.DecorationService=p;class n extends l.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(i){super(),this.options=i,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=i.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const h=o(2585),f=o(8343);class l{constructor(...v){this._entries=new Map;for(const[C,p]of v)this.set(C,p)}set(v,C){const p=this._entries.get(v);return this._entries.set(v,C),p}forEach(v){for(const[C,p]of this._entries.entries())v(C,p)}has(v){return this._entries.has(v)}get(v){return this._entries.get(v)}}t.ServiceCollection=l,t.InstantiationService=class{constructor(){this._services=new l,this._services.set(h.IInstantiationService,this)}setService(g,v){this._services.set(g,v)}getService(g){return this._services.get(g)}createInstance(g,...v){const C=(0,f.getServiceDependencies)(g).sort((a,i)=>a.index-i.index),p=[];for(const a of C){const i=this._services.get(a.id);if(!i)throw new Error(`[createInstance] ${g.name} depends on UNKNOWN service ${a.id}.`);p.push(i)}const n=C.length>0?C[0].index:v.length;if(v.length!==n)throw new Error(`[createInstance] First service dependency of ${g.name} at position ${n+1} conflicts with ${v.length} static arguments`);return new g(...v,...p)}}},7866:function(w,t,o){var h=this&&this.__decorate||function(n,a,i,s){var _,S=arguments.length,y=S<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,a,i,s);else for(var k=n.length-1;k>=0;k--)(_=n[k])&&(y=(S<3?_(y):S>3?_(a,i,y):_(a,i))||y);return S>3&&y&&Object.defineProperty(a,i,y),y},f=this&&this.__param||function(n,a){return function(i,s){a(i,s,n)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;const l=o(844),g=o(2585),v={trace:g.LogLevelEnum.TRACE,debug:g.LogLevelEnum.DEBUG,info:g.LogLevelEnum.INFO,warn:g.LogLevelEnum.WARN,error:g.LogLevelEnum.ERROR,off:g.LogLevelEnum.OFF};let C,p=t.LogService=class extends l.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=g.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),C=this}_updateLogLevel(){this._logLevel=v[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let a=0;a<n.length;a++)typeof n[a]=="function"&&(n[a]=n[a]())}_log(n,a,i){this._evalLazyOptionalParams(i),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+a,...i)}trace(n,...a){var i;this._logLevel<=g.LogLevelEnum.TRACE&&this._log(((i=this._optionsService.options.logger)==null?void 0:i.trace.bind(this._optionsService.options.logger))??console.log,n,a)}debug(n,...a){var i;this._logLevel<=g.LogLevelEnum.DEBUG&&this._log(((i=this._optionsService.options.logger)==null?void 0:i.debug.bind(this._optionsService.options.logger))??console.log,n,a)}info(n,...a){var i;this._logLevel<=g.LogLevelEnum.INFO&&this._log(((i=this._optionsService.options.logger)==null?void 0:i.info.bind(this._optionsService.options.logger))??console.info,n,a)}warn(n,...a){var i;this._logLevel<=g.LogLevelEnum.WARN&&this._log(((i=this._optionsService.options.logger)==null?void 0:i.warn.bind(this._optionsService.options.logger))??console.warn,n,a)}error(n,...a){var i;this._logLevel<=g.LogLevelEnum.ERROR&&this._log(((i=this._optionsService.options.logger)==null?void 0:i.error.bind(this._optionsService.options.logger))??console.error,n,a)}};t.LogService=p=h([f(0,g.IOptionsService)],p),t.setTraceLogger=function(n){C=n},t.traceCall=function(n,a,i){if(typeof i.value!="function")throw new Error("not supported");const s=i.value;i.value=function(..._){if(C.logLevel!==g.LogLevelEnum.TRACE)return s.apply(this,_);C.trace(`GlyphRenderer#${s.name}(${_.map(y=>JSON.stringify(y)).join(", ")})`);const S=s.apply(this,_);return C.trace(`GlyphRenderer#${s.name} return`,S),S}}},7302:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const h=o(8460),f=o(844),l=o(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:l.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const g=["normal","bold","100","200","300","400","500","600","700","800","900"];class v extends f.Disposable{constructor(p){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n={...t.DEFAULT_OPTIONS};for(const a in p)if(a in n)try{const i=p[a];n[a]=this._sanitizeAndValidateOption(a,i)}catch(i){console.error(i)}this.rawOptions=n,this.options={...n},this._setupOptions(),this.register((0,f.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(p,n){return this.onOptionChange(a=>{a===p&&n(this.rawOptions[p])})}onMultipleOptionChange(p,n){return this.onOptionChange(a=>{p.indexOf(a)!==-1&&n()})}_setupOptions(){const p=a=>{if(!(a in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);return this.rawOptions[a]},n=(a,i)=>{if(!(a in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);i=this._sanitizeAndValidateOption(a,i),this.rawOptions[a]!==i&&(this.rawOptions[a]=i,this._onOptionChange.fire(a))};for(const a in this.rawOptions){const i={get:p.bind(this,a),set:n.bind(this,a)};Object.defineProperty(this.options,a,i)}}_sanitizeAndValidateOption(p,n){switch(p){case"cursorStyle":if(n||(n=t.DEFAULT_OPTIONS[p]),!function(a){return a==="block"||a==="underline"||a==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${p}`);break;case"wordSeparator":n||(n=t.DEFAULT_OPTIONS[p]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=g.includes(n)?n:t.DEFAULT_OPTIONS[p];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${p} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${p} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${p} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${p} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}t.OptionsService=v},2660:function(w,t,o){var h=this&&this.__decorate||function(v,C,p,n){var a,i=arguments.length,s=i<3?C:n===null?n=Object.getOwnPropertyDescriptor(C,p):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(v,C,p,n);else for(var _=v.length-1;_>=0;_--)(a=v[_])&&(s=(i<3?a(s):i>3?a(C,p,s):a(C,p))||s);return i>3&&s&&Object.defineProperty(C,p,s),s},f=this&&this.__param||function(v,C){return function(p,n){C(p,n,v)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const l=o(2585);let g=t.OscLinkService=class{constructor(v){this._bufferService=v,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(v){const C=this._bufferService.buffer;if(v.id===void 0){const _=C.addMarker(C.ybase+C.y),S={data:v,id:this._nextId++,lines:[_]};return _.onDispose(()=>this._removeMarkerFromLink(S,_)),this._dataByLinkId.set(S.id,S),S.id}const p=v,n=this._getEntryIdKey(p),a=this._entriesWithId.get(n);if(a)return this.addLineToLink(a.id,C.ybase+C.y),a.id;const i=C.addMarker(C.ybase+C.y),s={id:this._nextId++,key:this._getEntryIdKey(p),data:p,lines:[i]};return i.onDispose(()=>this._removeMarkerFromLink(s,i)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(v,C){const p=this._dataByLinkId.get(v);if(p&&p.lines.every(n=>n.line!==C)){const n=this._bufferService.buffer.addMarker(C);p.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(p,n))}}getLinkData(v){var C;return(C=this._dataByLinkId.get(v))==null?void 0:C.data}_getEntryIdKey(v){return`${v.id};;${v.uri}`}_removeMarkerFromLink(v,C){const p=v.lines.indexOf(C);p!==-1&&(v.lines.splice(p,1),v.lines.length===0&&(v.data.id!==void 0&&this._entriesWithId.delete(v.key),this._dataByLinkId.delete(v.id)))}};t.OscLinkService=g=h([f(0,l.IBufferService)],g)},8343:(w,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;const o="di$target",h="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(f){return f[h]||[]},t.createDecorator=function(f){if(t.serviceRegistry.has(f))return t.serviceRegistry.get(f);const l=function(g,v,C){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(p,n,a){n[o]===n?n[h].push({id:p,index:a}):(n[h]=[{id:p,index:a}],n[o]=n)})(l,g,C)};return l.toString=()=>f,t.serviceRegistry.set(f,l),l}},2585:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const h=o(8343);var f;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(l){l[l.TRACE=0]="TRACE",l[l.DEBUG=1]="DEBUG",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.OFF=5]="OFF"}(f||(t.LogLevelEnum=f={})),t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(w,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const h=o(8460),f=o(225);class l{static extractShouldJoin(v){return(1&v)!=0}static extractWidth(v){return v>>1&3}static extractCharKind(v){return v>>3}static createPropertyValue(v,C,p=!1){return(16777215&v)<<3|(3&C)<<1|(p?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;const v=new f.UnicodeV6;this.register(v),this._active=v.version,this._activeProvider=v}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(v){if(!this._providers[v])throw new Error(`unknown Unicode version "${v}"`);this._active=v,this._activeProvider=this._providers[v],this._onChange.fire(v)}register(v){this._providers[v.version]=v}wcwidth(v){return this._activeProvider.wcwidth(v)}getStringCellWidth(v){let C=0,p=0;const n=v.length;for(let a=0;a<n;++a){let i=v.charCodeAt(a);if(55296<=i&&i<=56319){if(++a>=n)return C+this.wcwidth(i);const S=v.charCodeAt(a);56320<=S&&S<=57343?i=1024*(i-55296)+S-56320+65536:C+=this.wcwidth(S)}const s=this.charProperties(i,p);let _=l.extractWidth(s);l.extractShouldJoin(s)&&(_-=l.extractWidth(p)),C+=_,p=s}return C}charProperties(v,C){return this._activeProvider.charProperties(v,C)}}t.UnicodeService=l}},u={};function d(w){var t=u[w];if(t!==void 0)return t.exports;var o=u[w]={exports:{}};return r[w].call(o.exports,o,o.exports,d),o.exports}var b={};return(()=>{var w=b;Object.defineProperty(w,"__esModule",{value:!0}),w.Terminal=void 0;const t=d(9042),o=d(3236),h=d(844),f=d(5741),l=d(8285),g=d(7975),v=d(7090),C=["cols","rows"];class p extends h.Disposable{constructor(a){super(),this._core=this.register(new o.Terminal(a)),this._addonManager=this.register(new f.AddonManager),this._publicOptions={...this._core.options};const i=_=>this._core.options[_],s=(_,S)=>{this._checkReadonlyOptions(_),this._core.options[_]=S};for(const _ in this._core.options){const S={get:i.bind(this,_),set:s.bind(this,_)};Object.defineProperty(this._publicOptions,_,S)}}_checkReadonlyOptions(a){if(C.includes(a))throw new Error(`Option "${a}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new g.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new l.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const a=this._core.coreService.decPrivateModes;let i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any"}return{applicationCursorKeysMode:a.applicationCursorKeys,applicationKeypadMode:a.applicationKeypad,bracketedPasteMode:a.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:a.origin,reverseWraparoundMode:a.reverseWraparound,sendFocusMode:a.sendFocus,wraparoundMode:a.wraparound}}get options(){return this._publicOptions}set options(a){for(const i in a)this._publicOptions[i]=a[i]}blur(){this._core.blur()}focus(){this._core.focus()}input(a,i=!0){this._core.input(a,i)}resize(a,i){this._verifyIntegers(a,i),this._core.resize(a,i)}open(a){this._core.open(a)}attachCustomKeyEventHandler(a){this._core.attachCustomKeyEventHandler(a)}attachCustomWheelEventHandler(a){this._core.attachCustomWheelEventHandler(a)}registerLinkProvider(a){return this._core.registerLinkProvider(a)}registerCharacterJoiner(a){return this._checkProposedApi(),this._core.registerCharacterJoiner(a)}deregisterCharacterJoiner(a){this._checkProposedApi(),this._core.deregisterCharacterJoiner(a)}registerMarker(a=0){return this._verifyIntegers(a),this._core.registerMarker(a)}registerDecoration(a){return this._checkProposedApi(),this._verifyPositiveIntegers(a.x??0,a.width??0,a.height??0),this._core.registerDecoration(a)}hasSelection(){return this._core.hasSelection()}select(a,i,s){this._verifyIntegers(a,i,s),this._core.select(a,i,s)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(a,i){this._verifyIntegers(a,i),this._core.selectLines(a,i)}dispose(){super.dispose()}scrollLines(a){this._verifyIntegers(a),this._core.scrollLines(a)}scrollPages(a){this._verifyIntegers(a),this._core.scrollPages(a)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(a){this._verifyIntegers(a),this._core.scrollToLine(a)}clear(){this._core.clear()}write(a,i){this._core.write(a,i)}writeln(a,i){this._core.write(a),this._core.write(`\r
`,i)}paste(a){this._core.paste(a)}refresh(a,i){this._verifyIntegers(a,i),this._core.refresh(a,i)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(a){this._addonManager.loadAddon(this,a)}static get strings(){return t}_verifyIntegers(...a){for(const i of a)if(i===1/0||isNaN(i)||i%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...a){for(const i of a)if(i&&(i===1/0||isNaN(i)||i%1!=0||i<0))throw new Error("This API only accepts positive integers")}}w.Terminal=p})(),b})())})(Dr);var po=Dr.exports;const go=({path:c})=>{const e=ae(null),r=80,u=17;return ce(()=>{const d=new po.Terminal({cols:r,rows:u});let b=!1;return pywebview.api.terminal.create(r,u,c).then(()=>{d.open(e.current),d.onData(t=>{t&&pywebview.api.terminal.write(t)});const w=()=>{pywebview.api.terminal.onData().then(t=>{d.write(t),w()})};b||(b=!0,w())}),()=>{d.dispose(),pywebview.api.terminal.write(`exit
`)}},[c]),W("div",{className:"bg-black h-1/3 overflow-hidden col-span-3 row-span-1 border-r border-t border-b border-[var(--opacity-color)]",ref:e})},Tr=({name:c,path:e,setFile:r})=>{const u=c.split(".").pop();return W("div",{className:"ms-1 text-white flex gap-1 items-center hover:bg-[var(--primary-color)] cursor-pointer",onClick:()=>{pywebview.api.file.open(e).then(d=>{console.log(typeof d),r({path:e,content:d})})},children:[W("i",{className:`bi bi-filetype-${u} text-2xl`}),c]})},Br=({name:c,path:e,setFile:r})=>{const[u,d]=le([]);return ce(()=>{pywebview.api.getFiles(e).then(b=>{d(b)})},[]),W("details",{className:"ms-1  ",children:[W("summary",{className:"list-none cursor-pointer hover:bg-[var(--primary-color)]",children:W("div",{className:"flex gap-1 text-white",children:[W("i",{className:"bi bi-folder text-2xl"}),c]})}),W("div",{children:u.map(b=>b.type==="folder"?W(Br,{name:b.name,path:b.path}):W(Tr,{setFile:r,name:b.name,path:b.path}))})]})},vo=({path:c,setFile:e,hidden:r,setPath:u})=>{ce(()=>{c&&pywebview.api.getFiles(c).then(w=>{b(w)})},[c]);const[d,b]=le([]);return W("div",{className:`${r?"hidden":"flex"} w-full h-full  flex-col gap-1`,children:[W("div",{className:`${d.length!==0?"hidden":"flex"}  flex-col gap-5 items-center`,children:[W("h1",{className:"text-2xl",children:"No Files"}),W("button",{className:"bg-neutral-800 border  border-[var(--opacity-color)] p-1 rounded-md w-full",onClick:()=>{pywebview.api.openFolder().then(w=>{u(w[0])})},children:"Open Folder"}),W("button",{className:"bg-neutral-800 border border-[var(--opacity-color)] p-1 rounded-md w-full",id:"openFile",onClick:()=>{pywebview.api.openFile().then(w=>{b([...d,{name:w[0].split("\\").pop(),type:"file",path:w[0]}])})},children:"Add File"})]}),W("div",{className:`${d.length===0?"hidden":"flex"} flex-col`,children:d.map(w=>w.type==="folder"?W(Br,{name:w.name,path:w.path,setFile:e}):W(Tr,{setFile:e,name:w.name,path:w.path}))})]})},mo=({hidden:c,setPath:e})=>{const[r,u]=le(),[d,b]=le([]),w="https://api.github.com/users",[t,o]=le(),h=ae(null);return ce(()=>{pywebview.api.gitHub.getUser().then(f=>{f!==""&&u(JSON.parse(f))})},[]),ce(()=>{r&&fetch(`${w}/${r.login}/repos`).then(f=>f.json()).then(f=>{b(f)})},[r]),r?W("div",{className:`${c?"hidden":"flex"} flex-col p-2  w-full h-full gap-2`,children:[W("button",{className:"flex flex-col",onClick:()=>{u(null),pywebview.api.gitHub.setUser("")},children:W("i",{className:"material-icons",children:"logout"})}),W("details",{children:[W("summary",{className:"cursor-pointer",children:"Repositorios"}),W("div",{className:"p-4 flex flex-col gap-2",children:d.map(f=>W("div",{className:"text-white hover:bg-[var(--primary-color)] cursor-pointer flex gap-2 items-center text-nowrap p-1",onClick:()=>{o(f.clone_url),h.current.setAttribute("open",!0)},children:[W("img",{src:r.avatar_url,width:"30",height:"30",class:"w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500",alt:"avatar",onClick:l=>l.target.parentElement.click()}),W("p",{onClick:l=>l.target.parentElement.click(),children:[r.login,"/",f.name]})]}))})]}),W("dialog",{ref:h,className:"absolute z-40 bg-[var(--bg)] p-10 text-white border border-[var(--opacity-color)]",children:[W("p",{children:"Do you want to clone the repository?"}),W("form",{method:"dialog",className:"flex gap-1",children:[W("button",{type:"submit",class:"bg-[var(--primary-color)] w-16 py-1 px-2 rounded-md",children:"no"}),W("button",{class:"bg-[var(--primary-color)] w-16 py-1 px-2 rounded-md",onClick:()=>{pywebview.api.gitHub.download(t).then(f=>{f.success?e(f.message):alert(f.message)})},children:"yes"})]})]})]}):W("form",{className:`${c?"hidden":"flex"} flex-col items-center w-full h-full p-4`,onSubmit:f=>{f.preventDefault();const l=new FormData(f.target).get("username");console.log(w),fetch(`${w}/${l}`).then(g=>g.json()).then(g=>{u(g),pywebview.api.gitHub.setUser(JSON.stringify(g))})},children:[W("i",{class:"bi bi-github text-white text-7xl"}),W("div",{className:"w-full",children:[W("label",{for:"Username",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Username"}),W("input",{id:"Username",name:"username",type:"text",class:"block w-full p-2  border border-[var(--opacity-color)] rounded-md bg-[var(--primary-color)]"})]})]})},So=({setFile:c,path:e,setPath:r})=>{const[u,d]=le(1);return W("div",{className:"w-1/4 overflow-x-hidden h-full flex flex-col border border-[var(--opacity-color)]",children:[W("div",{children:[W("button",{onClick:()=>d(1),className:`${u===1?"bg-[var(--primary-color)]":""} border-r border-[var(--opacity-color)] text-white w-16`,children:"Files"}),W("button",{onClick:()=>d(2),className:`${u===2?"bg-[var(--primary-color)]":""} border-r border-[var(--opacity-color)] text-white w-16`,children:"Git"})]}),W("div",{className:"flex-1 border-t border-[var(--opacity-color)] overflow-x-hidden overflow-y-auto p-2",children:[W(vo,{setPath:r,hidden:u!==1,path:e,setFile:c}),W(mo,{setPath:r,hidden:u!==2})]})]})},It=({children:c,title:e,onClick:r})=>W("details",{onMouseEnter:u=>{u.target.setAttribute("open",!0)},onMouseLeave:u=>{u.target.removeAttribute("open")},className:"relative",onClick:r,children:[W("summary",{className:"p-1 rounded-md cursor-pointer hover:bg-[var(--primary-color)] transition-all list-none text-white text-left",children:e}),W("div",{className:" text-white absolute top-8 z-10 bg-[var(--bg)]  flex flex-col gap-1 w-48 rounded-md border border-[var(--opacity-color)]",children:c})]}),pe=({children:c,onClick:e,setElement:r,icon:u})=>W("button",{className:"w-full py-2 px-1 border-b border-[var(--opacity-color)] text-left flex gap-1 items-center transition-all hover:bg-[var(--primary-color)]",onClick:e,children:[W("i",{className:"material-icons",children:u}),c]}),bo=({file:c,setCwd:e})=>{const{setFile:r,setPath:u}=Zt(Mr),d=ae(null);return W("nav",{className:"",children:W("div",{className:"flex justify-between",children:[W("div",{className:" flex gap-2",ref:d,children:[W(It,{title:"File",children:[W(pe,{icon:"folder",onClick:()=>{pywebview.api.openFolder().then(b=>{u(b[0])})},children:"Open Folder"}),W(pe,{icon:"note_add",onClick:()=>{document.querySelector("#openFile").click()},children:"Add File"}),W(pe,{icon:"save",onClick:b=>{c&&pywebview.api.file.save(c.path,c.content)},children:"Save"})]}),W(It,{title:"Edit",children:[W(pe,{icon:"undo",children:"Undo"}),W(pe,{icon:"redo",children:"Redo"}),W(pe,{icon:"content_cut",children:"Cut"}),W(pe,{icon:"content_copy",children:"Copy"}),W(pe,{icon:"content_paste",children:"Paste"}),W(pe,{icon:"select_all",children:"Select All"})]}),W(It,{title:"View",children:W(pe,{icon:"fullscreen",onClick:()=>{pywebview.api.toggleFullscreen()},children:"Toggle Fullscreen"})})]}),W("div",{})]})})},Mr=Vi();function yo(){const[c,e]=le(null),[r,u]=le(null);return W(Mr.Provider,{value:{file:c,setFile:e,path:r,setPath:u},children:W("div",{className:"flex flex-col h-screen",children:[W(bo,{file:c,setCwd:u}),W("div",{className:"flex h-[95vh]",children:[W(So,{file:c,setFile:e,path:r,setPath:u}),W("div",{className:"flex flex-col flex-1",children:[W(fo,{setFile:e,file:c}),W(go,{path:r})]})]})]})})}const wo=performance.now();window.addEventListener("pywebviewready",()=>{const e=performance.now()-wo,r=Math.floor(e/1e3),u=Math.floor(e%1e3);console.log(`El tiempo de inicio del evento pywebviewready fue de ${r} segundos y ${u} milisegundos.`),Me(W(yo,{}),document.getElementById("app"))});
